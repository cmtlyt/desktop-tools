import{r as i,y as t,z as B}from"./index-vpEv5sD-.js";import{d as u,p as z,j as R,b as h,a as f,q as r,T as m,r as _,s as v,t as b,v as y,B as x,w as M,A as U,l as w,c as O,x as k,i as H}from"./index-DsMCs7Ru.js";import{u as F}from"./store-CYd9Bme5.js";import{I as G,H as W,a as Y,b as q}from"./index-DviKuboU.js";import{B as j}from"./index-ILW44Arb.js";import{S as E}from"./index-D9GgxVnM.js";import{u as J}from"./use-navigate-xBt7TmVS.js";import{E as K}from"./index-9tW2lGkj.js";import"./index-3J0ODjeQ.js";import"./index-DdyY_ovP.js";import"./asyncToGenerator-DSdp_N4A.js";const p=u.span`
  ${o=>{const{$color:e,$fontSize:s}=o;return{color:e,fontSize:s}}}}
`,Q=i.memo(function(e){const{value:s,fontSize:n=20,decimalSize:c=16,symbolSize:l=14,color:a,decimalColor:A,symbolColor:C,showPrefix:$=!1,className:T}=e,[S,d]=String(s).split("."),[,I]=i.useState(),[N,P,L]=z([l,n,c]);return R(S)?null:t.jsxs(h,{className:T,$alignItems:f.BASELINE,onClick:D=>{D.stopPropagation(),I(Math.random())},children:[t.jsx(E,{if:$,children:()=>t.jsx(p,{$fontSize:N,$color:C||a,children:"¥"})}),t.jsx(p,{$fontSize:P,$color:a,children:S}),t.jsx(E,{if:(d==null?void 0:d.length)>0,children:()=>t.jsx(p,{$fontSize:L,$color:A||a,children:`.${d}`})})]})}),g=u(y)`
  margin-right: 1rem;
`,V=i.memo(({children:o})=>{const e={[r.PAID]:{$presetTheme:m.SUCCESS},[r.UNPAID]:{$presetTheme:m.PROCESSING},[r.REFUNDED]:{$presetTheme:m.WARNING},[r.CANCELED]:{$presetTheme:m.INFO},[r.INCOME]:{$presetTheme:m.SUCCESS}}[o],s=_[o];return t.jsx(g,{...e,children:s})}),X=i.memo(({children:o})=>{const e=v[o];return t.jsx(g,{children:e})}),Z=i.memo(({children:o})=>{const e=b[o];return t.jsx(g,{children:e})}),ee=u(j)`
  padding-left: 1rem;
`;function te(o){const{flow:e,onDelete:s}=o,{id:n}=e,{setFlow:c}=F("setFlow");return t.jsx(ee,{wrapperProps:{$alignItems:f.CENTER},buttons:[{text:"编辑",$presetTheme:x.PRIMARY,to:`/flow/editor/${n}`,onClick:()=>c(e)},{text:"删除",$presetTheme:x.DANGER,logInfo:{id:n},onClick(l){l.stopPropagation(),s==null||s(n)}}]})}function oe(o){switch(o){case r.PAID:return"var(--color-theme-7)";case r.UNPAID:return"var(--color-gray-6)";case r.REFUNDED:case r.INCOME:return"#52c41a";case r.CANCELED:return"var(--color-gray-5)"}}const se=u(Q)`
  margin-right: 1rem;
  ${o=>{const{$status:e}=o;return{color:oe(e),textDecoration:e===r.CANCELED?"line-through":"none"}}}
`,re=i.memo(o=>{const{flow:e,onClick:s,onDelete:n}=o;return t.jsx(G,{onClick:s,children:t.jsxs(W,{rightArea:t.jsx(te,{flow:e,onDelete:n}),children:[t.jsxs(h,{$flex:"1",$alignItems:f.CENTER,children:[t.jsx(V,{children:e.status}),t.jsx(X,{children:e.account}),t.jsx(Z,{children:e.category}),t.jsx(se,{value:e.amount,$status:e.status,showPrefix:!0}),t.jsx(Y,{children:e.title})]}),t.jsx(q,{children:e.createTime})]})})}),ne=u(h)`
  padding: var(--page-padding);
`;function ae(o){const{deleteFlow:e}=H();e(o)}function we(){const o=B(),{setFlow:e}=F("setFlow"),{flows:s}=M("flows"),{flows:n}=o,c=J(),l=i.useMemo(()=>n||s,[s,n]);return i.useEffect(()=>{e(void 0)},[e]),t.jsx(U,{onFirstAppear:()=>w.appear("flow-list"),children:t.jsx(ne,{$direction:O.COLUMN,children:t.jsx(k,{if:l.length>0,fullback:t.jsx(K,{}),children:()=>l.map(a=>t.jsx(re,{flow:a,onDelete:ae,onClick:()=>{e(a),w.click("flow-item-click",{id:a.id}),c(`/flow/detail/${a.id}`)}},a.id))})})})}async function Ee(){return window.logger.todo("请求接口加载流水信息, 报错时使用本地存储中的流水信息"),{flows:null}}function ie(){return t.jsx(j,{buttons:[{text:"新建",to:"/flow/editor",$presetTheme:x.PRIMARY}]})}const Fe={title:"流水列表",crumbLabel:"列表",rightArea:t.jsx(ie,{})};export{we as Component,Fe as handle,Ee as loader};
