import{l as a,j as o,n as A,r as m,az as g,aA as d,k as v}from"./index-CBb6If-E.js";import{A as x}from"./index-CH-zzRwl.js";import{B as S}from"./button-fRi0dzFk.js";import{B as b}from"./index-CgJ3YfsF.js";import{S as E,c as j}from"./Subject-D6CZChLf.js";import{u as k}from"./use-navigate-CFoH6M2j.js";import{u as y}from"./use-global-event-CaIrOHI7.js";import{g as h,A as w,T as B}from"./title-area-EndKto4K.js";import{s as R}from"./util-B1ywx7VV.js";import"./iconBase-DfyR3OvK.js";import"./index-B4g9YTQJ.js";import"./index-BhrAinXL.js";import"./is-phone-CsqGIDqW.js";import"./index-BxYKksZ_.js";import"./index-Bx4JbDjc.js";import"./asyncToGenerator-xVe5G5SN.js";import"./reactNode-CucnW-jD.js";import"./KeyCode-DNlgD2sM.js";import"./index-Baf81WNP.js";import"./index-CGhT9hD2.js";import"./opfs-key-D0VDwJ2Y.js";var n=(t=>(t.SAVE="save",t))(n||{});const l=new E;function L(t){l.next(t),a.event("notepad-editor-action",t)}const N=j(l);function C(){return o.jsx(b,{buttons:[{text:"保存",$presetTheme:S.PRIMARY,onClick:()=>L({id:"notepad-editor-save",type:n.SAVE})}]})}function _(){const{id:t}=A(),s=m.useRef(null),i=k(),p=m.useCallback(async()=>{var u;const e=(u=s.current)==null?void 0:u.getMarkdown();if(!e)return;a.event("notepad-editor-save",{id:t});const{title:c}=h(),r={id:t,title:c,url:"",content:""};if(g()){const f=await R(c,e);r.url=f}else r.content=e;t?d().updateNotepad(t,r):d().addNotepad(r),v().showMessage({content:"保存成功",type:"success",onClose:()=>i(-1)})},[t,i]);return N(p,n.SAVE),y("keydown",e=>{e.key==="s"&&(e.metaKey||e.ctrlKey)&&(e.preventDefault(),p())}),o.jsx(x,{onFirstAppear:()=>a.appear("notepad-editor"),children:o.jsx(w,{ref:s})})}const tt={title:"编辑笔记",crumbLabel:"编辑",needBackIcon:!0,rightArea:o.jsx(C,{}),titleArea:o.jsx(B,{})};async function et({params:t}){return{id:t.id}}export{_ as Component,tt as handle,et as loader};
