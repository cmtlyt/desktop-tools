import{x as o,r as a}from"./index-CHoudlAF.js";import{B as l}from"./index-sYXgAuYL.js";import{Q as m,l as s,w as p}from"./index-KNKRzeP1.js";import{g as u,u as i}from"./store-D9UgYiu9.js";import{i as f,b as d}from"./opfs-BPlJtuxg.js";import{E as y}from"./index-lHsKNtlW.js";import{A as x}from"./index-BitVjYMC.js";import"./iconBase-d73V5-N0.js";import"./index-BOsBzvxJ.js";import"./is-phone-BPh1lWQO.js";import"./index-DvQpSxGL.js";import"./asyncToGenerator-Bnzkvon6.js";import"./index-CK-FtDdO.js";async function U(t){if(!f(t))return t;const e=await d(t);return URL.createObjectURL(e)}async function c(t){if(!t)return"";const{url:e,content:r}=t;if(e)return await U(e);if(!r)return"";const n=m(r);return URL.createObjectURL(n)}async function g(){const{currentRecord:t}=u(),e=await c(t),r=document.createElement("a");r.style.display="none",r.href=e,r.download=`${t==null?void 0:t.name}.webm`,r.click(),setTimeout(()=>{window.URL.revokeObjectURL(e)},100)}function j(){return o.jsx(l,{buttons:[{text:"下载",onClick:g}]})}function w(){const{currentRecord:t}=i("currentRecord");return(t==null?void 0:t.name)||"回放"}function v(){const{currentRecord:t}=i("currentRecord"),[e,r]=a.useState("");return a.useEffect(()=>{(async()=>{try{const n=await c(t);r(n)}catch(n){s.error("get-play-url",n.message)}})()},[t]),o.jsx(x,{onFirstAppear:()=>s.appear("playback"),children:o.jsx(p,{if:!!e,fullback:o.jsx(y,{}),children:()=>o.jsx("video",{src:e,controls:!0})})})}const T={title:"回放",needBackIcon:!0,rightArea:o.jsx(j,{}),titleArea:o.jsx(w,{})};export{v as Component,T as handle};
