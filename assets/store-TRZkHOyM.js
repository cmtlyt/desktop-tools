import{h as H}from"./index-_R9rflT2.js";var E={};const k=Symbol&&Symbol("empty")||{},U=Reflect!=null&&Reflect.apply?e=>{let t=k;return(...s)=>(t===k&&(t=e()),typeof t!="function"?t:Reflect.apply(t,null,s))}:e=>{let t=k;return(...s)=>(t===k&&(t=e()),typeof t!="function"?t:t.apply(null,s))},K=U(()=>globalThis.navigator?globalThis.navigator.userAgent||globalThis.navigator.swuserAgent:process?`Node.js/${process.version} (${process.platform}; ${process.arch}) ${E.SHELL} ${E.LANG} ${E.TERM_PROGRAM}`:""),Q=U(()=>!K().toLocaleLowerCase().includes("node")&&window&&"onload"in window);function D(...e){var t;(t=globalThis==null?void 0:globalThis.__ClConfig__)!=null&&t.disableWarning||console.warn("@cmtlyt/base:>",...e)}function d(e){return Q()?typeof window<"u"&&window[e]!==void 0:(D("caniuse 只能在浏览器环境中使用"),!1)}async function V(e){return function(t){return btoa(String.fromCharCode.apply(null,new Uint8Array(t)))}(await async function(t){const s=t.getReader(),r=[];let n=0;for(;;){const{done:f,value:a}=await s.read();if(f)break;r.push(a),n+=a.byteLength}const o=new ArrayBuffer(n);let c=0;for(const f of r){const a=new Uint8Array(f);new Uint8Array(o,c,a.length).set(a),c+=a.length}return o}(e))}function X(e){return function(t){return new ReadableStream({start(s){s.enqueue(t),s.close()}})}(function(t){const s=atob(t),r=s.length,n=new Uint8Array(r);for(let o=0;o<r;o++)n[o]=s.charCodeAt(o);return n}(e))}var M,$=1e3,m=6e4,h=60*m,w=24*h,Y=7*w;function A(e,t,s,r){var n=t>=1.5*s;return Math.round(e/s)+" "+r+(n?"s":"")}function C(e=8){const t=Math.random().toString(36).slice(2,e+2);return t.length===e?t:t+C(e-t.length)}function x(e){const t=new Blob([e]);return URL.createObjectURL(t)}function N(e){return new Worker(e)}function O(){const e=[],t=r=>{e.push(r)},s=r=>{e.splice(e.indexOf(r),1)};return{on:t,remove:s,clearOn:()=>{e.length=0},onOnce:r=>{const n=(...o)=>{r.apply(null,o),s(n)};t(n)},emit:r=>{for(const n of e)n(r)}}}function T({emit:e,type:t,result:s,error:r,resolve:n=()=>{},reject:o=()=>{},isSysCall:c,eventData:f}){if(c)t==="success"?n(s):o(r);else{const{__clUserCall:a,data:l}=f;e(a?l:f)}}function I(e,t=[],s){if(!d("Worker"))return D("不支持 web worker 已降级"),{run:async(...a)=>await e(...a),dispose:()=>{},...O()};const{reuse:r=!0,needPost:n=!1}=s,o=function(a,l=[],i=!1){return`
${l.length?`importScripts("${l.join('", "')}");`:""}
const func = ${a};

const { postMessage } = (()=>{
  const postMessage = (data) => {
    self.postMessage({ __clUserCall: true, data })
  };
  return { postMessage: (data) => postMessage(data) };
})();

self.onmessage = async (e) => {
  const { callId, data: args } = e.data
  try {
    const result = await func.apply(null, ${i?"[postMessage, ...args]":"args"});
    self.postMessage({ __clSysCall: true, type: 'success', result, callId });
  } catch (e) {
    self.postMessage({ __clSysCall: true, callId, type: 'error', error: e })
  }
}
self.onerror = (e) => {
  self.postMessage({ __clSysCall: true, type: 'error', error: e })
}`}(e,function(a){const l=[],i=[];return a.forEach(u=>{typeof u=="string"?i.push(u):typeof u=="function"&&l.push(u)}),i.push(x(l.map(u=>`function ${u.name}(...args) { return (${u})(...args); }`).join(`
`))),i}(t),n),c=x(o);return r?function(l){const i=N(l);let u=!1,y={};const{emit:S,...L}=O();return i.onmessage=g=>{const{type:p,result:b,error:v,callId:R,__clSysCall:_}=g.data,{resolve:F,reject:G}=y[R]||{};_&&delete y[R],T({emit:S,type:p,result:b,error:v,resolve:F,reject:G,isSysCall:_,eventData:g.data})},{run:async(...g)=>{if(u)throw new Error("worker资源已释放");const p=C(16);return new Promise((b,v)=>{y[p]={resolve:b,reject:v},i.postMessage({callId:p,data:g})})},dispose:()=>{i.terminate(),y=null,u=!0,URL.revokeObjectURL(l)},...L}}(c):function(a){let l=!1;const{emit:i,...u}=O();return{run:async(...y)=>{if(l)throw new Error("worker资源已释放");const S=N(a);return new Promise((L,g)=>{S.onmessage=p=>{const{type:b,result:v,error:R,__clSysCall:_}=p.data;_&&S.terminate(),T({emit:i,type:b,result:v,error:R,resolve:L,reject:g,isSysCall:_,eventData:p.data})},S.postMessage({data:y})})},dispose:()=>{l=!0,URL.revokeObjectURL(a)},...u}}(c)}function j(e,t){let s,r=0;const n=36**t;for(;e.includes(s=C(t))&&++r<n;);return s}function P(e){return"#"}function B(e,t,s="#",r={}){const n=new RegExp(`(^{.*?(.{${t}})})|({.*?(.{${t}})}$)`),o=s.length+2;for(let c=0;c++<e.length;){const f=e.slice(c,c+t+o);if(e.includes(f,c+t+o))for(let a=c+t+o+1;a++<e.length;){const l=e.slice(c,a);if(!e.includes(l,a)){const i=j(Object.keys(r),t),u=e.slice(c,a-1);if(n.test(u))break;r[i]=u,e=e.replace(new RegExp(u.replace(/([[{(?)\\])/g,"\\$1"),"g"),`{${s}${i}}`),c+=9;break}}}return e}function J(e,t=6){const s={},r=B(e,t,"#",s);return JSON.stringify({cache:s,source:r,keyLength:t})}M=function(e,t){t=t||{};var s=typeof e;if(s==="string"&&e.length>0)return function(r){if(!((r=String(r)).length>100)){var n=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(r);if(n){var o=parseFloat(n[1]);switch((n[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*o;case"weeks":case"week":case"w":return o*Y;case"days":case"day":case"d":return o*w;case"hours":case"hour":case"hrs":case"hr":case"h":return o*h;case"minutes":case"minute":case"mins":case"min":case"m":return o*m;case"seconds":case"second":case"secs":case"sec":case"s":return o*$;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}}}(e);if(s==="number"&&isFinite(e))return t.long?function(r){var n=Math.abs(r);return n>=w?A(r,n,w,"day"):n>=h?A(r,n,h,"hour"):n>=m?A(r,n,m,"minute"):n>=$?A(r,n,$,"second"):r+" ms"}(e):function(r){var n=Math.abs(r);return n>=w?Math.round(r/w)+"d":n>=h?Math.round(r/h)+"h":n>=m?Math.round(r/m)+"m":n>=$?Math.round(r/$)+"s":r+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))},M&&M.__esModule&&Object.prototype.hasOwnProperty.call(M,"default")&&M.default;I(J,[B,P,j,C],{reuse:!1});function W(e,t="#"){const{keyLength:s,cache:r}=e;let n,{source:o}=e;for(;n=new RegExp(`{${t}(.{${s}})}`,"g").exec(o);){const[c,f]=Array.from(n);o=o.replace(new RegExp(c,"g"),r[f])}return o}function q(e){return W(JSON.parse(e),"#")}I(q,[W,P,j,C],{reuse:!1});const z=U(()=>d("TextEncoder")&&d("ReadableStream")&&d("ArrayBuffer")&&d("Uint8Array")&&d("btoa")&&d("atob")&&d("TextDecoder"));async function ee(e,t=6){if(!d("CompressionStream")||!z())return J(e,t);const s=function(r){const n=new TextEncoder;return new ReadableStream({start(o){o.enqueue(n.encode(r)),o.close()}})}(e).pipeThrough(new CompressionStream("gzip"));return V(s)}async function te(e){return!d("DecompressionStream")||!z()?q(e):async function(t){const s=t.getReader(),r=[];let n="";for(;;){const{done:c,value:f}=await s.read();if(c)break;r.push(f)}const o=new TextDecoder("utf-8");for(const c of r)n+=o.decode(c);return n+=o.decode(),n}(X(e).pipeThrough(new DecompressionStream("gzip")))}const{useStore:re,useStoreSlice:ne,getStore:se}=H(e=>({currentNotepad:void 0,setNotepad:t=>e({currentNotepad:t})}));export{ee as O,te as U,se as g,ne as u};
