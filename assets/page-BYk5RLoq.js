import{y as C,r as n,x as s}from"./index-qq1zZMVq.js";import{i as F,j as h,l as a,d as j,k as v,A as w,b as B,g as R,B as k}from"./index-BtY2zed6.js";import{P as u,F as I}from"./flow-form-CLysUl7W.js";import{B as V}from"./index-fV30I5f3.js";import{S as y,c as _}from"./create-action-subscribe-hook-zJ1UB6ET.js";import{u as D}from"./use-navigate-3XxNzijE.js";import"./store-DJGUSISu.js";import"./index-DLUWWLMN.js";import"./index-BX123Ptq.js";import"./ContextIsolator-ByqfXxAa.js";import"./asyncToGenerator-Df59xTJ4.js";import"./zoom-DppKTOyU.js";import"./genStyleUtils-BLElyHfB.js";import"./LoadingOutlined-BSEhdOwu.js";import"./index-C0CjuiRJ.js";import"./index-nYyowWGG.js";import"./index-BDGbX-C-.js";import"./PurePanel-YO71Dqgr.js";import"./render-KgvIOgqv.js";import"./index-DLJ6e2WF.js";const p=F(t=>({id:"",setId:e=>t({id:e})})),m=t=>p(h(t));function L(){return p.getState()}var i=(t=>(t.SAVE="save",t.SAVE_SUCCESS="save_success",t))(i||{});const S=new y;function l(t){S.next(t),a.event("editor-action",t)}const f=_(S),P=j(B)`
  padding: var(--page-padding);
`;function st(){const{id:t}=C(),{setId:e}=m("setId"),o=n.useRef({}),[E,g]=n.useState(!1),d=t?u.EDITOR:u.CREATE;n.useEffect(()=>{e(t||"")},[e,t]),f(r=>{if(r.id!==t)return a.error("action.id !== id",r);o.current.form.validateFields().then(()=>{o.current.form.submit(),g(!0)})},i.SAVE);const x=n.useCallback(r=>{const{id:c}=L(),{addFlow:A,updateFlow:b}=v();c.length?b(c,r):A(r),l({id:c,type:i.SAVE_SUCCESS})},[]);return s.jsx(w,{onFirstAppear:()=>a.appear("flow-editor",{id:t,pageStatus:d}),children:s.jsx(P,{children:s.jsx(I,{ref:o,disabled:E,pageStatus:d,onFinish:x})})})}function T(){const{id:t}=m("id"),e=D();return f(o=>{if(o.id!==t)return a.error("action.id !== id",o);R().showMessage({type:"success",content:"保存成功",onClose(){e("/flow")}})},i.SAVE_SUCCESS),s.jsx(V,{buttons:[{text:"取消",onClick(){e(-1)}},{text:"保存",$presetTheme:k.PRIMARY,onClick(){l({id:t,type:i.SAVE})}}]})}const it={title:"编辑",needBackIcon:!0,rightArea:s.jsx(T,{})};async function nt({params:t}){return{id:t.id||""}}export{st as Component,it as handle,nt as loader};
