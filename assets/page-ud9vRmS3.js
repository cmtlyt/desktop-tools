import{x as o,y as A,r as m}from"./index-D9Ti2l9s.js";import{A as g}from"./index-qAIdwdQd.js";import{l as a,B as x,M as d,g as v}from"./index-BuV4sdBQ.js";import{B as S}from"./index-DEpECmp6.js";import{S as b}from"./Subject-CbTjWRvp.js";import{c as y}from"./create-action-subscribe-hook-C3BDlNnB.js";import{u as E}from"./use-navigate-CnQTzVYL.js";import{u as j}from"./use-global-event-BwD_VM63.js";import{g as k,A as h,T as w}from"./title-area-Ymgv_dta.js";import{s as B}from"./util-Ba7Faf_w.js";import{o as R}from"./opfs-CNYPQYcz.js";import"./iconBase-BT1Ex9Hv.js";import"./index-BCwKMmEt.js";import"./index-DZHc1nto.js";import"./asyncToGenerator-Di2GTAJM.js";import"./index-D9GgxVnM.js";import"./index-B2u9DX8u.js";import"./opfs-key-D0VDwJ2Y.js";var n=(t=>(t.SAVE="save",t))(n||{});const l=new b;function L(t){l.next(t),a.event("notepad-editor-action",t)}const M=y(l);function N(){return o.jsx(S,{buttons:[{text:"保存",$presetTheme:x.PRIMARY,onClick:()=>L({id:"notepad-editor-save",type:n.SAVE})}]})}function W(){const{id:t}=A(),s=m.useRef(null),i=E(),p=m.useCallback(async()=>{var u;const e=(u=s.current)==null?void 0:u.getMarkdown();if(!e)return;a.event("notepad-editor-save",{id:t});const{title:c}=k(),r={id:t,title:c,url:"",content:""};if(R()){const f=await B(c,e);r.url=f}else r.content=e;t?d().updateNotepad(t,r):d().addNotepad(r),v().showMessage({content:"保存成功",type:"success",onClose:()=>i(-1)})},[t,i]);return M(p,n.SAVE),j("keydown",e=>{e.key==="s"&&(e.metaKey||e.ctrlKey)&&(e.preventDefault(),p())}),o.jsx(g,{onFirstAppear:()=>a.appear("notepad-editor"),children:o.jsx(h,{ref:s})})}const X={title:"编辑笔记",crumbLabel:"编辑",needBackIcon:!0,rightArea:o.jsx(N,{}),titleArea:o.jsx(w,{})};async function Z({params:t}){return{id:t.id}}export{W as Component,X as handle,Z as loader};
