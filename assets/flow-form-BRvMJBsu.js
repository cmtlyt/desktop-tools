import{r as o,b as v,y as e}from"./index-WxUN2MyK.js";import{d as c,k as C,l as E,g as T,b as d,c as b,m as M,n as $,o as R,p as D,B}from"./index-C1cWDTV3.js";import{u as L}from"./store-DJTomcM-.js";import{S as F}from"./index-D9GgxVnM.js";import{F as p}from"./index-D7zJcmTc.js";import{I as w}from"./pickAttrs-CauX5D37.js";import{T as N}from"./index-n3cK8EYl.js";import{I as W,S as k}from"./index-Cjv3fvtl.js";var z={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M482 152h60q8 0 8 8v704q0 8-8 8h-60q-8 0-8-8V160q0-8 8-8z"}},{tag:"path",attrs:{d:"M192 474h672q8 0 8 8v60q0 8-8 8H160q-8 0-8-8v-60q0-8 8-8z"}}]},name:"plus",theme:"outlined"},_=function(s,t){return o.createElement(w,v({},s,{ref:t,icon:z}))},A=o.forwardRef(_),P={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h368c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"minus-circle",theme:"outlined"},U=function(s,t){return o.createElement(w,v({},s,{ref:t,icon:P}))},H=o.forwardRef(U),V=(r=>(r.CREATE="create",r.EDITOR="editor",r.VIEW="view",r))(V||{});function f(r,s){const t=s;return t?t.label.includes(r)||t.alias.includes(r):!0}const a=c(p.Item)`
  margin-bottom: 0;
`,Y=c(N)`
  flex: 1;
`,G=c(W)`
  flex: 3;
`,x=c(k)`
  flex: 1;
  flex-shrink: 0;
`;function m(r){const{type:s,placeholder:t,...l}=r;return e.jsx(a,{...l,children:s==="number"?e.jsx(Y,{placeholder:t}):e.jsx(G,{placeholder:t,type:s})})}const J=c(p)`
  margin: 0 auto;
  padding: 2.4rem;
  width: 70%;
`,K=3,oe=o.forwardRef(function(s,t){const{pageStatus:l,disabled:S,onFinish:O}=s,{currentFlow:n}=L("currentFlow"),[i]=p.useForm(),h=S??l==="view";return o.useImperativeHandle(t,()=>({form:i}),[i]),o.useEffect(()=>{C(n)&&l!=="create"&&(E.error("非法访问"),T().showMessage({type:"error",content:"非法访问, 系统将会记录本次访问"}))},[n,l]),o.useEffect(()=>{i.setFieldsValue({...n,amountDistributions:n!=null&&n.amountDistributions.length?n.amountDistributions:[{}]})},[i,n]),e.jsx(J,{name:"flow-form",form:i,autoComplete:"off",onFinish:O,labelCol:{span:K},disabled:h,clearOnDestroy:!0,children:e.jsxs(d,{$gap:"1.4",$direction:b.COLUMN,children:[e.jsx(m,{name:"title",label:"标题",rules:[{required:!0,message:"请输入标题"}],placeholder:"请输入标题"}),e.jsx(m,{name:"desctription",label:"描述",rules:[{required:!1}],placeholder:"请输入描述"}),e.jsx(a,{name:"category",label:"类别",rules:[{required:!0,message:"请选择类别"}],children:e.jsx(x,{showSearch:!0,placeholder:"请选择流水类别",filterOption:f,options:M})}),e.jsx(a,{name:"status",label:"状态",rules:[{required:!0,message:"请选择状态"}],children:e.jsx(x,{showSearch:!0,placeholder:"请选择流水状态",filterOption:f,options:$})}),e.jsx(a,{label:"变更帐户",required:!0,children:e.jsx(p.List,{name:"amountDistributions",children:(j,{add:q,remove:I})=>e.jsxs(d,{$gap:"1.4",$direction:b.COLUMN,children:[j.map(({key:y,name:u,...g})=>e.jsxs(d,{$gap:"1",children:[e.jsx(a,{noStyle:!0,...g,name:[u,"account"],rules:[{required:!0,message:"请选择变更帐户"}],children:e.jsx(x,{showSearch:!0,placeholder:"请选择变更帐户",filterOption:f,options:R,style:{width:"10rem",flex:"0 0 10rem"}})}),e.jsx(m,{noStyle:!0,...g,type:"number",name:[u,"amount"],rules:[{required:!0,message:"请输入金额"}],placeholder:"请输入金额"}),e.jsx(m,{noStyle:!0,name:[u,"remark"],placeholder:"请输入备注"}),e.jsx(F,{if:!h&&j.length>1,children:()=>e.jsx(H,{onClick:()=>I(u)})})]},y)),e.jsx(F,{if:!h,children:()=>e.jsx(a,{children:e.jsx(D,{type:"button",onClick:()=>q(),$presetTheme:B.INFO,children:e.jsxs(d,{$gap:"0.4",children:[e.jsx(A,{}),e.jsx("span",{children:"添加帐户"})]})})})})]})})})]})})});export{oe as F,V as P};
