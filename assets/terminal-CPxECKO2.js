import{r as i,a3 as f,j as _}from"./index-Ch4bek_b.js";import{d as h}from"./button-ChdjSb5e.js";import{d as A,D as g}from"./page-9hDNits2.js";import"./iconBase-DzU9LrI2.js";import"./index-Baf81WNP.js";import"./index-B4g9YTQJ.js";const R=h.section`
  position: relative;
  height: 100%;
`;async function T(m){const t={...m};if(!t.fitAddon){const{FitAddon:a}=await f(async()=>{const{FitAddon:e}=await import("./addon-fit-CyyJcX4C.js").then(n=>n.a);return{FitAddon:e}},[]);t.fitAddon=new a}if(!t.webLinksAddon){const{WebLinksAddon:a}=await f(async()=>{const{WebLinksAddon:e}=await import("./addon-web-links-CmYOsrza.js").then(n=>n.a);return{WebLinksAddon:e}},[]);t.webLinksAddon=new a}if(!t.webglAddon){const{WebglAddon:a}=await f(async()=>{const{WebglAddon:e}=await import("./addon-webgl-VSpYQPpo.js").then(n=>n.a);return{WebglAddon:e}},[]);t.webglAddon=new a}return t}const E={foreground:"#ffffff",background:"#1e1e1e",cursor:"#ffffff",selection:"rgba(255, 255, 255, 0.3)",black:"#000000",brightBlack:"#808080",red:"#ce2f2b",brightRed:"#f44a47",green:"#00b976",brightGreen:"#05d289",yellow:"#e0d500",brightYellow:"#f4f628",magenta:"#bd37bc",brightMagenta:"#d86cd8",blue:"#1d6fca",brightBlue:"#358bed",cyan:"#00a8cf",brightCyan:"#19b8dd",white:"#e5e5e5",brightWhite:"#ffffff"},I=i.memo(i.forwardRef(function(t,a){const{container:e}=A("container"),n=i.useRef(null),d=i.useRef({}),o=i.useRef(null),u=i.useRef(null);return i.useImperativeHandle(a,()=>({terminalResize:()=>{const{fitAddon:s}=d.current;s&&o.current&&(s.fit(),o.current.resize({cols:u.current.cols,rows:u.current.rows}))}}),[e]),i.useEffect(()=>((async()=>{if(!e||u.current)return;const{Terminal:s}=await f(async()=>{const{Terminal:c}=await import("./xterm-BtnXY879.js").then(p=>p.x);return{Terminal:c}},[]),w=await T(d.current);d.current=w;const r=new s({fontFamily:'"Cascadia Code", Menlo, monospace',fontSize:13,convertEol:!0,cursorBlink:!0,scrollback:20,scrollOnUserInput:!0,drawBoldTextInBrightColors:!0,theme:E});u.current=r,Object.values(d.current).forEach(c=>r.loadAddon(c)),r.open(n.current);const l=d.current.fitAddon;l.fit(),o.current=await e.spawn("jsh",{terminal:{rows:r.rows,cols:r.cols},cwd:g}),window.addEventListener("resize",()=>{l&&o.current&&(l.fit(),o.current.resize({cols:r.cols,rows:r.rows}))}),o.current.output.pipeTo(new WritableStream({write(c){r.write(c)}}));const b=o.current.input.getWriter();r.onData(c=>b.write(c))})(),()=>{var s;e==null||e.fs.rm("/",{recursive:!0}),(s=o.current)==null||s.kill(),u.current=null}),[e]),_.jsx(R,{ref:n})}));export{I as Terminal,I as default};
