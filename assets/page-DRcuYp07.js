import{l as qi,$ as Bc,m as Cc,r as Mt,j as O,B as Oo,C as Ec,D as Sc,k as Rc}from"./index-v5e0f-P3.js";import{c as qh,a as Tc,F as Kh,d as dn,S as kc,b as ts,e as Ao,B as Pc}from"./button-Bx1TJ7Ps.js";import{S as Oc,c as Ac}from"./Subject-Cl1ex7Iq.js";import{A as Lc}from"./index-B78ipe0G.js";import{H as Dc,d as Zh,a as Mc,b as Fc,D as Ic,e as Wc,c as $c}from"./index-CkdIi_75.js";import{B as zc}from"./index-CT5t4fRZ.js";import{D as jc}from"./index-Cupkf4B-.js";import{a as Nc}from"./index-Ch40Iobr.js";import{G as Kr}from"./iconBase-rvs65X0U.js";import{a as Hc}from"./index-Dt5i28nu.js";import{S as Gc}from"./index-Baf81WNP.js";import{T as Uc}from"./index-D533rydK.js";import{F as ii}from"./index-DSt79PDl.js";import{i as Yc}from"./is-phone-B6SY9HpL.js";import"./index-B4g9YTQJ.js";import"./index-12j_fjYD.js";import"./index-BzB6WiPj.js";import"./asyncToGenerator-BX-mj2jX.js";import"./index-85TfOYMd.js";import"./index-CBTbymhI.js";import"./reactNode-CXmVbTch.js";import"./pickAttrs-DdvaCHuI.js";import"./context-B7gWZtei.js";import"./index-CGZTnnKG.js";import"./LoadingOutlined-XudtVr26.js";import"./compact-item-BJiT41Yv.js";const x={toURL(i,t){let e=encodeURIComponent(i);return t==="text"?e="data:text/plain;charset=utf-8,"+e:t==="svg"&&(e="data:image/svg+xml,"+e),e},image:{hitCanvasSize:100,maxCacheSize:2560*1600,maxPatternSize:4096*2160,crossOrigin:"anonymous",getRealURL(i){const{prefix:t,suffix:e}=x.image;return e&&!i.startsWith("data:")&&!i.startsWith("blob:")&&(i+=(i.includes("?")?"&":"?")+e),t&&i[0]==="/"&&(i=t+i),i}}},rt={},we={RUNTIME:"runtime",LEAF:"leaf",TASK:"task",CNAVAS:"canvas",IMAGE:"image",types:{},create(i){const{types:t}=Xc;return t[i]?t[i]++:(t[i]=1,0)}},Xc=we,{round:Vc,pow:qc,PI:Zr}=Math,ct={within(i,t,e){return typeof t=="object"&&(e=t.max,t=t.min),t!==void 0&&i<t&&(i=t),e!==void 0&&i>e&&(i=e),i},fourNumber(i,t){let e;if(i instanceof Array)switch(i.length){case 4:e=t===void 0?i:[...i];break;case 2:e=[i[0],i[1],i[0],i[1]];break;case 3:e=[i[0],i[1],i[2],i[1]];break;case 1:i=i[0];break;default:i=0}if(e||(e=[i,i,i,i]),t)for(let s=0;s<4;s++)e[s]>t&&(e[s]=t);return e},formatRotation(i,t){return i%=360,t?i<0&&(i+=360):(i>180&&(i-=360),i<-180&&(i+=360)),ct.float(i)},getGapRotation(i,t,e=0){let s=i+e;if(t>1){const n=Math.abs(s%t);(n<1||n>t-1)&&(s=Math.round(s/t)*t)}return s-e},float(i,t){const e=t!==void 0?qc(10,t):1e12;return i=Vc(i*e)/e,i===-0?0:i},getScaleData(i,t,e,s){return s||(s={}),t?(s.scaleX=(typeof t=="number"?t:t.width)/e.width,s.scaleY=(typeof t=="number"?t:t.height)/e.height):i&&ct.assignScale(s,i),s},assignScale(i,t){typeof t=="number"?i.scaleX=i.scaleY=t:(i.scaleX=t.x,i.scaleY=t.y)}},z=Zr/180,Dt=Zr*2,_i=Zr/2;function Qh(){return{x:0,y:0}}function Jh(){return{x:0,y:0,width:0,height:0}}function Js(){return{a:1,b:0,c:0,d:1,e:0,f:0}}const{sin:Tn,cos:kn,acos:ys,sqrt:Pn}=Math,{float:si}=ct,ni={};function Lo(){return Object.assign(Object.assign(Object.assign({},Js()),Jh()),{scaleX:1,scaleY:1,rotation:0,skewX:0,skewY:0})}const k={defaultMatrix:Js(),defaultWorld:Lo(),tempMatrix:{},set(i,t=1,e=0,s=0,n=1,r=0,o=0){i.a=t,i.b=e,i.c=s,i.d=n,i.e=r,i.f=o},get:Js,getWorld:Lo,copy(i,t){i.a=t.a,i.b=t.b,i.c=t.c,i.d=t.d,i.e=t.e,i.f=t.f},translate(i,t,e){i.e+=t,i.f+=e},translateInner(i,t,e,s){i.e+=i.a*t+i.c*e,i.f+=i.b*t+i.d*e,s&&(i.e-=t,i.f-=e)},scale(i,t,e=t){i.a*=t,i.b*=t,i.c*=e,i.d*=e},scaleOfOuter(i,t,e,s){q.toInnerPoint(i,t,ni),q.scaleOfInner(i,ni,e,s)},scaleOfInner(i,t,e,s=e){q.translateInner(i,t.x,t.y),q.scale(i,e,s),q.translateInner(i,-t.x,-t.y)},rotate(i,t){const{a:e,b:s,c:n,d:r}=i;t*=z;const o=kn(t),a=Tn(t);i.a=e*o-s*a,i.b=e*a+s*o,i.c=n*o-r*a,i.d=n*a+r*o},rotateOfOuter(i,t,e){q.toInnerPoint(i,t,ni),q.rotateOfInner(i,ni,e)},rotateOfInner(i,t,e){q.translateInner(i,t.x,t.y),q.rotate(i,e),q.translateInner(i,-t.x,-t.y)},skew(i,t,e){const{a:s,b:n,c:r,d:o}=i;e&&(e*=z,i.a=s+r*e,i.b=n+o*e),t&&(t*=z,i.c=r+s*t,i.d=o+n*t)},skewOfOuter(i,t,e,s){q.toInnerPoint(i,t,ni),q.skewOfInner(i,ni,e,s)},skewOfInner(i,t,e,s=0){q.translateInner(i,t.x,t.y),q.skew(i,e,s),q.translateInner(i,-t.x,-t.y)},multiply(i,t){const{a:e,b:s,c:n,d:r,e:o,f:a}=i;i.a=t.a*e+t.b*n,i.b=t.a*s+t.b*r,i.c=t.c*e+t.d*n,i.d=t.c*s+t.d*r,i.e=t.e*e+t.f*n+o,i.f=t.e*s+t.f*r+a},multiplyParent(i,t,e,s,n,r){let{e:o,f:a}=i;if(r&&(o+=r.scrollX,a+=r.scrollY),e||(e=i),s===void 0&&(s=i.a!==1||i.b||i.c||i.d!==1),s){const{a:h,b:l,c,d}=i;e.a=h*t.a+l*t.c,e.b=h*t.b+l*t.d,e.c=c*t.a+d*t.c,e.d=c*t.b+d*t.d,n&&(e.scaleX=t.scaleX*n.scaleX,e.scaleY=t.scaleY*n.scaleY)}else e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,n&&(e.scaleX=t.scaleX,e.scaleY=t.scaleY);e.e=o*t.a+a*t.c+t.e,e.f=o*t.b+a*t.d+t.f},divide(i,t){q.multiply(i,q.tempInvert(t))},divideParent(i,t){q.multiplyParent(i,q.tempInvert(t))},tempInvert(i){const{tempMatrix:t}=q;return q.copy(t,i),q.invert(t),t},invert(i){const{a:t,b:e,c:s,d:n,e:r,f:o}=i;if(!e&&!s)if(t===1&&n===1)i.e=-r,i.f=-o;else{const a=1/(t*n);i.a=n*a,i.d=t*a,i.e=-r*n*a,i.f=-o*t*a}else{const a=1/(t*n-e*s);i.a=n*a,i.b=-e*a,i.c=-s*a,i.d=t*a,i.e=-(r*n-o*s)*a,i.f=-(o*t-r*e)*a}},toOuterPoint(i,t,e,s){const{x:n,y:r}=t;e||(e=t),e.x=n*i.a+r*i.c,e.y=n*i.b+r*i.d,s||(e.x+=i.e,e.y+=i.f)},toInnerPoint(i,t,e,s){const{a:n,b:r,c:o,d:a}=i,h=1/(n*a-r*o),{x:l,y:c}=t;if(e||(e=t),e.x=(l*a-c*o)*h,e.y=(c*n-l*r)*h,!s){const{e:d,f}=i;e.x-=(d*a-f*o)*h,e.y-=(f*n-d*r)*h}},setLayout(i,t,e,s,n){const{x:r,y:o,scaleX:a,scaleY:h}=t;if(n===void 0&&(n=t.rotation||t.skewX||t.skewY),n){const{rotation:l,skewX:c,skewY:d}=t,f=l*z,u=kn(f),_=Tn(f);if(c||d){const y=c*z,w=d*z;i.a=(u+w*-_)*a,i.b=(_+w*u)*a,i.c=(-_+y*u)*h,i.d=(u+y*_)*h}else i.a=u*a,i.b=_*a,i.c=-_*h,i.d=u*h}else i.a=a,i.b=0,i.c=0,i.d=h;i.e=r,i.f=o,(e=e||s)&&q.translateInner(i,-e.x,-e.y,!s)},getLayout(i,t,e,s){const{a:n,b:r,c:o,d:a,e:h,f:l}=i;let c=h,d=l,f,u,_,y,w;if(r||o){const B=n*a-r*o;if(o&&!s){f=Pn(n*n+r*r),u=B/f;const v=n/f;_=r>0?ys(v):-ys(v)}else{u=Pn(o*o+a*a),f=B/u;const v=o/u;_=_i-(a>0?ys(-v):-ys(v))}const g=si(kn(_)),R=Tn(_);f=si(f),u=si(u),y=g?si((o/u+R)/g/z,9):0,w=g?si((r/f-R)/g/z,9):0,_=si(_/z)}else f=n,u=a,_=y=w=0;return(t=e||t)&&(c+=t.x*n+t.y*o,d+=t.x*r+t.y*a,e||(c-=t.x,d-=t.y)),{x:c,y:d,scaleX:f,scaleY:u,rotation:_,skewX:y,skewY:w}},withScale(i,t,e=t){const s=i;if(!t||!e){const{a:n,b:r,c:o,d:a}=i;r||o?(t=Pn(n*n+r*r),e=(n*a-r*o)/t):(t=n,e=a)}return s.scaleX=t,s.scaleY=e,s},reset(i){q.set(i)}},q=k,{toInnerPoint:On,toOuterPoint:Do}=k,{sin:Mo,cos:Fo,abs:Io,sqrt:Kc,atan2:An,min:Zc,PI:Qc}=Math,T={defaultPoint:Qh(),tempPoint:{},tempRadiusPoint:{},set(i,t=0,e=0){i.x=t,i.y=e},setRadius(i,t,e){i.radiusX=t,i.radiusY=e===void 0?t:e},copy(i,t){i.x=t.x,i.y=t.y},copyFrom(i,t,e){i.x=t,i.y=e},move(i,t,e){i.x+=t,i.y+=e},scale(i,t,e=t){i.x&&(i.x*=t),i.y&&(i.y*=e)},scaleOf(i,t,e,s=e){i.x+=(i.x-t.x)*(e-1),i.y+=(i.y-t.y)*(s-1)},rotate(i,t,e){e||(e=Ue.defaultPoint),t*=z;const s=Fo(t),n=Mo(t),r=i.x-e.x,o=i.y-e.y;i.x=e.x+r*s-o*n,i.y=e.y+r*n+o*s},tempToInnerOf(i,t){const{tempPoint:e}=Ue;return Dn(e,i),On(t,e,e),e},tempToOuterOf(i,t){const{tempPoint:e}=Ue;return Dn(e,i),Do(t,e,e),e},tempToInnerRadiusPointOf(i,t){const{tempRadiusPoint:e}=Ue;return Dn(e,i),Ue.toInnerRadiusPointOf(i,t,e),e},toInnerRadiusPointOf(i,t,e){e||(e=i),On(t,i,e),e.radiusX=Math.abs(i.radiusX/t.scaleX),e.radiusY=Math.abs(i.radiusY/t.scaleY)},toInnerOf(i,t,e){On(t,i,e)},toOuterOf(i,t,e){Do(t,i,e)},getCenter(i,t){return{x:i.x+(t.x-i.x)/2,y:i.y+(t.y-i.y)/2}},getCenterX(i,t){return i+(t-i)/2},getCenterY(i,t){return i+(t-i)/2},getDistance(i,t){return Ln(i.x,i.y,t.x,t.y)},getDistanceFrom(i,t,e,s){const n=Io(e-i),r=Io(s-t);return Kc(n*n+r*r)},getMinDistanceFrom(i,t,e,s,n,r){return Zc(Ln(i,t,e,s),Ln(e,s,n,r))},getAngle(i,t){return Wo(i,t)/z},getRotation(i,t,e,s){return s||(s=t),Ue.getRadianFrom(i.x,i.y,t.x,t.y,e.x,e.y,s.x,s.y)/z},getRadianFrom(i,t,e,s,n,r,o,a){o===void 0&&(o=e,a=s);let h=An(t-s,i-e);const c=An(r-a,n-o)-h;return c<-Qc?c+Dt:c},getAtan2(i,t){return An(t.y-i.y,t.x-i.x)},getDistancePoint(i,t,e,s){const n=Wo(i,t);return t=s?t:{},t.x=i.x+Fo(n)*e,t.y=i.y+Mo(n)*e,t},toNumberPoints(i){let t=i;return typeof i[0]=="object"&&(t=[],i.forEach(e=>t.push(e.x,e.y))),t},reset(i){}},Ue=T,{getDistanceFrom:Ln,copy:Dn,getAtan2:Wo}=Ue;class Ki{constructor(t,e){this.set(t,e)}set(t,e){return typeof t=="object"?T.copy(this,t):T.set(this,t,e),this}get(){const{x:t,y:e}=this;return{x:t,y:e}}clone(){return new Ki(this)}move(t,e){return T.move(this,t,e),this}scale(t,e){return T.scale(this,t,e),this}scaleOf(t,e,s){return T.scaleOf(this,t,e,s),this}rotate(t,e){return T.rotate(this,t,e),this}rotateOf(t,e){return T.rotate(this,e,t),this}getRotation(t,e,s){return T.getRotation(this,t,e,s)}toInnerOf(t,e){return T.toInnerOf(this,t,e),this}toOuterOf(t,e){return T.toOuterOf(this,t,e),this}getCenter(t){return new Ki(T.getCenter(this,t))}getDistance(t){return T.getDistance(this,t)}getDistancePoint(t,e,s){return new Ki(T.getDistancePoint(this,t,e,s))}getAngle(t){return T.getAngle(this,t)}getAtan2(t){return T.getAtan2(this,t)}reset(){return this}}new Ki;class De{constructor(t,e,s,n,r,o){this.set(t,e,s,n,r,o)}set(t,e,s,n,r,o){return typeof t=="object"?k.copy(this,t):k.set(this,t,e,s,n,r,o),this}setWith(t){return k.copy(this,t),this.scaleX=t.scaleX,this.scaleY=t.scaleY,this}get(){const{a:t,b:e,c:s,d:n,e:r,f:o}=this;return{a:t,b:e,c:s,d:n,e:r,f:o}}clone(){return new De(this)}translate(t,e){return k.translate(this,t,e),this}translateInner(t,e){return k.translateInner(this,t,e),this}scale(t,e){return k.scale(this,t,e),this}scaleWith(t,e){return k.scale(this,t,e),this.scaleX*=t,this.scaleY*=e||t,this}scaleOfOuter(t,e,s){return k.scaleOfOuter(this,t,e,s),this}scaleOfInner(t,e,s){return k.scaleOfInner(this,t,e,s),this}rotate(t){return k.rotate(this,t),this}rotateOfOuter(t,e){return k.rotateOfOuter(this,t,e),this}rotateOfInner(t,e){return k.rotateOfInner(this,t,e),this}skew(t,e){return k.skew(this,t,e),this}skewOfOuter(t,e,s){return k.skewOfOuter(this,t,e,s),this}skewOfInner(t,e,s){return k.skewOfInner(this,t,e,s),this}multiply(t){return k.multiply(this,t),this}multiplyParent(t){return k.multiplyParent(this,t),this}divide(t){return k.divide(this,t),this}divideParent(t){return k.divideParent(this,t),this}invert(){return k.invert(this),this}invertWith(){return k.invert(this),this.scaleX=1/this.scaleX,this.scaleY=1/this.scaleY,this}toOuterPoint(t,e,s){k.toOuterPoint(this,t,e,s)}toInnerPoint(t,e,s){k.toInnerPoint(this,t,e,s)}setLayout(t,e,s){return k.setLayout(this,t,e,s),this}getLayout(t,e,s){return k.getLayout(this,t,e,s)}withScale(t,e){return k.withScale(this,t,e)}reset(){k.reset(this)}}new De;const hs={tempPointBounds:{},setPoint(i,t,e){i.minX=i.maxX=t,i.minY=i.maxY=e},addPoint(i,t,e){i.minX=t<i.minX?t:i.minX,i.minY=e<i.minY?e:i.minY,i.maxX=t>i.maxX?t:i.maxX,i.maxY=e>i.maxY?e:i.maxY},addBounds(i,t,e,s,n){$o(i,t,e),$o(i,t+s,e+n)},copy(i,t){i.minX=t.minX,i.minY=t.minY,i.maxX=t.maxX,i.maxY=t.maxY},addPointBounds(i,t){i.minX=t.minX<i.minX?t.minX:i.minX,i.minY=t.minY<i.minY?t.minY:i.minY,i.maxX=t.maxX>i.maxX?t.maxX:i.maxX,i.maxY=t.maxY>i.maxY?t.maxY:i.maxY},toBounds(i,t){t.x=i.minX,t.y=i.minY,t.width=i.maxX-i.minX,t.height=i.maxY-i.minY}},{addPoint:$o}=hs,{tempPointBounds:Te,setPoint:zo,addPoint:ms,toBounds:jo}=hs,{toOuterPoint:ws}=k,{float:xs,fourNumber:Jc}=ct,{floor:No,ceil:vs}=Math;let Zt,Qt,We,$e;const ue={},Pt={},S={tempBounds:{},set(i,t=0,e=0,s=0,n=0){i.x=t,i.y=e,i.width=s,i.height=n},copy(i,t){i.x=t.x,i.y=t.y,i.width=t.width,i.height=t.height},copyAndSpread(i,t,e,s,n){const{x:r,y:o,width:a,height:h}=t;if(e instanceof Array){const l=Jc(e);s?I.set(i,r+l[3],o+l[0],a-l[1]-l[3],h-l[2]-l[0]):I.set(i,r-l[3],o-l[0],a+l[1]+l[3],h+l[2]+l[0])}else s&&(e=-e),I.set(i,r-e,o-e,a+e*2,h+e*2);n&&(n==="width"?(i.y=o,i.height=h):(i.x=r,i.width=a))},minX(i){return i.width>0?i.x:i.x+i.width},minY(i){return i.height>0?i.y:i.y+i.height},maxX(i){return i.width>0?i.x+i.width:i.x},maxY(i){return i.height>0?i.y+i.height:i.y},move(i,t,e){i.x+=t,i.y+=e},getByMove(i,t,e){return i=Object.assign({},i),I.move(i,t,e),i},toOffsetOutBounds(i,t,e){t?Go(t,i):t=i,e?(t.offsetX=-(I.maxX(e)-i.x),t.offsetY=-(I.maxY(e)-i.y)):(t.offsetX=i.x+i.width,t.offsetY=i.y+i.height),I.move(t,-t.offsetX,-t.offsetY)},scale(i,t,e=t){T.scale(i,t,e),i.width*=t,i.height*=e},scaleOf(i,t,e,s=e){T.scaleOf(i,t,e,s),i.width*=e,i.height*=s},tempToOuterOf(i,t){return I.copy(I.tempBounds,i),I.toOuterOf(I.tempBounds,t),I.tempBounds},getOuterOf(i,t){return i=Object.assign({},i),I.toOuterOf(i,t),i},toOuterOf(i,t,e){if(e||(e=i),t.b===0&&t.c===0){const{a:s,d:n}=t;s>0?(e.width=i.width*s,e.x=t.e+i.x*s):(e.width=i.width*-s,e.x=t.e+i.x*s-e.width),n>0?(e.height=i.height*n,e.y=t.f+i.y*n):(e.height=i.height*-n,e.y=t.f+i.y*n-e.height)}else ue.x=i.x,ue.y=i.y,ws(t,ue,Pt),zo(Te,Pt.x,Pt.y),ue.x=i.x+i.width,ws(t,ue,Pt),ms(Te,Pt.x,Pt.y),ue.y=i.y+i.height,ws(t,ue,Pt),ms(Te,Pt.x,Pt.y),ue.x=i.x,ws(t,ue,Pt),ms(Te,Pt.x,Pt.y),jo(Te,e)},toInnerOf(i,t,e){e||(e=i),I.move(e,-t.e,-t.f),I.scale(e,1/t.a,1/t.d)},getFitMatrix(i,t,e=1){const s=Math.min(e,Math.min(i.width/t.width,i.height/t.height));return new De(s,0,0,s,-t.x*s,-t.y*s)},getSpread(i,t,e){const s={};return I.copyAndSpread(s,i,t,!1,e),s},spread(i,t,e){I.copyAndSpread(i,i,t,!1,e)},shrink(i,t,e){I.copyAndSpread(i,i,t,!0,e)},ceil(i){const{x:t,y:e}=i;i.x=No(i.x),i.y=No(i.y),i.width=t>i.x?vs(i.width+t-i.x):vs(i.width),i.height=e>i.y?vs(i.height+e-i.y):vs(i.height)},unsign(i){i.width<0&&(i.x+=i.width,i.width=-i.width),i.height<0&&(i.y+=i.height,i.height=-i.height)},float(i,t){i.x=xs(i.x,t),i.y=xs(i.y,t),i.width=xs(i.width,t),i.height=xs(i.height,t)},add(i,t,e){Zt=i.x+i.width,Qt=i.y+i.height,We=t.x,$e=t.y,e||(We+=t.width,$e+=t.height),Zt=Zt>We?Zt:We,Qt=Qt>$e?Qt:$e,i.x=i.x<t.x?i.x:t.x,i.y=i.y<t.y?i.y:t.y,i.width=Zt-i.x,i.height=Qt-i.y},addList(i,t){I.setListWithFn(i,t,void 0,!0)},setList(i,t,e=!1){I.setListWithFn(i,t,void 0,e)},addListWithFn(i,t,e){I.setListWithFn(i,t,e,!0)},setListWithFn(i,t,e,s=!1){let n,r=!0;for(let o=0,a=t.length;o<a;o++)n=e?e(t[o]):t[o],n&&(n.width||n.height)&&(r?(r=!1,s||Go(i,n)):Ho(i,n));r&&I.reset(i)},setPoints(i,t){t.forEach((e,s)=>s===0?zo(Te,e.x,e.y):ms(Te,e.x,e.y)),jo(Te,i)},setPoint(i,t){I.set(i,t.x,t.y)},addPoint(i,t){Ho(i,t,!0)},getPoints(i){const{x:t,y:e,width:s,height:n}=i;return[{x:t,y:e},{x:t+s,y:e},{x:t+s,y:e+n},{x:t,y:e+n}]},hitRadiusPoint(i,t,e){return e&&(t=T.tempToInnerRadiusPointOf(t,e)),t.x>=i.x-t.radiusX&&t.x<=i.x+i.width+t.radiusX&&t.y>=i.y-t.radiusY&&t.y<=i.y+i.height+t.radiusY},hitPoint(i,t,e){return e&&(t=T.tempToInnerOf(t,e)),t.x>=i.x&&t.x<=i.x+i.width&&t.y>=i.y&&t.y<=i.y+i.height},hit(i,t,e){return e&&(t=I.tempToOuterOf(t,e)),!(i.y+i.height<t.y||t.y+t.height<i.y||i.x+i.width<t.x||t.x+t.width<i.x)},includes(i,t,e){return e&&(t=I.tempToOuterOf(t,e)),i.x<=t.x&&i.y<=t.y&&i.x+i.width>=t.x+t.width&&i.y+i.height>=t.y+t.height},getIntersectData(i,t,e){if(e&&(t=I.tempToOuterOf(t,e)),!I.hit(i,t))return Jh();let{x:s,y:n,width:r,height:o}=t;return Zt=s+r,Qt=n+o,We=i.x+i.width,$e=i.y+i.height,s=s>i.x?s:i.x,n=n>i.y?n:i.y,Zt=Zt<We?Zt:We,Qt=Qt<$e?Qt:$e,r=Zt-s,o=Qt-n,{x:s,y:n,width:r,height:o}},intersect(i,t,e){I.copy(i,I.getIntersectData(i,t,e))},isSame(i,t){return i.x===t.x&&i.y===t.y&&i.width===t.width&&i.height===t.height},isEmpty(i){return i.x===0&&i.y===0&&i.width===0&&i.height===0},reset(i){I.set(i)}},I=S,{add:Ho,copy:Go}=I;class J{get minX(){return S.minX(this)}get minY(){return S.minY(this)}get maxX(){return S.maxX(this)}get maxY(){return S.maxY(this)}constructor(t,e,s,n){this.set(t,e,s,n)}set(t,e,s,n){return typeof t=="object"?S.copy(this,t):S.set(this,t,e,s,n),this}get(){const{x:t,y:e,width:s,height:n}=this;return{x:t,y:e,width:s,height:n}}clone(){return new J(this)}move(t,e){return S.move(this,t,e),this}scale(t,e){return S.scale(this,t,e),this}scaleOf(t,e,s){return S.scaleOf(this,t,e,s),this}toOuterOf(t,e){return S.toOuterOf(this,t,e),this}toInnerOf(t,e){return S.toInnerOf(this,t,e),this}getFitMatrix(t,e){return S.getFitMatrix(this,t,e)}spread(t,e){return S.spread(this,t,e),this}shrink(t,e){return S.shrink(this,t,e),this}ceil(){return S.ceil(this),this}unsign(){return S.unsign(this),this}float(t){return S.float(this,t),this}add(t){return S.add(this,t),this}addList(t){return S.setList(this,t,!0),this}setList(t){return S.setList(this,t),this}addListWithFn(t,e){return S.setListWithFn(this,t,e,!0),this}setListWithFn(t,e){return S.setListWithFn(this,t,e),this}setPoint(t){return S.setPoint(this,t),this}setPoints(t){return S.setPoints(this,t),this}addPoint(t){return S.addPoint(this,t),this}getPoints(){return S.getPoints(this)}hitPoint(t,e){return S.hitPoint(this,t,e)}hitRadiusPoint(t,e){return S.hitRadiusPoint(this,t,e)}hit(t,e){return S.hit(this,t,e)}includes(t,e){return S.includes(this,t,e)}intersect(t,e){return S.intersect(this,t,e),this}getIntersect(t,e){return new J(S.getIntersectData(this,t,e))}isSame(t){return S.isSame(this,t)}isEmpty(){return S.isEmpty(this)}reset(){S.reset(this)}}const M=new J;class tu{constructor(t,e,s,n,r,o){typeof t=="object"?this.copy(t):this.set(t,e,s,n,r,o)}set(t=0,e=0,s=0,n=0,r=0,o=0){this.top=t,this.right=e,this.bottom=s,this.left=n,this.width=r,this.height=o}copy(t){const{top:e,right:s,bottom:n,left:r,width:o,height:a}=t;this.set(e,s,n,r,o,a)}getBoundsFrom(t){const{top:e,right:s,bottom:n,left:r,width:o,height:a}=this;return new J(r,e,o||t.width-r-s,a||t.height-e-n)}}var Mr;(function(i){i[i.top=0]="top",i[i.right=1]="right",i[i.bottom=2]="bottom",i[i.left=3]="left"})(Mr||(Mr={}));var tn;(function(i){i[i.topLeft=0]="topLeft",i[i.top=1]="top",i[i.topRight=2]="topRight",i[i.right=3]="right",i[i.bottomRight=4]="bottomRight",i[i.bottom=5]="bottom",i[i.bottomLeft=6]="bottomLeft",i[i.left=7]="left",i[i.center=8]="center",i[i["top-left"]=0]="top-left",i[i["top-right"]=2]="top-right",i[i["bottom-right"]=4]="bottom-right",i[i["bottom-left"]=6]="bottom-left"})(tn||(tn={}));const Qr=[{x:0,y:0},{x:.5,y:0},{x:1,y:0},{x:1,y:.5},{x:1,y:1},{x:.5,y:1},{x:0,y:1},{x:0,y:.5},{x:.5,y:.5}];Qr.forEach(i=>i.type="percent");const ki={directionData:Qr,tempPoint:{},get:Uo,toPoint(i,t,e,s,n){const r=Uo(i);e.x=r.x,e.y=r.y,r.type==="percent"&&(e.x*=t.width,e.y*=t.height,n&&(e.x-=n.x,e.y-=n.y,r.x&&(e.x-=r.x===1?n.width:r.x===.5?r.x*n.width:0),r.y&&(e.y-=r.y===1?n.height:r.y===.5?r.y*n.height:0))),s||(e.x+=t.x,e.y+=t.y)}};function Uo(i){return typeof i=="string"?Qr[tn[i]]:i}const{toPoint:eu}=ki,tl={toPoint(i,t,e,s,n){eu(i,e,s,n,t)}},iu={0:1,1:1,2:1,3:1,4:1,5:1,6:1,7:1,8:1,9:1,".":1,e:1,E:1};class N{constructor(t){this.repeatMap={},this.name=t}static get(t){return new N(t)}static set filter(t){this.filterList=Yo(t)}static set exclude(t){this.excludeList=Yo(t)}log(...t){if(ze.enable){if(ze.filterList.length&&ze.filterList.every(e=>e!==this.name)||ze.excludeList.length&&ze.excludeList.some(e=>e===this.name))return;console.log("%c"+this.name,"color:#21ae62",...t)}}tip(...t){ze.enable&&this.warn(...t)}warn(...t){ze.showWarn&&console.warn(this.name,...t)}repeat(t,...e){this.repeatMap[t]||(this.warn("repeat:"+t,...e),this.repeatMap[t]=!0)}error(...t){try{throw new Error}catch(e){console.error(this.name,...t,e)}}}N.filterList=[];N.excludeList=[];N.showWarn=!0;function Yo(i){return i?typeof i=="string"&&(i=[i]):i=[],i}const ze=N,su=N.get("RunTime"),Ut={currentId:0,currentName:"",idMap:{},nameMap:{},nameToIdMap:{},start(i,t){const e=we.create(we.RUNTIME);return Ot.currentId=Ot.idMap[e]=t?performance.now():Date.now(),Ot.currentName=Ot.nameMap[e]=i,Ot.nameToIdMap[i]=e,e},end(i,t){const e=Ot.idMap[i],s=Ot.nameMap[i],n=t?(performance.now()-e)/1e3:Date.now()-e;Ot.idMap[i]=Ot.nameMap[i]=Ot.nameToIdMap[s]=void 0,su.log(s,n,"ms")},endOfName(i,t){const e=Ot.nameToIdMap[i];e!==void 0&&Ot.end(e,t)}},Ot=Ut;function bi(i){console.error("need plugin: @leafer-in/"+i)}const Xo=N.get("UICreator"),fn={list:{},register(i){const{__tag:t}=i.prototype;bs[t]&&Xo.repeat(t),bs[t]=i},get(i,t,e,s,n,r){bs[i]||Xo.error("not register "+i);const o=new bs[i](t);return e!==void 0&&(o.x=e,s&&(o.y=s),n&&(o.width=n),r&&(o.height=r)),o}},{list:bs}=fn,nu=N.get("EventCreator"),Bi={nameList:{},register(i){let t;Object.keys(i).forEach(e=>{t=i[e],typeof t=="string"&&(Di[t]&&nu.repeat(t),Di[t]=i)})},changeName(i,t){const e=Di[i];if(e){const s=Object.keys(e).find(n=>e[n]===i);s&&(e[s]=t,Di[t]=e)}},has(i){return!!this.nameList[i]},get(i,...t){return new Di[i](...t)}},{nameList:Di}=Bi;class el{constructor(){this.list=[]}add(t){t.manager=this,this.list.push(t)}get(t){let e;const{list:s}=this;for(let r=0,o=s.length;r<o;r++)if(e=s[r],e.recycled&&e.isSameSize(t))return e.recycled=!1,e.manager||(e.manager=this),e;const n=rt.canvas(t);return this.add(n),n}recycle(t){t.recycled=!0}clearRecycled(){let t;const e=[];for(let s=0,n=this.list.length;s<n;s++)t=this.list[s],t.recycled?t.destroy():e.push(t);this.list=e}clear(){this.list.forEach(t=>{t.destroy()}),this.list.length=0}destroy(){this.clear()}}const lt={default(i,t){return Mn(t,i),Mn(i,t),i},assign(i,t){let e;Object.keys(t).forEach(s=>{var n;e=t[s],(e==null?void 0:e.constructor)===Object&&((n=i[s])===null||n===void 0?void 0:n.constructor)===Object?Mn(i[s],t[s]):i[s]=t[s]})},copyAttrs(i,t,e){return e.forEach(s=>{t[s]!==void 0&&(i[s]=t[s])}),i},clone(i){return JSON.parse(JSON.stringify(i))},toMap(i){const t={};for(let e=0,s=i.length;e<s;e++)t[i[e]]=!0;return t}},{assign:Mn}=lt;class il{get __useNaturalRatio(){return!0}get __isLinePath(){const{path:t}=this;return t&&t.length===6&&t[0]===1}get __blendMode(){if(this.eraser&&this.eraser!=="path")return"destination-out";const{blendMode:t}=this;return t==="pass-through"?null:t}constructor(t){this.__leaf=t}__get(t){if(this.__input){const e=this.__input[t];if(e!==void 0)return e}return this[t]}__getData(){const t={tag:this.__leaf.tag},{__input:e}=this;let s;for(let n in this)n[0]!=="_"&&(s=e?e[n]:void 0,t[n]=s===void 0?this[n]:s);return t}__setInput(t,e){this.__input||(this.__input={}),this.__input[t]=e}__getInput(t){if(this.__input){const e=this.__input[t];if(e!==void 0)return e}if(!(t==="path"&&!this.__pathInputed))return this["_"+t]}__removeInput(t){this.__input&&this.__input[t]!==void 0&&(this.__input[t]=void 0)}__getInputData(t,e){const s={};if(t)if(t instanceof Array)for(let n of t)s[n]=this.__getInput(n);else for(let n in t)s[n]=this.__getInput(n);else{let n,r,{__input:o}=this;s.tag=this.__leaf.tag;for(let a in this)if(a[0]!=="_"&&(n=this["_"+a],n!==void 0)){if(a==="path"&&!this.__pathInputed)continue;r=o?o[a]:void 0,s[a]=r===void 0?n:r}}if(e&&e.matrix){const{a:n,b:r,c:o,d:a,e:h,f:l}=this.__leaf.__localMatrix;s.matrix={a:n,b:r,c:o,d:a,e:h,f:l}}return s}__setMiddle(t,e){this.__middle||(this.__middle={}),this.__middle[t]=e}__getMiddle(t){return this.__middle&&this.__middle[t]}__checkSingle(){const t=this;if(t.blendMode==="pass-through"){const e=this.__leaf;t.opacity<1&&(e.isBranch||t.__hasMultiPaint)||e.__hasEraser||t.eraser?t.__single=!0:t.__single&&(t.__single=!1)}else t.__single=!0}__removeNaturalSize(){this.__naturalWidth=this.__naturalHeight=void 0}destroy(){this.__input=this.__middle=null}}var Fr;(function(i){i[i.No=0]="No",i[i.Yes=1]="Yes",i[i.NoAndSkip=2]="NoAndSkip",i[i.YesAndSkip=3]="YesAndSkip"})(Fr||(Fr={}));function Fn(i){return i==null}function b(i,t,e,s){var n=arguments.length,r=n<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,e):s,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(i,t,e,s);else for(var a=i.length-1;a>=0;a--)(o=i[a])&&(r=(n<3?o(r):n>3?o(t,e,r):o(t,e))||r);return n>3&&r&&Object.defineProperty(t,e,r),r}function sl(i,t,e,s){function n(r){return r instanceof e?r:new e(function(o){o(r)})}return new(e||(e=Promise))(function(r,o){function a(c){try{l(s.next(c))}catch(d){o(d)}}function h(c){try{l(s.throw(c))}catch(d){o(d)}}function l(c){c.done?r(c.value):n(c.value).then(a,h)}l((s=s.apply(i,[])).next())})}function V(i){return(t,e)=>{i||(i=e),Object.defineProperty(t,e,{get(){return this.context[i]},set(s){this.context[i]=s}})}}const nl=[];function F(){return(i,t)=>{nl.push(t)}}const ru=[];let E=class{set blendMode(t){t==="normal"&&(t="source-over"),this.context.globalCompositeOperation=t}get blendMode(){return this.context.globalCompositeOperation}set dashPattern(t){this.context.setLineDash(t||ru)}get dashPattern(){return this.context.getLineDash()}__bindContext(){let t;nl.forEach(e=>{t=this.context[e],t&&(this[e]=t.bind(this.context))}),this.textBaseline="alphabetic"}setTransform(t,e,s,n,r,o){}resetTransform(){}getTransform(){}save(){}restore(){}transform(t,e,s,n,r,o){typeof t=="object"?this.context.transform(t.a,t.b,t.c,t.d,t.e,t.f):this.context.transform(t,e,s,n,r,o)}translate(t,e){}scale(t,e){}rotate(t){}fill(t,e){}stroke(t){}clip(t,e){}fillRect(t,e,s,n){}strokeRect(t,e,s,n){}clearRect(t,e,s,n){}drawImage(t,e,s,n,r,o,a,h,l){switch(arguments.length){case 9:if(e<0){const c=-e/n*h;n+=e,e=0,o+=c,h-=c}if(s<0){const c=-s/r*l;r+=s,s=0,a+=c,l-=c}this.context.drawImage(t,e,s,n,r,o,a,h,l);break;case 5:this.context.drawImage(t,e,s,n,r);break;case 3:this.context.drawImage(t,e,s)}}beginPath(){}moveTo(t,e){}lineTo(t,e){}bezierCurveTo(t,e,s,n,r,o){}quadraticCurveTo(t,e,s,n){}closePath(){}arc(t,e,s,n,r,o){}arcTo(t,e,s,n,r){}ellipse(t,e,s,n,r,o,a,h){}rect(t,e,s,n){}roundRect(t,e,s,n,r){}createConicGradient(t,e,s){}createLinearGradient(t,e,s,n){}createPattern(t,e){}createRadialGradient(t,e,s,n,r,o){}fillText(t,e,s,n){}measureText(t){}strokeText(t,e,s,n){}destroy(){this.context=null}};b([V("imageSmoothingEnabled")],E.prototype,"smooth",void 0);b([V("imageSmoothingQuality")],E.prototype,"smoothLevel",void 0);b([V("globalAlpha")],E.prototype,"opacity",void 0);b([V()],E.prototype,"fillStyle",void 0);b([V()],E.prototype,"strokeStyle",void 0);b([V("lineWidth")],E.prototype,"strokeWidth",void 0);b([V("lineCap")],E.prototype,"strokeCap",void 0);b([V("lineJoin")],E.prototype,"strokeJoin",void 0);b([V("lineDashOffset")],E.prototype,"dashOffset",void 0);b([V()],E.prototype,"miterLimit",void 0);b([V()],E.prototype,"shadowBlur",void 0);b([V()],E.prototype,"shadowColor",void 0);b([V()],E.prototype,"shadowOffsetX",void 0);b([V()],E.prototype,"shadowOffsetY",void 0);b([V()],E.prototype,"filter",void 0);b([V()],E.prototype,"font",void 0);b([V()],E.prototype,"fontKerning",void 0);b([V()],E.prototype,"fontStretch",void 0);b([V()],E.prototype,"fontVariantCaps",void 0);b([V()],E.prototype,"textAlign",void 0);b([V()],E.prototype,"textBaseline",void 0);b([V()],E.prototype,"textRendering",void 0);b([V()],E.prototype,"wordSpacing",void 0);b([V()],E.prototype,"letterSpacing",void 0);b([V()],E.prototype,"direction",void 0);b([F()],E.prototype,"setTransform",null);b([F()],E.prototype,"resetTransform",null);b([F()],E.prototype,"getTransform",null);b([F()],E.prototype,"save",null);b([F()],E.prototype,"restore",null);b([F()],E.prototype,"translate",null);b([F()],E.prototype,"scale",null);b([F()],E.prototype,"rotate",null);b([F()],E.prototype,"fill",null);b([F()],E.prototype,"stroke",null);b([F()],E.prototype,"clip",null);b([F()],E.prototype,"fillRect",null);b([F()],E.prototype,"strokeRect",null);b([F()],E.prototype,"clearRect",null);b([F()],E.prototype,"beginPath",null);b([F()],E.prototype,"moveTo",null);b([F()],E.prototype,"lineTo",null);b([F()],E.prototype,"bezierCurveTo",null);b([F()],E.prototype,"quadraticCurveTo",null);b([F()],E.prototype,"closePath",null);b([F()],E.prototype,"arc",null);b([F()],E.prototype,"arcTo",null);b([F()],E.prototype,"ellipse",null);b([F()],E.prototype,"rect",null);b([F()],E.prototype,"roundRect",null);b([F()],E.prototype,"createConicGradient",null);b([F()],E.prototype,"createLinearGradient",null);b([F()],E.prototype,"createPattern",null);b([F()],E.prototype,"createRadialGradient",null);b([F()],E.prototype,"fillText",null);b([F()],E.prototype,"measureText",null);b([F()],E.prototype,"strokeText",null);const{copy:ou}=k,au={width:1,height:1,pixelRatio:1},Gt=["width","height","pixelRatio"];class Jr extends E{get width(){return this.size.width}get height(){return this.size.height}get pixelRatio(){return this.size.pixelRatio}get pixelWidth(){return this.width*this.pixelRatio}get pixelHeight(){return this.height*this.pixelRatio}get allowBackgroundColor(){return this.view&&this.parentView}constructor(t,e){super(),this.size={},this.worldTransform={},t||(t=au),t.pixelRatio||(t.pixelRatio=x.devicePixelRatio),this.manager=e,this.innerId=we.create(we.CNAVAS);const{width:s,height:n,pixelRatio:r}=t;this.autoLayout=!s||!n,this.size.pixelRatio=r,this.config=t,this.init()}init(){}__createContext(){const{view:t}=this,{contextSettings:e}=this.config;this.context=e?t.getContext("2d",e):t.getContext("2d"),this.__bindContext()}export(t,e){}toBlob(t,e){}toDataURL(t,e){}saveAs(t,e){}resize(t){if(this.isSameSize(t))return;let e;this.context&&!this.unreal&&this.width&&(e=this.getSameCanvas(),e.copyWorld(this));const s=this.size;lt.copyAttrs(s,t,Gt),Gt.forEach(n=>s[n]||(s[n]=1)),this.bounds=new J(0,0,this.width,this.height),this.context&&!this.unreal&&(this.updateViewSize(),this.smooth=this.config.smooth),this.updateClientBounds(),this.context&&!this.unreal&&e&&(this.clearWorld(e.bounds),this.copyWorld(e),e.recycle())}updateViewSize(){}updateClientBounds(){}getClientBounds(t){return t&&this.updateClientBounds(),this.clientBounds||this.bounds}startAutoLayout(t,e){}stopAutoLayout(){}setCursor(t){}setWorld(t,e){const{pixelRatio:s}=this,n=this.worldTransform;if(e){const{a:r,b:o,c:a,d:h,e:l,f:c}=e;this.setTransform(n.a=(t.a*r+t.b*a)*s,n.b=(t.a*o+t.b*h)*s,n.c=(t.c*r+t.d*a)*s,n.d=(t.c*o+t.d*h)*s,n.e=(t.e*r+t.f*a+l)*s,n.f=(t.e*o+t.f*h+c)*s)}else this.setTransform(n.a=t.a*s,n.b=t.b*s,n.c=t.c*s,n.d=t.d*s,n.e=t.e*s,n.f=t.f*s)}useWorldTransform(t){t&&(this.worldTransform=t);const e=this.worldTransform;e&&this.setTransform(e.a,e.b,e.c,e.d,e.e,e.f)}setStroke(t,e,s){e&&(this.strokeWidth=e),t&&(this.strokeStyle=t),s&&this.setStrokeOptions(s)}setStrokeOptions(t){this.strokeCap=t.strokeCap==="none"?"butt":t.strokeCap,this.strokeJoin=t.strokeJoin,this.dashPattern=t.dashPattern,this.dashOffset=t.dashOffset,this.miterLimit=t.miterLimit}saveBlendMode(t){this.savedBlendMode=this.blendMode,this.blendMode=t}restoreBlendMode(){this.blendMode=this.savedBlendMode}hitFill(t,e){return!0}hitStroke(t,e){return!0}hitPixel(t,e,s=1){return!0}setWorldShadow(t,e,s,n){const{pixelRatio:r}=this;this.shadowOffsetX=t*r,this.shadowOffsetY=e*r,this.shadowBlur=s*r,this.shadowColor=n||"black"}setWorldBlur(t){const{pixelRatio:e}=this;this.filter=`blur(${t*e}px)`}copyWorld(t,e,s,n){if(n&&(this.blendMode=n),e){const{pixelRatio:r}=this;s||(s=e),this.drawImage(t.view,e.x*r,e.y*r,e.width*r,e.height*r,s.x*r,s.y*r,s.width*r,s.height*r)}else this.drawImage(t.view,0,0);n&&(this.blendMode="source-over")}copyWorldToInner(t,e,s,n){if(n&&(this.blendMode=n),e.b||e.c)this.save(),this.resetTransform(),this.copyWorld(t,e,S.tempToOuterOf(s,e)),this.restore();else{const{pixelRatio:r}=this;this.drawImage(t.view,e.x*r,e.y*r,e.width*r,e.height*r,s.x,s.y,s.width,s.height)}n&&(this.blendMode="source-over")}copyWorldByReset(t,e,s,n,r){this.resetTransform(),this.copyWorld(t,e,s,n),r||this.useWorldTransform()}useGrayscaleAlpha(t){this.setTempBounds(t,!0,!0);let e,s;const{context:n}=this,r=n.getImageData(M.x,M.y,M.width,M.height),{data:o}=r;for(let a=0,h=o.length;a<h;a+=4)s=o[a]*.299+o[a+1]*.587+o[a+2]*.114,(e=o[a+3])&&(o[a+3]=e===255?s:e*(s/255));n.putImageData(r,M.x,M.y)}useMask(t,e,s){this.copyWorld(t,e,s,"destination-in")}useEraser(t,e,s){this.copyWorld(t,e,s,"destination-out")}fillWorld(t,e,s){s&&(this.blendMode=s),this.fillStyle=e,this.setTempBounds(t),this.fillRect(M.x,M.y,M.width,M.height),s&&(this.blendMode="source-over")}strokeWorld(t,e,s){s&&(this.blendMode=s),this.strokeStyle=e,this.setTempBounds(t),this.strokeRect(M.x,M.y,M.width,M.height),s&&(this.blendMode="source-over")}clearWorld(t,e){this.setTempBounds(t,e),this.clearRect(M.x,M.y,M.width,M.height)}clipWorld(t,e){this.beginPath(),this.setTempBounds(t,e),this.rect(M.x,M.y,M.width,M.height),this.clip()}clear(){const{pixelRatio:t}=this;this.clearRect(0,0,this.width*t+2,this.height*t+2)}setTempBounds(t,e,s){M.set(t),s&&M.intersect(this.bounds),M.scale(this.pixelRatio),e&&M.ceil()}isSameSize(t){return this.width===t.width&&this.height===t.height&&this.pixelRatio===t.pixelRatio}getSameCanvas(t,e){const s=this.manager?this.manager.get(this.size):rt.canvas(Object.assign({},this.size));return s.save(),t&&(ou(s.worldTransform,this.worldTransform),s.useWorldTransform()),e&&(s.smooth=this.smooth),s}recycle(t){this.recycled||(this.restore(),t?this.clearWorld(t,!0):this.clear(),this.manager?this.manager.recycle(this):this.destroy())}updateRender(t){}unrealCanvas(){}destroy(){this.manager=this.view=this.parentView=null}}const te={creator:{},parse(i,t){},convertToCanvasData(i,t){}},rl={N:21,D:22,X:23,G:24,F:25,O:26,P:27,U:28},Wt=Object.assign({M:1,m:10,L:2,l:20,H:3,h:30,V:4,v:40,C:5,c:50,S:6,s:60,Q:7,q:70,T:8,t:80,A:9,a:90,Z:11,z:11,R:12},rl),ol={M:3,m:3,L:3,l:3,H:2,h:2,V:2,v:2,C:7,c:7,S:5,s:5,Q:5,q:5,T:3,t:3,A:8,a:8,Z:1,z:1,N:5,D:9,X:6,G:9,F:5,O:7,P:4,U:6},al={m:10,l:20,H:3,h:30,V:4,v:40,c:50,S:6,s:60,q:70,T:8,t:80,A:9,a:90},hu=Object.assign(Object.assign({},al),rl),en=Wt,hl={};for(let i in en)hl[en[i]]=i;const ll={};for(let i in en)ll[en[i]]=ol[i];const cl={drawRoundRect(i,t,e,s,n,r){const o=ct.fourNumber(r,Math.min(s/2,n/2)),a=t+s,h=e+n;o[0]?i.moveTo(t+o[0],e):i.moveTo(t,e),o[1]?i.arcTo(a,e,a,h,o[1]):i.lineTo(a,e),o[2]?i.arcTo(a,h,t,h,o[2]):i.lineTo(a,h),o[3]?i.arcTo(t,h,t,e,o[3]):i.lineTo(t,h),o[0]?i.arcTo(t,e,a,e,o[0]):i.lineTo(t,e)}},{sin:ri,cos:Mi,atan2:Vo,ceil:lu,abs:In,PI:qo,sqrt:Ko,pow:Bs}=Math,{setPoint:Wn,addPoint:Cs}=hs,{set:Es,toNumberPoints:cu}=T,{M:Zo,L:$n,C:zn,Q:Qo,Z:uu}=Wt,jn={},Ye={points(i,t,e,s){let n=cu(t);if(i.push(Zo,n[0],n[1]),e&&n.length>5){let r,o,a,h,l,c,d,f,u,_,y,w,B,g=n.length;const R=e===!0?.5:e;s&&(n=[n[g-2],n[g-1],...n,n[0],n[1],n[2],n[3]],g=n.length);for(let v=2;v<g-2;v+=2)r=n[v-2],o=n[v-1],a=n[v],h=n[v+1],l=n[v+2],c=n[v+3],y=Ko(Bs(a-r,2)+Bs(h-o,2)),w=Ko(Bs(l-a,2)+Bs(c-h,2)),B=y+w,y=R*y/B,w=R*w/B,l-=r,c-=o,d=a-y*l,f=h-y*c,v===2?s||i.push(Qo,d,f,a,h):i.push(zn,u,_,d,f,a,h),u=a+w*l,_=h+w*c;s||i.push(Qo,u,_,n[g-2],n[g-1])}else for(let r=2,o=n.length;r<o;r+=2)i.push($n,n[r],n[r+1]);s&&i.push(uu)},rect(i,t,e,s,n){te.creator.path=i,te.creator.moveTo(t,e).lineTo(t+s,e).lineTo(t+s,e+n).lineTo(t,e+n).lineTo(t,e)},roundRect(i,t,e,s,n,r){te.creator.path=[],cl.drawRoundRect(te.creator,t,e,s,n,r),i.push(...te.convertToCanvasData(te.creator.path,!0))},arcTo(i,t,e,s,n,r,o,a,h,l,c){const d=s-t,f=n-e,u=r-s,_=o-n;let y=Vo(f,d),w=Vo(_,u),B=w-y;if(B<0&&(B+=Dt),B===qo||In(d+f)<1e-12||In(u+_)<1e-12){i&&i.push($n,s,n),h&&(Wn(h,t,e),Cs(h,s,n)),c&&Es(c,t,e),l&&Es(l,s,n);return}const g=d*_-u*f<0,R=g?-1:1,v=a/Mi(B/2),A=s+v*Mi(y+B/2+_i*R),L=n+v*ri(y+B/2+_i*R);return y-=_i*R,w-=_i*R,ea(i,A,L,a,a,0,y/z,w/z,g,h,l,c)},arc(i,t,e,s,n,r,o,a,h,l){return ea(i,t,e,s,s,0,n,r,o,a,h,l)},ellipse(i,t,e,s,n,r,o,a,h,l,c,d){const f=r*z,u=ri(f),_=Mi(f);let y=o*z,w=a*z;y>qo&&(y-=Dt),w<0&&(w+=Dt);let B=w-y;B<0?B+=Dt:B>Dt&&(B-=Dt),h&&(B-=Dt);const g=lu(In(B/_i)),R=B/g,v=ri(R/4),A=8/3*v*v/ri(R/2);w=y+R;let L=Mi(y),P=ri(y),U,ht,Q,H,pt,ae,he,le,Se=Q=_*s*L-u*n*P,Ie=H=u*s*L+_*n*P,at=t+Q,Re=e+H;i&&i.push(i.length?$n:Zo,at,Re),l&&Wn(l,at,Re),d&&Es(d,at,Re);for(let ps=0;ps<g;ps++)U=Mi(w),ht=ri(w),Q=_*s*U-u*n*ht,H=u*s*U+_*n*ht,pt=t+Se-A*(_*s*P+u*n*L),ae=e+Ie-A*(u*s*P-_*n*L),he=t+Q+A*(_*s*ht+u*n*U),le=e+H+A*(u*s*ht-_*n*U),i&&i.push(zn,pt,ae,he,le,t+Q,e+H),l&&ta(t+Se,e+Ie,pt,ae,he,le,t+Q,e+H,l,!0),Se=Q,Ie=H,L=U,P=ht,y=w,w+=R;c&&Es(c,t+Q,e+H)},quadraticCurveTo(i,t,e,s,n,r,o){i.push(zn,(t+2*s)/3,(e+2*n)/3,(r+2*s)/3,(o+2*n)/3,r,o)},toTwoPointBoundsByQuadraticCurve(i,t,e,s,n,r,o,a){ta(i,t,(i+2*e)/3,(t+2*s)/3,(n+2*e)/3,(r+2*s)/3,n,r,o,a)},toTwoPointBounds(i,t,e,s,n,r,o,a,h,l){const c=[];let d,f,u,_,y,w,B,g,R=i,v=e,A=n,L=o;for(let P=0;P<2;++P){if(P==1&&(R=t,v=s,A=r,L=a),d=-3*R+9*v-9*A+3*L,f=6*R-12*v+6*A,u=3*v-3*R,Math.abs(d)<1e-12){if(Math.abs(f)<1e-12)continue;_=-u/f,0<_&&_<1&&c.push(_);continue}B=f*f-4*u*d,g=Math.sqrt(B),!(B<0)&&(y=(-f+g)/(2*d),0<y&&y<1&&c.push(y),w=(-f-g)/(2*d),0<w&&w<1&&c.push(w))}l?Cs(h,i,t):Wn(h,i,t),Cs(h,o,a);for(let P=0,U=c.length;P<U;P++)Jo(c[P],i,t,e,s,n,r,o,a,jn),Cs(h,jn.x,jn.y)},getPointAndSet(i,t,e,s,n,r,o,a,h,l){const c=1-i,d=c*c*c,f=3*c*c*i,u=3*c*i*i,_=i*i*i;l.x=d*t+f*s+u*r+_*a,l.y=d*e+f*n+u*o+_*h},getPoint(i,t,e,s,n,r,o,a,h){const l={};return Jo(i,t,e,s,n,r,o,a,h,l),l}},{getPointAndSet:Jo,toTwoPointBounds:ta,ellipse:ea}=Ye,{sin:du,cos:fu,sqrt:ia,atan2:sa}=Math,{ellipse:_u}=Ye,pu={ellipticalArc(i,t,e,s,n,r,o,a,h,l,c){const d=(h-t)/2,f=(l-e)/2,u=r*z,_=du(u),y=fu(u),w=-y*d-_*f,B=-y*f+_*d,g=s*s,R=n*n,v=B*B,A=w*w,L=g*R-g*v-R*A;let P=0;if(L<0){const Se=ia(1-L/(g*R));s*=Se,n*=Se}else P=(o===a?-1:1)*ia(L/(g*v+R*A));const U=P*s*B/n,ht=-P*n*w/s,Q=sa((B-ht)/n,(w-U)/s),H=sa((-B-ht)/n,(-w-U)/s);let pt=H-Q;a===0&&pt>0?pt-=Dt:a===1&&pt<0&&(pt+=Dt);const ae=t+d+y*U-_*ht,he=e+f+_*U+y*ht,le=pt<0?1:0;c||x.ellipseToCurve?_u(i,ae,he,s,n,r,Q/z,H/z,le):s===n&&!r?i.push(Wt.O,ae,he,s,Q/z,H/z,le):i.push(Wt.G,ae,he,s,n,r,Q/z,H/z,le)}},{M:Nn,m:gu,L:Fi,l:yu,H:mu,h:wu,V:xu,v:vu,C:oi,c:bu,S:Hn,s:Bu,Q:ai,q:Cu,T:Gn,t:Eu,A:Su,a:Ru,Z:Un,z:Tu,N:ku,D:Pu,X:Ou,G:Au,F:Lu,O:Du,P:Mu,U:Fu}=Wt,{rect:Iu,roundRect:na,arcTo:Wu,arc:ra,ellipse:oa,quadraticCurveTo:aa}=Ye,{ellipticalArc:$u}=pu,zu=N.get("PathConvert"),de={},Xe={current:{dot:0},stringify(i,t){let e=0,s=i.length,n,r="",o,a;for(;e<s;){o=i[e],n=ll[o],o===a?r+=" ":r+=hl[o];for(let h=1;h<n;h++)r+=ct.float(i[e+h],t),h===n-1||(r+=" ");a=o,e+=n}return r},parse(i,t){let e,s,n,r="";const o=[],a=t?hu:al;for(let h=0,l=i.length;h<l;h++)s=i[h],iu[s]?(s==="."&&(At.dot&&(je(o,r),r=""),At.dot++),r==="0"&&s!=="."&&(je(o,r),r=""),r+=s):Wt[s]?(r&&(je(o,r),r=""),At.name=Wt[s],At.length=ol[s],At.index=0,je(o,At.name),!e&&a[s]&&(e=!0)):s==="-"||s==="+"?n==="e"||n==="E"?r+=s:(r&&je(o,r),r=s):r&&(je(o,r),r=""),n=s;return r&&je(o,r),e?Xe.toCanvasData(o,t):o},toCanvasData(i,t){let e=0,s=0,n=0,r=0,o=0,a=i.length,h,l,c,d,f;const u=[];for(;o<a;){switch(c=i[o],c){case gu:i[o+1]+=e,i[o+2]+=s;case Nn:e=i[o+1],s=i[o+2],u.push(Nn,e,s),o+=3;break;case wu:i[o+1]+=e;case mu:e=i[o+1],u.push(Fi,e,s),o+=2;break;case vu:i[o+1]+=s;case xu:s=i[o+1],u.push(Fi,e,s),o+=2;break;case yu:i[o+1]+=e,i[o+2]+=s;case Fi:e=i[o+1],s=i[o+2],u.push(Fi,e,s),o+=3;break;case Bu:i[o+1]+=e,i[o+2]+=s,i[o+3]+=e,i[o+4]+=s,c=Hn;case Hn:f=d===oi||d===Hn,n=f?e*2-h:i[o+1],r=f?s*2-l:i[o+2],h=i[o+1],l=i[o+2],e=i[o+3],s=i[o+4],u.push(oi,n,r,h,l,e,s),o+=5;break;case bu:i[o+1]+=e,i[o+2]+=s,i[o+3]+=e,i[o+4]+=s,i[o+5]+=e,i[o+6]+=s,c=oi;case oi:h=i[o+3],l=i[o+4],e=i[o+5],s=i[o+6],u.push(oi,i[o+1],i[o+2],h,l,e,s),o+=7;break;case Eu:i[o+1]+=e,i[o+2]+=s,c=Gn;case Gn:f=d===ai||d===Gn,h=f?e*2-h:i[o+1],l=f?s*2-l:i[o+2],t?aa(u,e,s,h,l,i[o+1],i[o+2]):u.push(ai,h,l,i[o+1],i[o+2]),e=i[o+1],s=i[o+2],o+=3;break;case Cu:i[o+1]+=e,i[o+2]+=s,i[o+3]+=e,i[o+4]+=s,c=ai;case ai:h=i[o+1],l=i[o+2],t?aa(u,e,s,h,l,i[o+3],i[o+4]):u.push(ai,h,l,i[o+3],i[o+4]),e=i[o+3],s=i[o+4],o+=5;break;case Ru:i[o+6]+=e,i[o+7]+=s;case Su:$u(u,e,s,i[o+1],i[o+2],i[o+3],i[o+4],i[o+5],i[o+6],i[o+7],t),e=i[o+6],s=i[o+7],o+=8;break;case Tu:case Un:u.push(Un),o++;break;case ku:e=i[o+1],s=i[o+2],t?Iu(u,e,s,i[o+3],i[o+4]):ke(u,i,o,5),o+=5;break;case Pu:e=i[o+1],s=i[o+2],t?na(u,e,s,i[o+3],i[o+4],[i[o+5],i[o+6],i[o+7],i[o+8]]):ke(u,i,o,9),o+=9;break;case Ou:e=i[o+1],s=i[o+2],t?na(u,e,s,i[o+3],i[o+4],i[o+5]):ke(u,i,o,6),o+=6;break;case Au:oa(t?u:ke(u,i,o,9),i[o+1],i[o+2],i[o+3],i[o+4],i[o+5],i[o+6],i[o+7],i[o+8],null,de),e=de.x,s=de.y,o+=9;break;case Lu:t?oa(u,i[o+1],i[o+2],i[o+3],i[o+4],0,0,360,!1):ke(u,i,o,5),e=i[o+1]+i[o+3],s=i[o+2],o+=5;break;case Du:ra(t?u:ke(u,i,o,7),i[o+1],i[o+2],i[o+3],i[o+4],i[o+5],i[o+6],null,de),e=de.x,s=de.y,o+=7;break;case Mu:t?ra(u,i[o+1],i[o+2],i[o+3],0,360,!1):ke(u,i,o,4),e=i[o+1]+i[o+3],s=i[o+2],o+=4;break;case Fu:Wu(t?u:ke(u,i,o,6),e,s,i[o+1],i[o+2],i[o+3],i[o+4],i[o+5],null,de),e=de.x,s=de.y,o+=6;break;default:return zu.error(`command: ${c} [index:${o}]`,i),u}d=c}return u},objectToCanvasData(i){const t=[];return i.forEach(e=>{switch(e.name){case"M":t.push(Nn,e.x,e.y);break;case"L":t.push(Fi,e.x,e.y);break;case"C":t.push(oi,e.x1,e.y1,e.x2,e.y2,e.x,e.y);break;case"Q":t.push(ai,e.x1,e.y1,e.x,e.y);break;case"Z":t.push(Un)}}),t},copyData(i,t,e,s){for(let n=e,r=e+s;n<r;n++)i.push(t[n])},pushData(i,t){At.index===At.length&&(At.index=1,i.push(At.name)),i.push(Number(t)),At.index++,At.dot=0}},{current:At,pushData:je,copyData:ke}=Xe,{M:Yn,L:ju,C:Nu,Q:Hu,Z:Gu,N:ha,D:Uu,X:Yu,G:Xu,F:Vu,O:qu,P:Ku,U:la}=Wt,{getMinDistanceFrom:Zu,getRadianFrom:Qu}=T,{tan:Ju,min:td,abs:ed}=Math,hi={},Ze={beginPath(i){i.length=0},moveTo(i,t,e){i.push(Yn,t,e)},lineTo(i,t,e){i.push(ju,t,e)},bezierCurveTo(i,t,e,s,n,r,o){i.push(Nu,t,e,s,n,r,o)},quadraticCurveTo(i,t,e,s,n){i.push(Hu,t,e,s,n)},closePath(i){i.push(Gu)},rect(i,t,e,s,n){i.push(ha,t,e,s,n)},roundRect(i,t,e,s,n,r){if(typeof r=="number")i.push(Yu,t,e,s,n,r);else{const o=ct.fourNumber(r);o?i.push(Uu,t,e,s,n,...o):i.push(ha,t,e,s,n)}},ellipse(i,t,e,s,n,r,o,a,h){r===void 0?i.push(Vu,t,e,s,n):(o===void 0&&(o=0),a===void 0&&(a=360),i.push(Xu,t,e,s,n,r,o,a,h?1:0))},arc(i,t,e,s,n,r,o){n===void 0?i.push(Ku,t,e,s):(r===void 0&&(r=360),i.push(qu,t,e,s,n,r,o?1:0))},arcTo(i,t,e,s,n,r,o,a){if(o!==void 0){const h=Ju(Qu(o,a,t,e,s,n)/2)*(Zu(o,a,t,e,s,n)/2);i.push(la,t,e,s,n,td(r,ed(h)))}else i.push(la,t,e,s,n,r)},drawEllipse(i,t,e,s,n,r,o,a,h){Ye.ellipse(null,t,e,s,n,r===void 0?0:r,o===void 0?0:o,a===void 0?360:a,h,null,null,hi),i.push(Yn,hi.x,hi.y),id(i,t,e,s,n,r,o,a,h)},drawArc(i,t,e,s,n,r,o){Ye.arc(null,t,e,s,n===void 0?0:n,r===void 0?360:r,o,null,null,hi),i.push(Yn,hi.x,hi.y),sd(i,t,e,s,n,r,o)},drawPoints(i,t,e,s){Ye.points(i,t,e,s)}},{ellipse:id,arc:sd}=Ze,{moveTo:nd,lineTo:rd,quadraticCurveTo:od,bezierCurveTo:ad,closePath:hd,beginPath:ld,rect:cd,roundRect:ud,ellipse:dd,arc:fd,arcTo:_d,drawEllipse:pd,drawArc:gd,drawPoints:yd}=Ze;class to{set path(t){this.__path=t}get path(){return this.__path}constructor(t){this.set(t)}set(t){return t?this.__path=typeof t=="string"?te.parse(t):t:this.__path=[],this}beginPath(){return ld(this.__path),this.paint(),this}moveTo(t,e){return nd(this.__path,t,e),this.paint(),this}lineTo(t,e){return rd(this.__path,t,e),this.paint(),this}bezierCurveTo(t,e,s,n,r,o){return ad(this.__path,t,e,s,n,r,o),this.paint(),this}quadraticCurveTo(t,e,s,n){return od(this.__path,t,e,s,n),this.paint(),this}closePath(){return hd(this.__path),this.paint(),this}rect(t,e,s,n){return cd(this.__path,t,e,s,n),this.paint(),this}roundRect(t,e,s,n,r){return ud(this.__path,t,e,s,n,r),this.paint(),this}ellipse(t,e,s,n,r,o,a,h){return dd(this.__path,t,e,s,n,r,o,a,h),this.paint(),this}arc(t,e,s,n,r,o){return fd(this.__path,t,e,s,n,r,o),this.paint(),this}arcTo(t,e,s,n,r){return _d(this.__path,t,e,s,n,r),this.paint(),this}drawEllipse(t,e,s,n,r,o,a,h){return pd(this.__path,t,e,s,n,r,o,a,h),this.paint(),this}drawArc(t,e,s,n,r,o){return gd(this.__path,t,e,s,n,r,o),this.paint(),this}drawPoints(t,e,s){return yd(this.__path,t,e,s),this.paint(),this}clearPath(){return this.beginPath()}paint(){}}const{M:md,L:wd,C:xd,Q:vd,Z:bd,N:Bd,D:Cd,X:Ed,G:Sd,F:Rd,O:Td,P:kd,U:Pd}=Wt,Od=N.get("PathDrawer"),Ad={drawPathByData(i,t){if(!t)return;let e,s=0,n=t.length;for(;s<n;)switch(e=t[s],e){case md:i.moveTo(t[s+1],t[s+2]),s+=3;break;case wd:i.lineTo(t[s+1],t[s+2]),s+=3;break;case xd:i.bezierCurveTo(t[s+1],t[s+2],t[s+3],t[s+4],t[s+5],t[s+6]),s+=7;break;case vd:i.quadraticCurveTo(t[s+1],t[s+2],t[s+3],t[s+4]),s+=5;break;case bd:i.closePath(),s+=1;break;case Bd:i.rect(t[s+1],t[s+2],t[s+3],t[s+4]),s+=5;break;case Cd:i.roundRect(t[s+1],t[s+2],t[s+3],t[s+4],[t[s+5],t[s+6],t[s+7],t[s+8]]),s+=9;break;case Ed:i.roundRect(t[s+1],t[s+2],t[s+3],t[s+4],t[s+5]),s+=6;break;case Sd:i.ellipse(t[s+1],t[s+2],t[s+3],t[s+4],t[s+5]*z,t[s+6]*z,t[s+7]*z,t[s+8]),s+=9;break;case Rd:i.ellipse(t[s+1],t[s+2],t[s+3],t[s+4],0,0,Dt,!1),s+=5;break;case Td:i.arc(t[s+1],t[s+2],t[s+3],t[s+4]*z,t[s+5]*z,t[s+6]),s+=7;break;case kd:i.arc(t[s+1],t[s+2],t[s+3],0,Dt,!1),s+=4;break;case Pd:i.arcTo(t[s+1],t[s+2],t[s+3],t[s+4],t[s+5]),s+=6;break;default:Od.error(`command: ${e} [index:${s}]`,t);return}}},{M:Ld,L:Dd,C:ca,Q:ua,Z:da,N:Md,D:fa,X:Fd,G:Id,F:Wd,O:$d,P:zd,U:jd}=Wt,{toTwoPointBounds:Nd,toTwoPointBoundsByQuadraticCurve:Hd,arcTo:Gd,arc:Ud,ellipse:Yd}=Ye,{addPointBounds:Ii,copy:Xn,addPoint:Xd,setPoint:Vn,addBounds:Ss,toBounds:Vd}=hs,qd=N.get("PathBounds");let li,Rs,qn;const Rt={},_a={},fe={},eo={toBounds(i,t){eo.toTwoPointBounds(i,_a),Vd(_a,t)},toTwoPointBounds(i,t){if(!i||!i.length)return Vn(t,0,0);let e=0,s=0,n=0,r,o,a,h,l;const c=i.length;for(;e<c;)switch(l=i[e],e===0&&(l===da||l===ca||l===ua?Vn(t,s,n):Vn(t,i[e+1],i[e+2])),l){case Ld:case Dd:s=i[e+1],n=i[e+2],Xd(t,s,n),e+=3;break;case ca:a=i[e+5],h=i[e+6],Nd(s,n,i[e+1],i[e+2],i[e+3],i[e+4],a,h,Rt),Ii(t,Rt),s=a,n=h,e+=7;break;case ua:r=i[e+1],o=i[e+2],a=i[e+3],h=i[e+4],Hd(s,n,r,o,a,h,Rt),Ii(t,Rt),s=a,n=h,e+=5;break;case da:e+=1;break;case Md:s=i[e+1],n=i[e+2],Ss(t,s,n,i[e+3],i[e+4]),e+=5;break;case fa:case Fd:s=i[e+1],n=i[e+2],Ss(t,s,n,i[e+3],i[e+4]),e+=l===fa?9:6;break;case Id:Yd(null,i[e+1],i[e+2],i[e+3],i[e+4],i[e+5],i[e+6],i[e+7],i[e+8],Rt,fe),e===0?Xn(t,Rt):Ii(t,Rt),s=fe.x,n=fe.y,e+=9;break;case Wd:s=i[e+1],n=i[e+2],Rs=i[e+3],qn=i[e+4],Ss(t,s-Rs,n-qn,Rs*2,qn*2),s+=Rs,e+=5;break;case $d:Ud(null,i[e+1],i[e+2],i[e+3],i[e+4],i[e+5],i[e+6],Rt,fe),e===0?Xn(t,Rt):Ii(t,Rt),s=fe.x,n=fe.y,e+=7;break;case zd:s=i[e+1],n=i[e+2],li=i[e+3],Ss(t,s-li,n-li,li*2,li*2),s+=li,e+=4;break;case jd:Gd(null,s,n,i[e+1],i[e+2],i[e+3],i[e+4],i[e+5],Rt,fe),e===0?Xn(t,Rt):Ii(t,Rt),s=fe.x,n=fe.y,e+=6;break;default:qd.error(`command: ${l} [index:${e}]`,i);return}}},{M:Kn,L:Ts,C:pa,Z:ks}=Wt,{getCenterX:Kd,getCenterY:Zd}=T,{arcTo:Zn}=Ze,Qd={smooth(i,t,e){let s,n=0,r=0,o=0,a=0,h=0,l=0,c=0,d=0,f=0;const u=i.length,_=[];for(;n<u;)switch(s=i[n],s){case Kn:a=d=i[n+1],h=f=i[n+2],n+=3,i[n]===Ts?(l=i[n+1],c=i[n+2],_.push(Kn,Kd(a,l),Zd(h,c))):_.push(Kn,a,h);break;case Ts:switch(r=i[n+1],o=i[n+2],n+=3,i[n]){case Ts:Zn(_,r,o,i[n+1],i[n+2],t,d,f);break;case ks:Zn(_,r,o,a,h,t,d,f);break;default:_.push(Ts,r,o)}d=r,f=o;break;case pa:_.push(pa,i[n+1],i[n+2],i[n+3],i[n+4],i[n+5],i[n+6]),n+=7;break;case ks:Zn(_,a,h,l,c,t,d,f),_.push(ks),n+=1;break}return s!==ks&&(_[1]=a,_[2]=h),_}};te.creator=new to;te.parse=Xe.parse;te.convertToCanvasData=Xe.toCanvasData;const Wi=new to,{drawRoundRect:Jd}=cl;function tf(i){i&&!i.roundRect&&(i.roundRect=function(t,e,s,n,r){Jd(this,t,e,s,n,r)})}function ul(i){tf(i)}const me={opacityTypes:["png","webp","svg"],upperCaseTypeMap:{},mineType(i){return!i||i.startsWith("image")?i:(i==="jpg"&&(i="jpeg"),"image/"+i)},fileType(i){const t=i.split(".");return t[t.length-1]},isOpaqueImage(i){const t=Ir.fileType(i);return["jpg","jpeg"].some(e=>e===t)},getExportOptions(i){switch(typeof i){case"object":return i;case"number":return{quality:i};case"boolean":return{blob:i};default:return{}}}},Ir=me;Ir.opacityTypes.forEach(i=>Ir.upperCaseTypeMap[i]=i.toUpperCase());const ef=N.get("TaskProcessor");class sf{constructor(t){this.parallel=!0,this.time=1,this.id=we.create(we.TASK),this.task=t}run(){return sl(this,void 0,void 0,function*(){try{this.task&&!this.isComplete&&this.parent.running&&(yield this.task())}catch(t){ef.error(t)}})}complete(){this.isComplete=!0,this.parent=null,this.task=null}cancel(){this.isCancel=!0,this.complete()}}class Wr{get total(){return this.list.length+this.delayNumber}get finishedIndex(){return this.isComplete?0:this.index+this.parallelSuccessNumber}get remain(){return this.isComplete?this.total:this.total-this.finishedIndex}get percent(){const{total:t}=this;let e=0,s=0;for(let n=0;n<t;n++)n<=this.finishedIndex?(s+=this.list[n].time,n===this.finishedIndex&&(e=s)):e+=this.list[n].time;return this.isComplete?1:s/e}constructor(t){this.config={parallel:6},this.list=[],this.running=!1,this.isComplete=!0,this.index=0,this.delayNumber=0,t&&lt.assign(this.config,t),this.empty()}add(t,e){let s,n,r,o;const a=new sf(t);return a.parent=this,typeof e=="number"?o=e:e&&(n=e.parallel,s=e.start,r=e.time,o=e.delay),r&&(a.time=r),n===!1&&(a.parallel=!1),o===void 0?this.push(a,s):(this.delayNumber++,setTimeout(()=>{this.delayNumber&&(this.delayNumber--,this.push(a,s))},o)),this.isComplete=!1,a}push(t,e){this.list.push(t),e!==!1&&!this.timer&&(this.timer=setTimeout(()=>this.start()))}empty(){this.index=0,this.parallelSuccessNumber=0,this.list=[],this.parallelList=[],this.delayNumber=0}start(){this.running||(this.running=!0,this.isComplete=!1,this.run())}pause(){clearTimeout(this.timer),this.timer=null,this.running=!1}resume(){this.start()}skip(){this.index++,this.resume()}stop(){this.isComplete=!0,this.list.forEach(t=>{t.isComplete||t.cancel()}),this.pause(),this.empty()}run(){this.running&&(this.setParallelList(),this.parallelList.length>1?this.runParallelTasks():this.remain?this.runTask():this.onComplete())}runTask(){const t=this.list[this.index];if(!t){this.nextTask();return}t.run().then(()=>{this.onTask(t),this.index++,this.nextTask()}).catch(e=>{this.onError(e)})}runParallelTasks(){this.parallelList.forEach(t=>this.runParallelTask(t))}runParallelTask(t){t.run().then(()=>{this.onTask(t),this.fillParallelTask()}).catch(e=>{this.onParallelError(e)})}nextTask(){this.total===this.finishedIndex?this.onComplete():this.timer=setTimeout(()=>this.run())}setParallelList(){let t;this.parallelList=[],this.parallelSuccessNumber=0;let e=this.index+this.config.parallel;e>this.list.length&&(e=this.list.length);for(let s=this.index;s<e&&(t=this.list[s],t.parallel);s++)this.parallelList.push(t)}fillParallelTask(){let t;const e=this.parallelList;this.parallelSuccessNumber++,e.pop();const s=e.length,n=this.finishedIndex+s;if(e.length){if(!this.running)return;n<this.total&&(t=this.list[n],t&&t.parallel&&(e.push(t),this.runParallelTask(t)))}else this.index+=this.parallelSuccessNumber,this.parallelSuccessNumber=0,this.nextTask()}onComplete(){this.stop(),this.config.onComplete&&this.config.onComplete()}onTask(t){t.complete(),this.config.onTask&&this.config.onTask()}onParallelError(t){this.parallelList.forEach(e=>{e.parallel=!1}),this.parallelList.length=0,this.parallelSuccessNumber=0,this.onError(t)}onError(t){this.pause(),this.config.onError&&this.config.onError(t)}destroy(){this.stop()}}const St={map:{},recycledList:[],tasker:new Wr,patternTasker:new Wr,get isComplete(){return _e.tasker.isComplete},get(i){let t=_e.map[i.url];return t||(t=rt.image(i),_e.map[i.url]=t),t.use++,t},recycle(i){i.use--,setTimeout(()=>{i.use||_e.recycledList.push(i)})},clearRecycled(){const i=_e.recycledList;i.length>100&&(i.forEach(t=>{!t.use&&t.url&&(delete _e.map[t.url],t.destroy())}),i.length=0)},hasOpacityPixel(i){return me.opacityTypes.some(t=>_e.isFormat(t,i))},isFormat(i,t){if(t.format===i)return!0;const{url:e}=t;if(e.startsWith("data:")){if(e.startsWith("data:"+me.mineType(i)))return!0}else{if(e.includes("."+i)||e.includes("."+me.upperCaseTypeMap[i]))return!0;if(i==="png"&&!e.includes("."))return!0}return!1},destroy(){_e.map={},_e.recycledList=[]}},_e=St,{IMAGE:nf,create:rf}=we;class dl{get url(){return this.config.url}get completed(){return this.ready||!!this.error}constructor(t){this.use=0,this.waitComplete=[],this.innerId=rf(nf),this.config=t||{url:""},this.isSVG=St.isFormat("svg",t),this.hasOpacityPixel=St.hasOpacityPixel(t)}load(t,e){return this.loading||(this.loading=!0,St.tasker.add(()=>sl(this,void 0,void 0,function*(){return yield x.origin.loadImage(this.url).then(s=>{this.ready=!0,this.width=s.naturalWidth||s.width,this.height=s.naturalHeight||s.height,this.view=s,this.onComplete(!0)}).catch(s=>{this.error=s,this.onComplete(!1)})}))),this.waitComplete.push(t,e),this.waitComplete.length-2}unload(t,e){const s=this.waitComplete;if(e){const n=s[t+1];n&&n({type:"stop"})}s[t]=s[t+1]=void 0}onComplete(t){let e;this.waitComplete.forEach((s,n)=>{e=n%2,s&&(t?e||s(this):e&&s(this.error))}),this.waitComplete.length=0,this.loading=!1}getCanvas(t,e,s,n){if(t||(t=this.width),e||(e=this.height),this.cache){let{params:a,data:h}=this.cache;for(let l in a)if(a[l]!==arguments[l]){h=null;break}if(h)return h}const r=x.origin.createCanvas(t,e),o=r.getContext("2d");return s&&(o.globalAlpha=s),o.drawImage(this.view,0,0,t,e),this.cache=this.use>1?{data:r,params:arguments}:null,r}getPattern(t,e,s,n){const r=x.canvas.createPattern(t,e);try{s&&r.setTransform&&(r.setTransform(s),s=null)}catch{}return n&&(n.transform=s),r}destroy(){this.config={url:""},this.cache=null,this.waitComplete.length=0}}function Pi(i,t,e,s){e.configurable=e.enumerable=!0,Object.defineProperty(i,t,e)}function fl(i,t){return Object.getOwnPropertyDescriptor(i,t)}function of(i){return Object.getOwnPropertyNames(i)}function Z(i,t){return(e,s)=>af(e,s,i,t&&t(s))}function af(i,t,e,s){Pi(i,t,Object.assign({get(){return this.__getAttr(t)},set(r){this.__setAttr(t,r)}},s||{})),gl(i,t,e)}function vt(i){return Z(i)}function Oi(i,t){return Z(i,e=>({set(s){this.__setAttr(e,s,t)&&(this.__layout.matrixChanged||this.__layout.matrixChange())}}))}function _n(i){return Z(i,t=>({set(e){this.__setAttr(t,e)&&(this.__layout.matrixChanged||this.__layout.matrixChange(),this.__hasAutoLayout=!!(this.origin||this.around||this.flow),this.__local||this.__layout.createLocal())}}))}function _l(i,t){return Z(i,e=>({set(s){this.__setAttr(e,s,t)&&(this.__layout.scaleChanged||this.__layout.scaleChange())}}))}function io(i,t){return Z(i,e=>({set(s){this.__setAttr(e,s,t)&&(this.__layout.rotationChanged||this.__layout.rotationChange())}}))}function D(i,t){return Z(i,e=>({set(s){this.__setAttr(e,s,t)&&Ai(this)}}))}function hf(i){return Z(i,t=>({set(e){this.__setAttr(t,e)&&(Ai(this),this.__.__removeNaturalSize())}}))}function Ai(i){i.__layout.boxChanged||i.__layout.boxChange(),i.__hasAutoLayout&&(i.__layout.matrixChanged||i.__layout.matrixChange())}function lf(i){return Z(i,t=>({set(e){const s=this.__;s.__pathInputed!==2&&(s.__pathInputed=e?1:0),e||(s.__pathForRender=void 0),this.__setAttr(t,e),Ai(this)}}))}const bt=D;function pn(i){return Z(i,t=>({set(e){this.__setAttr(t,e)&&cf(this)}}))}function cf(i){i.__layout.strokeChanged||i.__layout.strokeChange(),i.__.__useArrow&&Ai(i)}const re=pn;function pl(i){return Z(i,t=>({set(e){this.__setAttr(t,e),this.__layout.renderChanged||this.__layout.renderChange()}}))}function ls(i){return Z(i,t=>({set(e){this.__setAttr(t,e)&&(this.__layout.surfaceChanged||this.__layout.surfaceChange())}}))}function uf(i){return Z(i,t=>({set(e){this.__setAttr(t,e)&&(this.__layout.opacityChanged||this.__layout.opacityChange())}}))}function df(i){return Z(i,t=>({set(e){const s=this.visible;if(s===!0&&e===0){if(this.animationOut)return this.__runAnimation("out",()=>ga(this,t,e,s))}else s===0&&e===!0&&this.animation&&this.__runAnimation("in");ga(this,t,e,s)}}))}function ga(i,t,e,s){i.__setAttr(t,e)&&(i.__layout.opacityChanged||i.__layout.opacityChange(),(s===0||e===0)&&Ai(i))}function ff(i){return Z(i,t=>({set(e){this.__setAttr(t,e)&&(this.__layout.surfaceChanged||this.__layout.surfaceChange(),this.waitParent(()=>{this.parent.__layout.childrenSortChange()}))}}))}function _f(i){return Z(i,t=>({set(e){this.__setAttr(t,e)&&(this.__layout.boxChanged||this.__layout.boxChange(),this.waitParent(()=>{this.parent.__updateMask(e)}))}}))}function pf(i){return Z(i,t=>({set(e){this.__setAttr(t,e)&&this.waitParent(()=>{this.parent.__updateEraser(e)})}}))}function Qe(i){return Z(i,t=>({set(e){this.__setAttr(t,e)&&(this.__layout.hitCanvasChanged=!0,N.showHitView&&(this.__layout.surfaceChanged||this.__layout.surfaceChange()),this.leafer&&this.leafer.updateCursor())}}))}function gf(i){return Z(i,t=>({set(e){this.__setAttr(t,e),this.leafer&&this.leafer.updateCursor()}}))}function dt(i){return(t,e)=>{Pi(t,"__DataProcessor",{get(){return i}})}}function yf(i){return"set"+i.charAt(0).toUpperCase()+i.slice(1)}function gl(i,t,e){const s=i.__DataProcessor.prototype,n="_"+t,r=yf(t),o={get(){const l=this[n];return l===void 0?e:l},set(l){this[n]=l}};if(e===void 0)o.get=function(){return this[n]};else if(typeof e=="object"){const{clone:l}=lt;o.get=function(){let c=this[n];return c===void 0&&(this[n]=c=l(e)),c}}t==="width"?o.get=function(){const l=this[n];if(l===void 0){const c=this;return c._height&&c.__naturalWidth&&c.__useNaturalRatio?c._height*c.__naturalWidth/c.__naturalHeight:c.__naturalWidth||e}else return l}:t==="height"&&(o.get=function(){const l=this[n];if(l===void 0){const c=this;return c._width&&c.__naturalHeight&&c.__useNaturalRatio?c._width*c.__naturalHeight/c.__naturalWidth:c.__naturalHeight||e}else return l});let a,h=s;for(;!a&&h;)a=fl(h,t),h=h.__proto__;a&&a.set&&(o.set=a.set),s[r]&&(o.set=s[r],delete s[r]),Pi(s,t,o)}const mf=new N("rewrite"),Us=[],wf=["destroy","constructor"];function Kt(i){return(t,e)=>{Us.push({name:t.constructor.name+"."+e,run:()=>{t[e]=i}})}}function gn(){return i=>{yl()}}function yl(i){Us.length&&(Us.forEach(t=>{i&&mf.error(t.name,"需在Class上装饰@rewriteAble()"),t.run()}),Us.length=0)}setTimeout(()=>yl(!0));function Ft(i,t){return e=>{(i.prototype?of(i.prototype):Object.keys(i)).forEach(n=>{!wf.includes(n)&&(!t||!t.includes(n))&&(i.prototype?fl(i.prototype,n).writable&&(e.prototype[n]=i.prototype[n]):e.prototype[n]=i[n])})}}function ft(){return i=>{fn.register(i)}}function Fe(){return i=>{Bi.register(i)}}const{copy:ci,toInnerPoint:xf,toOuterPoint:vf,scaleOfOuter:ya,rotateOfOuter:bf,skewOfOuter:Bf,multiplyParent:ma,divideParent:wa,getLayout:Cf}=k,tt={},oe={updateAllMatrix(i,t,e){if(t&&i.__hasAutoLayout&&i.__layout.matrixChanged&&(e=!0),Sf(i,t,e),i.isBranch){const{children:s}=i;for(let n=0,r=s.length;n<r;n++)Ef(s[n],t,e)}},updateMatrix(i,t,e){const s=i.__layout;t?e&&(s.waitAutoLayout=!0,i.__hasAutoLayout&&(s.matrixChanged=!1)):s.waitAutoLayout&&(s.waitAutoLayout=!1),s.matrixChanged&&i.__updateLocalMatrix(),s.waitAutoLayout||i.__updateWorldMatrix()},updateBounds(i){const t=i.__layout;t.boundsChanged&&i.__updateLocalBounds(),t.waitAutoLayout||i.__updateWorldBounds()},updateAllWorldOpacity(i){if(i.__updateWorldOpacity(),i.isBranch){const{children:t}=i;for(let e=0,s=t.length;e<s;e++)xa(t[e])}},updateAllChange(i){if(xa(i),i.__updateChange(),i.isBranch){const{children:t}=i;for(let e=0,s=t.length;e<s;e++)Rf(t[e])}},worldHittable(i){for(;i;){if(!i.__.hittable)return!1;i=i.parent}return!0},moveWorld(i,t,e=0,s,n){const r=typeof t=="object"?Object.assign({},t):{x:t,y:e};s?vf(i.localTransform,r,r,!0):i.parent&&xf(i.parent.worldTransform,r,r,!0),gt.moveLocal(i,r.x,r.y,n)},moveLocal(i,t,e=0,s){typeof t=="object"&&(e=t.y,t=t.x),t+=i.x,e+=i.y,s?i.animate({x:t,y:e},s):(i.x=t,i.y=e)},zoomOfWorld(i,t,e,s,n){gt.zoomOfLocal(i,Qn(i,t),e,s,n)},zoomOfLocal(i,t,e,s=e,n){ci(tt,i.__localMatrix),ya(tt,t,e,s),i.origin||i.around?gt.setTransform(i,tt,n):(va(i,tt),i.scaleResize(e,s,n!==!0))},rotateOfWorld(i,t,e){gt.rotateOfLocal(i,Qn(i,t),e)},rotateOfLocal(i,t,e){ci(tt,i.__localMatrix),bf(tt,t,e),i.origin||i.around?gt.setTransform(i,tt):(va(i,tt),i.rotation=ct.formatRotation(i.rotation+e))},skewOfWorld(i,t,e,s,n){gt.skewOfLocal(i,Qn(i,t),e,s,n)},skewOfLocal(i,t,e,s=0,n){ci(tt,i.__localMatrix),Bf(tt,t,e,s),gt.setTransform(i,tt,n)},transformWorld(i,t,e){ci(tt,i.worldTransform),ma(tt,t),i.parent&&wa(tt,i.parent.worldTransform),gt.setTransform(i,tt,e)},transform(i,t,e){ci(tt,i.localTransform),ma(tt,t),gt.setTransform(i,tt,e)},setTransform(i,t,e){const s=Cf(t,i.origin&&gt.getInnerOrigin(i,i.origin),i.around&&gt.getInnerOrigin(i,i.around));if(e){const n=s.scaleX/i.scaleX,r=s.scaleY/i.scaleY;delete s.scaleX,delete s.scaleY,i.set(s),i.scaleResize(n,r,e!==!0)}else i.set(s)},getFlipTransform(i,t){const e=Js(),s=t==="x"?1:-1;return ya(e,gt.getLocalOrigin(i,"center"),-1*s,1*s),e},getLocalOrigin(i,t){return T.tempToOuterOf(gt.getInnerOrigin(i,t),i.localTransform)},getInnerOrigin(i,t){const e={};return ki.toPoint(t,i.boxBounds,e),e},getRelativeWorld(i,t,e){return ci(tt,i.worldTransform),wa(tt,t.worldTransform),e?tt:Object.assign({},tt)},drop(i,t,e,s){i.setTransform(gt.getRelativeWorld(i,t,!0),s),t.add(i,e)},hasParent(i,t){if(!t)return!1;for(;i;){if(t===i)return!0;i=i.parent}}},gt=oe,{updateAllMatrix:Ef,updateMatrix:Sf,updateAllWorldOpacity:xa,updateAllChange:Rf}=gt;function va(i,t){const{e,f:s}=i.__localMatrix;i.x+=t.e-e,i.y+=t.f-s}function Qn(i,t){return i.__layout.update(),i.parent?T.tempToInnerOf(t,i.parent.__world):t}const yn={worldBounds(i){return i.__world},localBoxBounds(i){return i.__.eraser||i.__.visible===0?null:i.__local||i.__layout},localStrokeBounds(i){return i.__.eraser||i.__.visible===0?null:i.__layout.localStrokeBounds},localRenderBounds(i){return i.__.eraser||i.__.visible===0?null:i.__layout.localRenderBounds},maskLocalBoxBounds(i){return i.__.mask?i.__localBoxBounds:null},maskLocalStrokeBounds(i){return i.__.mask?i.__layout.localStrokeBounds:null},maskLocalRenderBounds(i){return i.__.mask?i.__layout.localRenderBounds:null},excludeRenderBounds(i,t){return!!(t.bounds&&!t.bounds.hit(i.__world,t.matrix)||t.hideBounds&&t.hideBounds.includes(i.__world,t.matrix))}},{updateBounds:ba}=oe,cs={sort(i,t){return i.__.zIndex===t.__.zIndex?i.__tempNumber-t.__tempNumber:i.__.zIndex-t.__.zIndex},pushAllChildBranch(i,t){if(i.__tempNumber=1,i.__.__childBranchNumber){const{children:e}=i;for(let s=0,n=e.length;s<n;s++)i=e[s],i.isBranch&&(i.__tempNumber=1,t.add(i),Tf(i,t))}},pushAllParent(i,t){const{keys:e}=t;if(e)for(;i.parent&&e[i.parent.innerId]===void 0;)t.add(i.parent),i=i.parent;else for(;i.parent;)t.add(i.parent),i=i.parent},pushAllBranchStack(i,t){let e=t.length;const{children:s}=i;for(let n=0,r=s.length;n<r;n++)s[n].isBranch&&t.push(s[n]);for(let n=e,r=t.length;n<r;n++)Ba(t[n],t)},updateBounds(i,t){const e=[i];Ba(i,e),kf(e,t)},updateBoundsByBranchStack(i,t){let e,s;for(let n=i.length-1;n>-1;n--){e=i[n],s=e.children;for(let r=0,o=s.length;r<o;r++)ba(s[r]);t&&t===e||ba(e)}}},{pushAllChildBranch:Tf,pushAllBranchStack:Ba,updateBoundsByBranchStack:kf}=cs,$i={run(i){if(i&&i.length){const t=i.length;for(let e=0;e<t;e++)i[e]();i.length===t?i.length=0:i.splice(0,t)}}},{getRelativeWorld:Ca}=oe,{toOuterOf:Ps,getPoints:Pf,copy:Of}=S,Jn="_localContentBounds",tr="_worldContentBounds",er="_worldBoxBounds",ir="_worldStrokeBounds";class Af{get contentBounds(){return this._contentBounds||this.boxBounds}set contentBounds(t){this._contentBounds=t}get strokeBounds(){return this._strokeBounds||this.boxBounds}get renderBounds(){return this._renderBounds||this.boxBounds}get localContentBounds(){return Ps(this.contentBounds,this.leaf.__localMatrix,this[Jn]||(this[Jn]={})),this[Jn]}get localStrokeBounds(){return this._localStrokeBounds||this}get localRenderBounds(){return this._localRenderBounds||this}get worldContentBounds(){return Ps(this.contentBounds,this.leaf.__world,this[tr]||(this[tr]={})),this[tr]}get worldBoxBounds(){return Ps(this.boxBounds,this.leaf.__world,this[er]||(this[er]={})),this[er]}get worldStrokeBounds(){return Ps(this.strokeBounds,this.leaf.__world,this[ir]||(this[ir]={})),this[ir]}get a(){return 1}get b(){return 0}get c(){return 0}get d(){return 1}get e(){return this.leaf.__.x}get f(){return this.leaf.__.y}get x(){return this.e+this.boxBounds.x}get y(){return this.f+this.boxBounds.y}get width(){return this.boxBounds.width}get height(){return this.boxBounds.height}constructor(t){this.leaf=t,this.boxBounds={x:0,y:0,width:0,height:0},this.leaf.__local&&(this._localRenderBounds=this._localStrokeBounds=this.leaf.__local),this.boxChange(),this.matrixChange()}createLocal(){const t=this.leaf.__local={a:1,b:0,c:0,d:1,e:0,f:0,x:0,y:0,width:0,height:0};this._localStrokeBounds||(this._localStrokeBounds=t),this._localRenderBounds||(this._localRenderBounds=t)}update(){const{leafer:t}=this.leaf;if(t)t.ready?t.watcher.changed&&t.layouter.layout():t.start();else{let e=this.leaf;for(;e.parent&&!e.parent.leafer;)e=e.parent;x.layout(e)}}getTransform(t="world"){this.update();const{leaf:e}=this;switch(t){case"world":return e.__world;case"local":return e.__localMatrix;case"inner":return k.defaultMatrix;case"page":t=e.zoomLayer;default:return Ca(e,t)}}getBounds(t,e="world"){switch(this.update(),e){case"world":return this.getWorldBounds(t);case"local":return this.getLocalBounds(t);case"inner":return this.getInnerBounds(t);case"page":e=this.leaf.zoomLayer;default:return new J(this.getInnerBounds(t)).toOuterOf(this.getTransform(e))}}getInnerBounds(t="box"){switch(t){case"render":return this.renderBounds;case"content":if(this.contentBounds)return this.contentBounds;case"box":return this.boxBounds;case"stroke":return this.strokeBounds}}getLocalBounds(t="box"){switch(t){case"render":return this.localRenderBounds;case"stroke":return this.localStrokeBounds;case"content":if(this.contentBounds)return this.localContentBounds;case"box":return this.leaf.__localBoxBounds}}getWorldBounds(t="box"){switch(t){case"render":return this.leaf.__world;case"stroke":return this.worldStrokeBounds;case"content":if(this.contentBounds)return this.worldContentBounds;case"box":return this.worldBoxBounds}}getLayoutBounds(t,e="world",s){const{leaf:n}=this;let r,o,a,h=this.getInnerBounds(t);switch(e){case"world":r=n.getWorldPoint(h),o=n.__world;break;case"local":const{scaleX:l,scaleY:c,rotation:d,skewX:f,skewY:u}=n.__;a={scaleX:l,scaleY:c,rotation:d,skewX:f,skewY:u},r=n.getLocalPointByInner(h);break;case"inner":r=h,o=k.defaultMatrix;break;case"page":e=n.zoomLayer;default:r=n.getWorldPoint(h,e),o=Ca(n,e,!0)}if(a||(a=k.getLayout(o)),Of(a,h),T.copy(a,r),s){const{scaleX:l,scaleY:c}=a,d=Math.abs(l),f=Math.abs(c);(d!==1||f!==1)&&(a.scaleX/=d,a.scaleY/=f,a.width*=d,a.height*=f)}return a}getLayoutPoints(t,e="world"){const{leaf:s}=this,n=Pf(this.getInnerBounds(t));let r;switch(e){case"world":r=null;break;case"local":r=s.parent;break;case"inner":break;case"page":e=s.zoomLayer;default:r=e}return r!==void 0&&n.forEach(o=>s.innerToWorld(o,null,!1,r)),n}shrinkContent(){const{x:t,y:e,width:s,height:n}=this.boxBounds;this._contentBounds={x:t,y:e,width:s,height:n}}spreadStroke(){const{x:t,y:e,width:s,height:n}=this.strokeBounds;this._strokeBounds={x:t,y:e,width:s,height:n},this._localStrokeBounds={x:t,y:e,width:s,height:n},this.renderSpread||this.spreadRenderCancel()}spreadRender(){const{x:t,y:e,width:s,height:n}=this.renderBounds;this._renderBounds={x:t,y:e,width:s,height:n},this._localRenderBounds={x:t,y:e,width:s,height:n}}shrinkContentCancel(){this._contentBounds=void 0}spreadStrokeCancel(){const t=this.renderBounds===this.strokeBounds;this._strokeBounds=this.boxBounds,this._localStrokeBounds=this.leaf.__localBoxBounds,t&&this.spreadRenderCancel()}spreadRenderCancel(){this._renderBounds=this._strokeBounds,this._localRenderBounds=this._localStrokeBounds}boxChange(){this.boxChanged=!0,this.localBoxChanged||this.localBoxChange(),this.hitCanvasChanged=!0}localBoxChange(){this.localBoxChanged=!0,this.boundsChanged=!0}strokeChange(){this.strokeChanged=!0,this.strokeSpread||(this.strokeSpread=1),this.boundsChanged=!0,this.hitCanvasChanged=!0}renderChange(){this.renderChanged=!0,this.renderSpread||(this.renderSpread=1),this.boundsChanged=!0}scaleChange(){this.scaleChanged=!0,this._scaleOrRotationChange()}rotationChange(){this.rotationChanged=!0,this.affectRotation=!0,this._scaleOrRotationChange()}_scaleOrRotationChange(){this.affectScaleOrRotation=!0,this.matrixChange(),this.leaf.__local||this.createLocal()}matrixChange(){this.matrixChanged=!0,this.localBoxChanged||this.localBoxChange()}surfaceChange(){this.surfaceChanged=!0}opacityChange(){this.opacityChanged=!0,this.surfaceChanged||this.surfaceChange()}childrenSortChange(){this.childrenSortChanged||(this.childrenSortChanged=!0,this.leaf.forceUpdate("surface"))}destroy(){}}class be{constructor(t,e){this.bubbles=!1,this.type=t,e&&(this.target=e)}stopDefault(){this.isStopDefault=!0,this.origin&&x.event.stopDefault(this.origin)}stopNow(){this.isStopNow=!0,this.isStop=!0,this.origin&&x.event.stopNow(this.origin)}stop(){this.isStop=!0,this.origin&&x.event.stop(this.origin)}}class st extends be{constructor(t,e,s){super(t,e),this.parent=s,this.child=e}}st.ADD="child.add";st.REMOVE="child.remove";st.CREATED="created";st.MOUNTED="mounted";st.UNMOUNTED="unmounted";st.DESTROY="destroy";class ye extends be{constructor(t,e,s,n,r){super(t,e),this.attrName=s,this.oldValue=n,this.newValue=r}}ye.CHANGE="property.change";ye.LEAFER_CHANGE="property.leafer_change";class ie extends be{constructor(t,e){super(t),Object.assign(this,e)}}ie.LOAD="image.load";ie.LOADED="image.loaded";ie.ERROR="image.error";class Je extends be{get bigger(){if(!this.old)return!0;const{width:t,height:e}=this.old;return this.width>=t&&this.height>=e}get smaller(){return!this.bigger}get samePixelRatio(){return this.old?this.pixelRatio===this.old.pixelRatio:!0}constructor(t,e){typeof t=="object"?(super(Je.RESIZE),Object.assign(this,t)):super(t),this.old=e}}Je.RESIZE="resize";class Ae extends be{constructor(t,e){super(t),this.data=e}}Ae.REQUEST="watch.request";Ae.DATA="watch.data";class G extends be{constructor(t,e,s){super(t),e&&(this.data=e,this.times=s)}}G.CHECK_UPDATE="layout.check_update";G.REQUEST="layout.request";G.START="layout.start";G.BEFORE="layout.before";G.LAYOUT="layout";G.AFTER="layout.after";G.AGAIN="layout.again";G.END="layout.end";class Y extends be{constructor(t,e,s,n){super(t),e&&(this.times=e),s&&(this.renderBounds=s,this.renderOptions=n)}}Y.REQUEST="render.request";Y.CHILD_START="render.child_start";Y.START="render.start";Y.BEFORE="render.before";Y.RENDER="render";Y.AFTER="render.after";Y.AGAIN="render.again";Y.END="render.end";Y.NEXT="render.next";class it extends be{}it.START="leafer.start";it.BEFORE_READY="leafer.before_ready";it.READY="leafer.ready";it.AFTER_READY="leafer.after_ready";it.VIEW_READY="leafer.view_ready";it.VIEW_COMPLETED="leafer.view_completed";it.STOP="leafer.stop";it.RESTART="leafer.restart";it.END="leafer.end";const Ea={};class ml{set event(t){this.on(t)}on(t,e,s){if(!e){let c,d=t;for(let f in d)c=d[f],c instanceof Array?this.on(f,c[0],c[1]):this.on(f,c);return}let n,r;s&&(s==="once"?r=!0:typeof s=="boolean"?n=s:(n=s.capture,r=s.once));let o;const a=sr(this,n,!0),h=typeof t=="string"?t.split(" "):t,l=r?{listener:e,once:r}:{listener:e};h.forEach(c=>{c&&(o=a[c],o?o.findIndex(d=>d.listener===e)===-1&&o.push(l):a[c]=[l])})}off(t,e,s){if(t){const n=typeof t=="string"?t.split(" "):t;if(e){let r;s&&(r=typeof s=="boolean"?s:s==="once"?!1:s.capture);let o,a;const h=sr(this,r);n.forEach(l=>{l&&(o=h[l],o&&(a=o.findIndex(c=>c.listener===e),a>-1&&o.splice(a,1),o.length||delete h[l]))})}else{const{__bubbleMap:r,__captureMap:o}=this;n.forEach(a=>{r&&delete r[a],o&&delete o[a]})}}else this.__bubbleMap=this.__captureMap=void 0}on_(t,e,s,n){return s&&(e=e.bind(s)),this.on(t,e,n),{type:t,current:this,listener:e,options:n}}off_(t){if(!t)return;const e=t instanceof Array?t:[t];e.forEach(s=>s.current.off(s.type,s.listener,s.options)),e.length=0}once(t,e,s){this.on(t,e,{once:!0,capture:s})}emit(t,e,s){!e&&Bi.has(t)&&(e=Bi.get(t,{type:t,target:this,current:this}));const r=sr(this,s)[t];if(r){let o;for(let a=0,h=r.length;a<h&&(o=r[a],o.listener(e),o.once&&(this.off(t,o.listener,s),a--,h--),!(e&&e.isStopNow));a++);}this.syncEventer&&this.syncEventer.emitEvent(e,s)}emitEvent(t,e){t.current=this,this.emit(t.type,t,e)}hasEvent(t,e){if(this.syncEventer&&this.syncEventer.hasEvent(t,e))return!0;const{__bubbleMap:s,__captureMap:n}=this,r=s&&s[t],o=n&&n[t];return!!(e===void 0?r||o:e?o:r)}destroy(){this.__captureMap=this.__bubbleMap=this.syncEventer=null}}function sr(i,t,e){if(t){const{__captureMap:s}=i;return s||(e?i.__captureMap={}:Ea)}else{const{__bubbleMap:s}=i;return s||(e?i.__bubbleMap={}:Ea)}}const{on:Lf,on_:Df,off:Mf,off_:Ff,once:If,emit:Wf,emitEvent:$f,hasEvent:zf,destroy:jf}=ml.prototype,wl={on:Lf,on_:Df,off:Mf,off_:Ff,once:If,emit:Wf,emitEvent:$f,hasEvent:zf,destroyEventer:jf},{isFinite:Nf}=Number,Hf=N.get("setAttr"),Gf={__setAttr(i,t,e){if(this.leaferIsCreated){const s=this.__.__getInput(i);if(e&&!Nf(t)&&t!==void 0&&(Hf.warn(this.innerName,i,t),t=void 0),typeof t=="object"||s!==t){this.__realSetAttr(i,t);const{CHANGE:n}=ye,r=new ye(n,this,i,s,t);return this.isLeafer?this.emitEvent(new ye(ye.LEAFER_CHANGE,this,i,s,t)):this.hasEvent(n)&&this.emitEvent(r),this.leafer.emitEvent(r),!0}else return!1}else return this.__realSetAttr(i,t),!0},__realSetAttr(i,t){const e=this.__;e[i]=t,this.__proxyData&&this.setProxyAttr(i,t),e.normalStyle&&(this.lockNormalStyle||e.normalStyle[i]===void 0||(e.normalStyle[i]=t))},__getAttr(i){return this.__proxyData?this.getProxyAttr(i):this.__.__get(i)}},{setLayout:Uf,multiplyParent:Yf,translateInner:Xf,defaultWorld:Vf}=k,{toPoint:qf,tempPoint:nr}=ki,Kf={__updateWorldMatrix(){Yf(this.__local||this.__layout,this.parent?this.parent.__world:Vf,this.__world,!!this.__layout.affectScaleOrRotation,this.__,this.parent&&this.parent.__)},__updateLocalMatrix(){if(this.__local){const i=this.__layout,t=this.__local,e=this.__;i.affectScaleOrRotation&&(i.scaleChanged||i.rotationChanged)&&(Uf(t,e,null,null,i.affectRotation),i.scaleChanged=i.rotationChanged=!1),t.e=e.x+e.offsetX,t.f=e.y+e.offsetY,(e.around||e.origin)&&(qf(e.around||e.origin,i.boxBounds,nr),Xf(t,-nr.x,-nr.y,!e.around))}this.__layout.matrixChanged=!1}},{updateMatrix:Zf,updateAllMatrix:Sa}=oe,{updateBounds:Ra}=cs,{toOuterOf:Os,copyAndSpread:Ta,copy:Qf}=S,{toBounds:Jf}=eo,t_={__updateWorldBounds(){Os(this.__layout.renderBounds,this.__world,this.__world),this.__layout.resized&&(this.__onUpdateSize(),this.__layout.resized=!1)},__updateLocalBounds(){const i=this.__layout;i.boxChanged&&(this.__.__pathInputed||this.__updatePath(),this.__updateRenderPath(),this.__updateBoxBounds(),i.resized=!0),i.localBoxChanged&&(this.__local&&this.__updateLocalBoxBounds(),i.localBoxChanged=!1,i.strokeSpread&&(i.strokeChanged=!0),i.renderSpread&&(i.renderChanged=!0),this.parent&&this.parent.__layout.boxChange()),i.boxChanged=!1,i.strokeChanged&&(i.strokeSpread=this.__updateStrokeSpread(),i.strokeSpread?(i.strokeBounds===i.boxBounds&&i.spreadStroke(),this.__updateStrokeBounds(),this.__updateLocalStrokeBounds()):i.spreadStrokeCancel(),i.strokeChanged=!1,(i.renderSpread||i.strokeSpread!==i.strokeBoxSpread)&&(i.renderChanged=!0),this.parent&&this.parent.__layout.strokeChange(),i.resized=!0),i.renderChanged&&(i.renderSpread=this.__updateRenderSpread(),i.renderSpread?((i.renderBounds===i.boxBounds||i.renderBounds===i.strokeBounds)&&i.spreadRender(),this.__updateRenderBounds(),this.__updateLocalRenderBounds()):i.spreadRenderCancel(),i.renderChanged=!1,this.parent&&this.parent.__layout.renderChange()),i.boundsChanged=!1},__updateLocalBoxBounds(){this.__hasMotionPath&&this.__updateMotionPath(),this.__hasAutoLayout&&this.__updateAutoLayout(),Os(this.__layout.boxBounds,this.__local,this.__local)},__updateLocalStrokeBounds(){Os(this.__layout.strokeBounds,this.__localMatrix,this.__layout.localStrokeBounds)},__updateLocalRenderBounds(){Os(this.__layout.renderBounds,this.__localMatrix,this.__layout.localRenderBounds)},__updateBoxBounds(){const i=this.__layout.boxBounds,t=this.__;t.__pathInputed?Jf(t.path,i):(i.x=0,i.y=0,i.width=t.width,i.height=t.height)},__updateAutoLayout(){this.__layout.matrixChanged=!0,this.isBranch?(this.leaferIsReady&&this.leafer.layouter.addExtra(this),this.__.flow?(this.__layout.boxChanged&&this.__updateFlowLayout(),Sa(this),Ra(this,this),this.__.__autoSide&&this.__updateBoxBounds(!0)):(Sa(this),Ra(this,this))):Zf(this)},__updateNaturalSize(){const{__:i,__layout:t}=this;i.__naturalWidth=t.boxBounds.width,i.__naturalHeight=t.boxBounds.height},__updateStrokeBounds(){const i=this.__layout;Ta(i.strokeBounds,i.boxBounds,i.strokeBoxSpread)},__updateRenderBounds(){const i=this.__layout;i.renderSpread>0?Ta(i.renderBounds,i.boxBounds,i.renderSpread):Qf(i.renderBounds,i.strokeBounds)}},e_={__render(i,t){if(this.__worldOpacity)if(i.setWorld(this.__nowWorld=this.__getNowWorld(t)),i.opacity=this.__.opacity,this.__.__single){if(this.__.eraser==="path")return this.__renderEraser(i,t);const e=i.getSameCanvas(!0,!0);this.__draw(e,t),this.__worldFlipped?i.copyWorldByReset(e,this.__nowWorld,null,this.__.__blendMode,!0):i.copyWorldToInner(e,this.__nowWorld,this.__layout.renderBounds,this.__.__blendMode),e.recycle(this.__nowWorld)}else this.__draw(i,t)},__clip(i,t){this.__worldOpacity&&(i.setWorld(this.__nowWorld=this.__getNowWorld(t)),this.__drawRenderPath(i),this.windingRule?i.clip(this.windingRule):i.clip())},__updateWorldOpacity(){this.__worldOpacity=this.__.visible?this.parent?this.parent.__worldOpacity*this.__.opacity:this.__.opacity:0,this.__layout.opacityChanged&&(this.__layout.opacityChanged=!1)}},{excludeRenderBounds:ka}=yn,i_={__updateChange(){const{__layout:i}=this;i.childrenSortChanged&&(this.__updateSortChildren(),i.childrenSortChanged=!1),this.__.__checkSingle()},__render(i,t){if(this.__nowWorld=this.__getNowWorld(t),this.__worldOpacity)if(this.__.__single){if(this.__.eraser==="path")return this.__renderEraser(i,t);const e=i.getSameCanvas(!1,!0);this.__renderBranch(e,t);const s=this.__nowWorld;i.opacity=this.__.opacity,i.copyWorldByReset(e,s,s,this.__.__blendMode,!0),e.recycle(s)}else this.__renderBranch(i,t)},__renderBranch(i,t){if(this.__hasMask)this.__renderMask(i,t);else{const{children:e}=this;for(let s=0,n=e.length;s<n;s++)ka(e[s],t)||e[s].__render(i,t)}},__clip(i,t){if(this.__worldOpacity){const{children:e}=this;for(let s=0,n=e.length;s<n;s++)ka(e[s],t)||e[s].__clip(i,t)}}},{LEAF:s_,create:n_}=we,{toInnerPoint:r_,toOuterPoint:o_,multiplyParent:a_}=k,{toOuterOf:Pa}=S,{copy:Oa,move:Aa}=T,{moveLocal:h_,zoomOfLocal:l_,rotateOfLocal:c_,skewOfLocal:u_,moveWorld:La,zoomOfWorld:d_,rotateOfWorld:f_,skewOfWorld:__,transform:Da,transformWorld:p_,setTransform:g_,getFlipTransform:y_,getLocalOrigin:rr,getRelativeWorld:m_,drop:w_}=oe;let Ve=class{get tag(){return this.__tag}set tag(t){}get __tag(){return"Leaf"}get innerName(){return this.__.name||this.tag+this.innerId}get __DataProcessor(){return il}get __LayoutProcessor(){return Af}get leaferIsCreated(){return this.leafer&&this.leafer.created}get leaferIsReady(){return this.leafer&&this.leafer.ready}get isLeafer(){return!1}get isBranch(){return!1}get isBranchLeaf(){return!1}get __localMatrix(){return this.__local||this.__layout}get __localBoxBounds(){return this.__local||this.__layout}get worldTransform(){return this.__layout.getTransform("world")}get localTransform(){return this.__layout.getTransform("local")}get boxBounds(){return this.getBounds("box","inner")}get renderBounds(){return this.getBounds("render","inner")}get worldBoxBounds(){return this.getBounds("box")}get worldStrokeBounds(){return this.getBounds("stroke")}get worldRenderBounds(){return this.getBounds("render")}get worldOpacity(){return this.__layout.update(),this.__worldOpacity}get __worldFlipped(){return this.__world.scaleX<0||this.__world.scaleY<0}get __onlyHitMask(){return this.__hasMask&&!this.__.hitChildren}get __ignoreHitWorld(){return(this.__hasMask||this.__hasEraser)&&this.__.hitChildren}get __inLazyBounds(){const{leafer:t}=this;return t&&t.created&&t.lazyBounds.hit(this.__world)}get pathInputed(){return this.__.__pathInputed}set event(t){this.on(t)}constructor(t){this.innerId=n_(s_),this.reset(t),this.__bubbleMap&&this.__emitLifeEvent(st.CREATED)}reset(t){this.leafer&&this.leafer.forceRender(this.__world),this.__world={a:1,b:0,c:0,d:1,e:0,f:0,x:0,y:0,width:0,height:0,scaleX:1,scaleY:1},t!==null&&(this.__local={a:1,b:0,c:0,d:1,e:0,f:0,x:0,y:0,width:0,height:0}),this.__worldOpacity=1,this.__=new this.__DataProcessor(this),this.__layout=new this.__LayoutProcessor(this),this.__level&&this.resetCustom(),t&&(t.__&&(t=t.toJSON()),t.children?this.set(t):Object.assign(this,t))}resetCustom(){this.__hasMask=this.__hasEraser=null,this.forceUpdate()}waitParent(t,e){e&&(t=t.bind(e)),this.parent?t():this.on(st.ADD,t,"once")}waitLeafer(t,e){e&&(t=t.bind(e)),this.leafer?t():this.on(st.MOUNTED,t,"once")}nextRender(t,e,s){this.leafer?this.leafer.nextRender(t,e,s):this.waitLeafer(()=>this.leafer.nextRender(t,e,s))}removeNextRender(t){this.nextRender(t,null,"off")}__bindLeafer(t){if(this.isLeafer&&t!==null&&(t=this),this.leafer&&!t&&this.leafer.leafs--,this.leafer=t,t?(t.leafs++,this.__level=this.parent?this.parent.__level+1:1,this.animation&&this.__runAnimation("in"),this.__bubbleMap&&this.__emitLifeEvent(st.MOUNTED)):this.__emitLifeEvent(st.UNMOUNTED),this.isBranch){const{children:e}=this;for(let s=0,n=e.length;s<n;s++)e[s].__bindLeafer(t)}}set(t,e){}get(t){}setAttr(t,e){this[t]=e}getAttr(t){return this[t]}getComputedAttr(t){return this.__[t]}toJSON(t){return t&&this.__layout.update(),this.__.__getInputData(null,t)}toString(t){return JSON.stringify(this.toJSON(t))}toSVG(){}__SVG(t){}toHTML(){}__setAttr(t,e){return!0}__getAttr(t){}setProxyAttr(t,e){}getProxyAttr(t){}find(t,e){}findTag(t){}findOne(t,e){}findId(t){}focus(t){}updateState(){}updateLayout(){this.__layout.update()}forceUpdate(t){t===void 0?t="width":t==="surface"&&(t="blendMode");const e=this.__.__getInput(t);this.__[t]=e===void 0?null:void 0,this[t]=e}forceRender(t){this.forceUpdate("surface")}__updateWorldMatrix(){}__updateLocalMatrix(){}__updateWorldBounds(){}__updateLocalBounds(){}__updateLocalBoxBounds(){}__updateLocalStrokeBounds(){}__updateLocalRenderBounds(){}__updateBoxBounds(){}__updateContentBounds(){}__updateStrokeBounds(){}__updateRenderBounds(){}__updateAutoLayout(){}__updateFlowLayout(){}__updateNaturalSize(){}__updateStrokeSpread(){return 0}__updateRenderSpread(){return 0}__onUpdateSize(){}__updateEraser(t){this.__hasEraser=t?!0:this.children.some(e=>e.__.eraser)}__renderEraser(t,e){t.save(),this.__clip(t,e);const{renderBounds:s}=this.__layout;t.clearRect(s.x,s.y,s.width,s.height),t.restore()}__updateMask(t){this.__hasMask=t?!0:this.children.some(e=>e.__.mask)}__renderMask(t,e){}__getNowWorld(t){if(t.matrix){this.__cameraWorld||(this.__cameraWorld={});const e=this.__cameraWorld;return a_(this.__world,t.matrix,e,void 0,this.__world),Pa(this.__layout.renderBounds,e,e),e}else return this.__world}getTransform(t){return this.__layout.getTransform(t||"local")}getBounds(t,e){return this.__layout.getBounds(t,e)}getLayoutBounds(t,e,s){return this.__layout.getLayoutBounds(t,e,s)}getLayoutPoints(t,e){return this.__layout.getLayoutPoints(t,e)}getWorldBounds(t,e,s){const n=e?m_(this,e):this.worldTransform,r=s?t:{};return Pa(t,n,r),r}worldToLocal(t,e,s,n){this.parent?this.parent.worldToInner(t,e,s,n):e&&Oa(e,t)}localToWorld(t,e,s,n){this.parent?this.parent.innerToWorld(t,e,s,n):e&&Oa(e,t)}worldToInner(t,e,s,n){n&&(n.innerToWorld(t,e,s),t=e||t),r_(this.worldTransform,t,e,s)}innerToWorld(t,e,s,n){o_(this.worldTransform,t,e,s),n&&n.worldToInner(e||t,null,s)}getBoxPoint(t,e,s,n){return this.getBoxPointByInner(this.getInnerPoint(t,e,s,n),null,null,!0)}getBoxPointByInner(t,e,s,n){const r=n?t:Object.assign({},t),{x:o,y:a}=this.boxBounds;return Aa(r,-o,-a),r}getInnerPoint(t,e,s,n){const r=n?t:{};return this.worldToInner(t,r,s,e),r}getInnerPointByBox(t,e,s,n){const r=n?t:Object.assign({},t),{x:o,y:a}=this.boxBounds;return Aa(r,o,a),r}getInnerPointByLocal(t,e,s,n){return this.getInnerPoint(t,this.parent,s,n)}getLocalPoint(t,e,s,n){const r=n?t:{};return this.worldToLocal(t,r,s,e),r}getLocalPointByInner(t,e,s,n){return this.getWorldPoint(t,this.parent,s,n)}getPagePoint(t,e,s,n){return(this.leafer?this.leafer.zoomLayer:this).getInnerPoint(t,e,s,n)}getWorldPoint(t,e,s,n){const r=n?t:{};return this.innerToWorld(t,r,s,e),r}getWorldPointByBox(t,e,s,n){return this.getWorldPoint(this.getInnerPointByBox(t,null,null,n),e,s,!0)}getWorldPointByLocal(t,e,s,n){const r=n?t:{};return this.localToWorld(t,r,s,e),r}getWorldPointByPage(t,e,s,n){return(this.leafer?this.leafer.zoomLayer:this).getWorldPoint(t,e,s,n)}setTransform(t,e){g_(this,t,e)}transform(t,e){Da(this,t,e)}move(t,e,s){h_(this,t,e,s)}moveInner(t,e,s){La(this,t,e,!0,s)}scaleOf(t,e,s,n){l_(this,rr(this,t),e,s,n)}rotateOf(t,e){c_(this,rr(this,t),e)}skewOf(t,e,s,n){u_(this,rr(this,t),e,s,n)}transformWorld(t,e){p_(this,t,e)}moveWorld(t,e,s){La(this,t,e,!1,s)}scaleOfWorld(t,e,s,n){d_(this,t,e,s,n)}rotateOfWorld(t,e){f_(this,t,e)}skewOfWorld(t,e,s,n){__(this,t,e,s,n)}flip(t){Da(this,y_(this,t))}scaleResize(t,e=t,s){this.scaleX*=t,this.scaleY*=e}__scaleResize(t,e){}resizeWidth(t){}resizeHeight(t){}__hitWorld(t){return!0}__hit(t){return!0}__hitFill(t){return!0}__hitStroke(t,e){return!0}__hitPixel(t){return!0}__drawHitPath(t){}__updateHitCanvas(){}__render(t,e){}__drawFast(t,e){}__draw(t,e){}__clip(t,e){}__renderShape(t,e,s,n){}__updateWorldOpacity(){}__updateChange(){}__drawPath(t){}__drawRenderPath(t){}__updatePath(){}__updateRenderPath(){}getMotionPathData(){return bi("path")}getMotionPoint(t){return bi("path")}getMotionTotal(){return 0}__updateMotionPath(){}__runAnimation(t,e){}__updateSortChildren(){}add(t,e){}remove(t,e){this.parent&&this.parent.remove(this,e)}dropTo(t,e,s){w_(this,t,e,s)}on(t,e,s){}off(t,e,s){}on_(t,e,s,n){}off_(t){}once(t,e,s){}emit(t,e,s){}emitEvent(t,e){}hasEvent(t,e){return!1}static changeAttr(t,e,s){s?this.addAttr(t,e,s):gl(this.prototype,t,e)}static addAttr(t,e,s){s||(s=D),s(e)(this.prototype,t)}__emitLifeEvent(t){this.hasEvent(t)&&this.emitEvent(new st(t,this,this.parent))}destroy(){this.destroyed||(this.parent&&this.remove(),this.children&&this.clear(),this.__emitLifeEvent(st.DESTROY),this.__.destroy(),this.__layout.destroy(),this.destroyEventer(),this.destroyed=!0)}};Ve=b([Ft(Gf),Ft(Kf),Ft(t_),Ft(wl),Ft(e_)],Ve);const{setListWithFn:or}=S,{sort:x_}=cs,{localBoxBounds:v_,localStrokeBounds:b_,localRenderBounds:B_,maskLocalBoxBounds:C_,maskLocalStrokeBounds:E_,maskLocalRenderBounds:S_}=yn;let $r=class extends Ve{__updateStrokeSpread(){const{children:t}=this;for(let e=0,s=t.length;e<s;e++)if(t[e].__layout.strokeSpread)return 1;return 0}__updateRenderSpread(){const{children:t}=this;for(let e=0,s=t.length;e<s;e++)if(t[e].__layout.renderSpread)return 1;return 0}__updateBoxBounds(){or(this.__layout.boxBounds,this.children,this.__hasMask?C_:v_)}__updateStrokeBounds(){or(this.__layout.strokeBounds,this.children,this.__hasMask?E_:b_)}__updateRenderBounds(){or(this.__layout.renderBounds,this.children,this.__hasMask?S_:B_)}__updateSortChildren(){let t;const{children:e}=this;if(e.length>1){for(let s=0,n=e.length;s<n;s++)e[s].__tempNumber=s,e[s].__.zIndex&&(t=!0);e.sort(x_),this.__layout.affectChildrenSort=t}}add(t,e){if(t===this)return;const s=e===void 0;if(!t.__){if(t instanceof Array)return t.forEach(n=>{this.add(n,e),s||e++});t=fn.get(t.tag,t)}t.parent&&t.parent.remove(t),t.parent=this,s?this.children.push(t):this.children.splice(e,0,t),t.isBranch&&(this.__.__childBranchNumber=(this.__.__childBranchNumber||0)+1),t.__layout.boxChanged||t.__layout.boxChange(),t.__layout.matrixChanged||t.__layout.matrixChange(),t.__bubbleMap&&t.__emitLifeEvent(st.ADD),this.leafer&&(t.__bindLeafer(this.leafer),this.leafer.created&&this.__emitChildEvent(st.ADD,t)),this.__layout.affectChildrenSort&&this.__layout.childrenSortChange()}addMany(...t){this.add(t)}remove(t,e){t?t.__?t.animationOut?t.__runAnimation("out",()=>this.__remove(t,e)):this.__remove(t,e):this.find(t).forEach(s=>this.remove(s,e)):t===void 0&&super.remove(null,e)}removeAll(t){const{children:e}=this;e.length&&(this.children=[],this.__preRemove(),this.__.__childBranchNumber=0,e.forEach(s=>{this.__realRemoveChild(s),t&&s.destroy()}))}clear(){this.removeAll(!0)}__remove(t,e){const s=this.children.indexOf(t);s>-1&&(this.children.splice(s,1),t.isBranch&&(this.__.__childBranchNumber=(this.__.__childBranchNumber||1)-1),this.__preRemove(),this.__realRemoveChild(t),e&&t.destroy())}__preRemove(){this.__hasMask&&this.__updateMask(),this.__hasEraser&&this.__updateEraser(),this.__layout.boxChange(),this.__layout.affectChildrenSort&&this.__layout.childrenSortChange()}__realRemoveChild(t){t.__emitLifeEvent(st.REMOVE),t.parent=null,this.leafer&&(t.__bindLeafer(null),this.leafer.created&&(this.__emitChildEvent(st.REMOVE,t),this.leafer.hitCanvasManager&&this.leafer.hitCanvasManager.clear()))}__emitChildEvent(t,e){const s=new st(t,e,this);this.hasEvent(t)&&!this.isLeafer&&this.emitEvent(s),this.leafer.emitEvent(s)}};$r=b([Ft(i_)],$r);class nt{get length(){return this.list.length}constructor(t){this.reset(),t&&(t instanceof Array?this.addList(t):this.add(t))}has(t){return t&&this.keys[t.innerId]!==void 0}indexAt(t){return this.list[t]}indexOf(t){const e=this.keys[t.innerId];return e===void 0?-1:e}add(t){const{list:e,keys:s}=this;s[t.innerId]===void 0&&(e.push(t),s[t.innerId]=e.length-1)}addAt(t,e=0){const{keys:s}=this;if(s[t.innerId]===void 0){const{list:n}=this;for(let r=e,o=n.length;r<o;r++)s[n[r].innerId]++;e===0?n.unshift(t):(e>n.length&&(e=n.length),n.splice(e,0,t)),s[t.innerId]=e}}addList(t){for(let e=0;e<t.length;e++)this.add(t[e])}remove(t){const{list:e}=this;let s;for(let n=0,r=e.length;n<r;n++)s!==void 0?this.keys[e[n].innerId]=n-1:e[n].innerId===t.innerId&&(s=n,delete this.keys[t.innerId]);s!==void 0&&e.splice(s,1)}sort(t){const{list:e}=this;t?e.sort((s,n)=>n.__level-s.__level):e.sort((s,n)=>s.__level-n.__level)}forEach(t){this.list.forEach(t)}clone(){const t=new nt;return t.list=[...this.list],t.keys=Object.assign({},this.keys),t}update(){this.keys={};const{list:t,keys:e}=this;for(let s=0,n=t.length;s<n;s++)e[t[s].innerId]=s}reset(){this.list=[],this.keys={}}destroy(){this.reset()}}class R_{get length(){return this._length}constructor(t){this._length=0,this.reset(),t&&(t instanceof Array?this.addList(t):this.add(t))}has(t){return this.keys[t.innerId]!==void 0}without(t){return this.keys[t.innerId]===void 0}sort(t){const{levels:e}=this;t?e.sort((s,n)=>n-s):e.sort((s,n)=>s-n)}addList(t){t.forEach(e=>{this.add(e)})}add(t){const{keys:e,levelMap:s}=this;e[t.innerId]||(e[t.innerId]=1,s[t.__level]?s[t.__level].push(t):(s[t.__level]=[t],this.levels.push(t.__level)),this._length++)}forEach(t){let e;this.levels.forEach(s=>{e=this.levelMap[s];for(let n=0,r=e.length;n<r;n++)t(e[n])})}reset(){this.levelMap={},this.keys={},this.levels=[],this._length=0}destroy(){this.levelMap=null}}function p(i,t,e,s){var n=arguments.length,r=n<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,e):s,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(i,t,e,s);else for(var a=i.length-1;a>=0;a--)(o=i[a])&&(r=(n<3?o(r):n>3?o(t,e,r):o(t,e))||r);return n>3&&r&&Object.defineProperty(t,e,r),r}function us(i){return Z(i,t=>({set(e){this.__setAttr(t,e),e&&(this.__.__useEffect=!0),this.__layout.renderChanged||this.__layout.renderChange()}}))}function ds(i){return Z(i,t=>({set(e){this.__setAttr(t,e),this.__layout.boxChanged||this.__layout.boxChange(),this.__updateSize()}}))}function T_(){return(i,t)=>{const e="_"+t;Pi(i,t,{set(s){this.isLeafer&&(this[e]=s)},get(){return this.isApp?this.tree.zoomLayer:this.isLeafer?this[e]||this:this.leafer&&this.leafer.zoomLayer}})}}const xl={},se={},zr={number(i,t){return typeof i=="object"?i.type==="percent"?i.value*t:i.value:i}},vl={},ut={},qe={},Ys={},jr={},mi={},$={setStyleName(i,t,e){return bi("state")},set(i,t){return bi("state")}},Ci={list:{},register(i,t){Ci.list[i]=t},get(i){return Ci.list[i]}},{parse:k_,objectToCanvasData:P_}=Xe,Ma={},Fa=N.get("UIData");class Be extends il{get scale(){const{scaleX:t,scaleY:e}=this;return t!==e?{x:t,y:e}:t}get __strokeWidth(){const{strokeWidth:t,strokeWidthFixed:e}=this;if(e){const s=this.__leaf;let{scaleX:n}=s.__nowWorld||s.__world;return n<0&&(n=-n),n>1?t/n:t}else return t}get __hasStroke(){return this.stroke&&this.strokeWidth}get __hasMultiPaint(){const t=this;return t.__isFills&&t.fill.length>1||t.__isStrokes&&t.stroke.length>1||t.__useEffect?!0:t.fill&&this.__hasStroke}get __clipAfterFill(){return this.cornerRadius||this.__pathInputed}get __autoWidth(){return!this._width}get __autoHeight(){return!this._height}get __autoSide(){return!this._width||!this._height}get __autoSize(){return!this._width&&!this._height}setVisible(t){this._visible=t;const{leafer:e}=this.__leaf;e&&(e.watcher.hasVisible=!0)}setWidth(t){t<0?(this._width=-t,this.__leaf.scaleX*=-1,Fa.warn("width < 0, instead -scaleX ",this)):this._width=t}setHeight(t){t<0?(this._height=-t,this.__leaf.scaleY*=-1,Fa.warn("height < 0, instead -scaleY",this)):this._height=t}setFill(t){this.__naturalWidth&&this.__removeNaturalSize(),typeof t=="string"||!t?(this.__isFills&&(this.__removeInput("fill"),qe.recycleImage("fill",this),this.__isFills=!1,this.__pixelFill&&(this.__pixelFill=!1)),this._fill=t):typeof t=="object"&&(this.__setInput("fill",t),this.__leaf.__layout.boxChanged||this.__leaf.__layout.boxChange(),this.__isFills=!0,this._fill||(this._fill=Ma))}setStroke(t){typeof t=="string"||!t?(this.__isStrokes&&(this.__removeInput("stroke"),qe.recycleImage("stroke",this),this.__isStrokes=!1,this.__pixelStroke&&(this.__pixelStroke=!1)),this._stroke=t):typeof t=="object"&&(this.__setInput("stroke",t),this.__leaf.__layout.boxChanged||this.__leaf.__layout.boxChange(),this.__isStrokes=!0,this._stroke||(this._stroke=Ma))}setPath(t){const e=typeof t=="string";e||t&&typeof t[0]=="object"?(this.__setInput("path",t),this._path=e?k_(t):P_(t)):(this.__input&&this.__removeInput("path"),this._path=t)}setShadow(t){this.__setInput("shadow",t),t instanceof Array?(t.some(e=>e.visible===!1)&&(t=t.filter(e=>e.visible!==!1)),this._shadow=t.length?t:null):this._shadow=t&&t.visible!==!1?[t]:null}setInnerShadow(t){this.__setInput("innerShadow",t),t instanceof Array?(t.some(e=>e.visible===!1)&&(t=t.filter(e=>e.visible!==!1)),this._innerShadow=t.length?t:null):this._innerShadow=t&&t.visible!==!1?[t]:null}__computePaint(){const{fill:t,stroke:e}=this.__input;t&&ut.compute("fill",this.__leaf),e&&ut.compute("stroke",this.__leaf),this.__needComputePaint=!1}}class mn extends Be{}class so extends mn{get __boxStroke(){return!this.__pathInputed}get __drawAfterFill(){return this.overflow==="hide"&&this.__clipAfterFill&&this.__leaf.children.length}get __clipAfterFill(){return this.__leaf.isOverflow||super.__clipAfterFill}}class O_ extends mn{__getInputData(t,e){const s=super.__getInputData(t,e);return Gt.forEach(n=>delete s[n]),s}}class A_ extends so{}class L_ extends Be{}class no extends Be{get __boxStroke(){return!this.__pathInputed}}class D_ extends Be{get __boxStroke(){return!this.__pathInputed}}class M_ extends Be{}class F_ extends Be{}class I_ extends Be{get __pathInputed(){return 2}}class W_ extends mn{}const $_={thin:100,"extra-light":200,light:300,normal:400,medium:500,"semi-bold":600,bold:700,"extra-bold":800,black:900};class z_ extends Be{get __useNaturalRatio(){return!1}setFontWeight(t){typeof t=="string"?(this.__setInput("fontWeight",t),this._fontWeight=$_[t]||400):(this.__input&&this.__removeInput("fontWeight"),this._fontWeight=t)}}class j_ extends no{setUrl(t){this.__setImageFill(t),this._url=t}__setImageFill(t){this.__leaf.image&&(this.__leaf.image=null),this.fill=t?{type:"image",mode:"stretch",url:t}:void 0}__getData(){const t=super.__getData();return delete t.fill,t}__getInputData(t,e){const s=super.__getInputData(t,e);return delete s.fill,s}}class N_ extends no{get __isCanvas(){return!0}get __drawAfterFill(){return!0}__getInputData(t,e){const s=super.__getInputData(t,e);return s.url=this.__leaf.canvas.toDataURL("image/png"),s}}const H_={__updateStrokeSpread(){let i=0,t=0;const e=this.__,{strokeAlign:s,strokeWidth:n}=e;if((e.stroke||e.hitStroke==="all")&&n&&s!=="inside"&&(t=i=s==="center"?n/2:n,!e.__boxStroke)){const r=e.__isLinePath?0:10*i,o=e.strokeCap==="none"?0:n;i+=Math.max(r,o)}return e.__useArrow&&(i+=n*5),this.__layout.strokeBoxSpread=t,i},__updateRenderSpread(){let i=0;const{shadow:t,innerShadow:e,blur:s,backgroundBlur:n}=this.__;t&&t.forEach(o=>i=Math.max(i,Math.max(Math.abs(o.y),Math.abs(o.x))+(o.spread>0?o.spread:0)+o.blur*1.5)),s&&(i=Math.max(i,s));let r=i=Math.ceil(i);return e&&e.forEach(o=>r=Math.max(r,Math.max(Math.abs(o.y),Math.abs(o.x))+(o.spread<0?-o.spread:0)+o.blur*1.5)),n&&(r=Math.max(r,n)),this.__layout.renderShapeSpread=r,i+(this.__layout.strokeSpread||0)}},G_={__updateChange(){const i=this.__;if(i.__useEffect){const{shadow:e,innerShadow:s,blur:n,backgroundBlur:r}=this.__;i.__useEffect=!!(e||s||n||r)}i.__checkSingle(),i.__isFills||i.__isStrokes||i.cornerRadius||i.__useEffect?i.__complex=!0:i.__complex&&(i.__complex=!1)},__drawFast(i,t){Ia(this,i,t)},__draw(i,t){const e=this.__;if(e.__complex){e.__needComputePaint&&e.__computePaint();const{fill:s,stroke:n,__drawAfterFill:r}=e;if(this.__drawRenderPath(i),e.__useEffect){const o=ut.shape(this,i,t);this.__nowWorld=this.__getNowWorld(t);const{shadow:a,innerShadow:h}=e;a&&jr.shadow(this,i,o),s&&(e.__isFills?ut.fills(s,this,i):ut.fill(s,this,i)),r&&this.__drawAfterFill(i,t),h&&jr.innerShadow(this,i,o),n&&(e.__isStrokes?ut.strokes(n,this,i):ut.stroke(n,this,i)),o.worldCanvas&&o.worldCanvas.recycle(),o.canvas.recycle()}else s&&(e.__isFills?ut.fills(s,this,i):ut.fill(s,this,i)),r&&this.__drawAfterFill(i,t),n&&(e.__isStrokes?ut.strokes(n,this,i):ut.stroke(n,this,i))}else e.__pathInputed?Ia(this,i,t):this.__drawFast(i,t)},__renderShape(i,t,e,s){if(this.__worldOpacity){i.setWorld(this.__nowWorld=this.__getNowWorld(t));const{fill:n,stroke:r}=this.__;this.__drawRenderPath(i),n&&!e&&(this.__.__pixelFill?ut.fills(n,this,i):ut.fill("#000000",this,i)),this.__.__isCanvas&&this.__drawAfterFill(i,t),r&&!s&&(this.__.__pixelStroke?ut.strokes(r,this,i):ut.stroke("#000000",this,i))}},__drawAfterFill(i,t){this.__.__clipAfterFill?(i.save(),this.windingRule?i.clip(this.windingRule):i.clip(),this.__drawContent(i,t),i.restore()):this.__drawContent(i,t)}};function Ia(i,t,e){const{fill:s,stroke:n,__drawAfterFill:r}=i.__;i.__drawRenderPath(t),s&&ut.fill(s,i,t),r&&i.__drawAfterFill(t,e),n&&ut.stroke(n,i,t)}const U_={__drawFast(i,t){let{width:e,height:s,fill:n,stroke:r,__drawAfterFill:o}=this.__;if(n&&(i.fillStyle=n,i.fillRect(0,0,e,s)),o&&this.__drawAfterFill(i,t),r){const{strokeAlign:a,__strokeWidth:h}=this.__;if(!h)return;i.setStroke(r,h,this.__);const l=h/2;switch(a){case"center":i.strokeRect(0,0,e,s);break;case"inside":e-=h,s-=h,e<0||s<0?(i.save(),this.__clip(i,t),i.strokeRect(l,l,e,s),i.restore()):i.strokeRect(l,l,e,s);break;case"outside":i.strokeRect(-l,-l,e+h,s+h);break}}}};var Nr;let m=Nr=class extends Ve{get app(){return this.leafer&&this.leafer.app}get isFrame(){return!1}set scale(t){ct.assignScale(this,t)}get scale(){return this.__.scale}get pen(){const{path:t}=this.__;return Wi.set(this.path=t||[]),t||this.__drawPathByBox(Wi),Wi}get editConfig(){}get editOuter(){return""}get editInner(){return""}constructor(t){super(t)}reset(t){}set(t,e){e?e==="temp"?(this.lockNormalStyle=!0,Object.assign(this,t),this.lockNormalStyle=!1):this.animate(t,e):Object.assign(this,t)}get(t){return typeof t=="string"?this.__.__getInput(t):this.__.__getInputData(t)}createProxyData(){}find(t,e){}findTag(t){return this.find({tag:t})}findOne(t,e){}findId(t){return this.findOne({id:t})}getPath(t,e){this.__layout.update();let s=e?this.__.__pathForRender:this.__.path;return s||(Wi.set(s=[]),this.__drawPathByBox(Wi)),t?Xe.toCanvasData(s,!0):s}getPathString(t,e,s){return Xe.stringify(this.getPath(t,e),s)}load(){this.__.__computePaint()}__onUpdateSize(){if(this.__.__input){const t=this.__;t.lazy&&!this.__inLazyBounds&&!mi.running?t.__needComputePaint=!0:t.__computePaint()}}__updateRenderPath(){if(this.__.path){const t=this.__;t.__pathForRender=t.cornerRadius?Qd.smooth(t.path,t.cornerRadius,t.cornerSmoothing):t.path,t.__useArrow&&vl.addArrows(this,!t.cornerRadius)}}__drawRenderPath(t){t.beginPath(),this.__drawPathByData(t,this.__.__pathForRender)}__drawPath(t){t.beginPath(),this.__drawPathByData(t,this.__.path)}__drawPathByData(t,e){e?Ad.drawPathByData(t,e):this.__drawPathByBox(t)}__drawPathByBox(t){const{x:e,y:s,width:n,height:r}=this.__layout.boxBounds;if(this.__.cornerRadius){const{cornerRadius:o}=this.__;t.roundRect(e,s,n,r,typeof o=="number"?[o]:o)}else t.rect(e,s,n,r)}animate(t,e,s,n){return bi("animate")}killAnimate(t){}export(t,e){return mi.export(this,t,e)}clone(t){const e=this.toJSON();return t&&Object.assign(e,t),Nr.one(e)}static one(t,e,s,n,r){return fn.get(t.tag||this.prototype.__tag,t,e,s,n,r)}static registerUI(){ft()(this)}static registerData(t){dt(t)(this.prototype)}static setEditConfig(t){}static setEditOuter(t){}static setEditInner(t){}destroy(){this.fill=this.stroke=null,this.__animate&&this.killAnimate(),super.destroy()}};p([dt(Be)],m.prototype,"__",void 0);p([T_()],m.prototype,"zoomLayer",void 0);p([vt("")],m.prototype,"id",void 0);p([vt("")],m.prototype,"name",void 0);p([vt("")],m.prototype,"className",void 0);p([ls("pass-through")],m.prototype,"blendMode",void 0);p([uf(1)],m.prototype,"opacity",void 0);p([df(!0)],m.prototype,"visible",void 0);p([ls(!1)],m.prototype,"locked",void 0);p([ff(0)],m.prototype,"zIndex",void 0);p([_f(!1)],m.prototype,"mask",void 0);p([pf(!1)],m.prototype,"eraser",void 0);p([Oi(0,!0)],m.prototype,"x",void 0);p([Oi(0,!0)],m.prototype,"y",void 0);p([D(100,!0)],m.prototype,"width",void 0);p([D(100,!0)],m.prototype,"height",void 0);p([_l(1,!0)],m.prototype,"scaleX",void 0);p([_l(1,!0)],m.prototype,"scaleY",void 0);p([io(0,!0)],m.prototype,"rotation",void 0);p([io(0,!0)],m.prototype,"skewX",void 0);p([io(0,!0)],m.prototype,"skewY",void 0);p([Oi(0,!0)],m.prototype,"offsetX",void 0);p([Oi(0,!0)],m.prototype,"offsetY",void 0);p([Oi(0,!0)],m.prototype,"scrollX",void 0);p([Oi(0,!0)],m.prototype,"scrollY",void 0);p([_n()],m.prototype,"origin",void 0);p([_n()],m.prototype,"around",void 0);p([vt(!1)],m.prototype,"lazy",void 0);p([hf(1)],m.prototype,"pixelRatio",void 0);p([lf()],m.prototype,"path",void 0);p([bt()],m.prototype,"windingRule",void 0);p([bt(!0)],m.prototype,"closed",void 0);p([D(0)],m.prototype,"padding",void 0);p([D(!1)],m.prototype,"lockRatio",void 0);p([D()],m.prototype,"widthRange",void 0);p([D()],m.prototype,"heightRange",void 0);p([vt(!1)],m.prototype,"draggable",void 0);p([vt()],m.prototype,"dragBounds",void 0);p([vt(!1)],m.prototype,"editable",void 0);p([Qe(!0)],m.prototype,"hittable",void 0);p([Qe("path")],m.prototype,"hitFill",void 0);p([re("path")],m.prototype,"hitStroke",void 0);p([Qe(!1)],m.prototype,"hitBox",void 0);p([Qe(!0)],m.prototype,"hitChildren",void 0);p([Qe(!0)],m.prototype,"hitSelf",void 0);p([Qe()],m.prototype,"hitRadius",void 0);p([gf("")],m.prototype,"cursor",void 0);p([ls()],m.prototype,"fill",void 0);p([re()],m.prototype,"stroke",void 0);p([re("inside")],m.prototype,"strokeAlign",void 0);p([re(1)],m.prototype,"strokeWidth",void 0);p([re(!1)],m.prototype,"strokeWidthFixed",void 0);p([re("none")],m.prototype,"strokeCap",void 0);p([re("miter")],m.prototype,"strokeJoin",void 0);p([re()],m.prototype,"dashPattern",void 0);p([re()],m.prototype,"dashOffset",void 0);p([re(10)],m.prototype,"miterLimit",void 0);p([bt(0)],m.prototype,"cornerRadius",void 0);p([bt()],m.prototype,"cornerSmoothing",void 0);p([us()],m.prototype,"shadow",void 0);p([us()],m.prototype,"innerShadow",void 0);p([us()],m.prototype,"blur",void 0);p([us()],m.prototype,"backgroundBlur",void 0);p([us()],m.prototype,"grayscale",void 0);p([vt({})],m.prototype,"data",void 0);p([Kt(Ve.prototype.reset)],m.prototype,"reset",null);m=Nr=p([Ft(H_),Ft(G_),gn()],m);let qt=class extends m{get __tag(){return"Group"}get isBranch(){return!0}constructor(t){super(t)}reset(t){this.__setBranch(),super.reset(t)}__setBranch(){this.children||(this.children=[])}set(t,e){if(t.children){const{children:s}=t;delete t.children,this.children?this.clear():this.__setBranch(),super.set(t,e),s.forEach(n=>this.add(n)),t.children=s}else super.set(t,e)}toJSON(t){const e=super.toJSON(t);return e.children=this.children.map(s=>s.toJSON(t)),e}pick(t,e){}addAt(t,e){this.add(t,e)}addAfter(t,e){this.add(t,this.children.indexOf(e)+1)}addBefore(t,e){this.add(t,this.children.indexOf(e))}add(t,e){}addMany(...t){}remove(t,e){}removeAll(t){}clear(){}};p([dt(mn)],qt.prototype,"__",void 0);qt=p([Ft($r),ft()],qt);var Xs;const Wa=N.get("Leafer");let xe=Xs=class extends qt{get __tag(){return"Leafer"}get isApp(){return!1}get app(){return this.parent||this}get isLeafer(){return!0}get imageReady(){return this.viewReady&&St.isComplete}get layoutLocked(){return!this.layouter.running}get FPS(){return this.renderer?this.renderer.FPS:60}get cursorPoint(){return this.interaction&&this.interaction.hoverData||{x:this.width/2,y:this.height/2}}get clientBounds(){return this.canvas&&this.canvas.getClientBounds()}constructor(t,e){super(e),this.config={type:"design",start:!0,hittable:!0,smooth:!0,lazySpeard:100,zoom:{min:.01,max:256},move:{holdSpaceKey:!0,holdMiddleKey:!0,autoDistance:2}},this.leafs=0,this.__eventIds=[],this.__controllers=[],this.__readyWait=[],this.__viewReadyWait=[],this.__viewCompletedWait=[],this.__nextRenderWait=[],this.userConfig=t,t&&(t.view||t.width)&&this.init(t),Xs.list.add(this)}init(t,e){if(this.canvas)return;this.__setLeafer(this),t&&lt.assign(this.config,t);let s;const{config:n}=this;this.initType(n.type);const r=this.canvas=rt.canvas(n);this.__controllers.push(this.renderer=rt.renderer(this,r,n),this.watcher=rt.watcher(this,n),this.layouter=rt.layouter(this,n)),this.isApp&&this.__setApp(),this.__checkAutoLayout(n,e),this.view=r.view,e?(this.__bindApp(e),s=e.running):(this.selector=rt.selector(this),this.interaction=rt.interaction(this,r,this.selector,n),this.interaction&&(this.__controllers.unshift(this.interaction),this.hitCanvasManager=rt.hitCanvasManager()),this.canvasManager=new el,s=n.start),this.hittable=n.hittable,this.fill=n.fill,this.canvasManager.add(r),this.__listenEvents(),s&&(this.__startTimer=setTimeout(this.start.bind(this))),$i.run(this.__initWait),this.onInit()}onInit(){}initType(t){}set(t,e){this.waitInit(()=>{super.set(t,e)})}start(){clearTimeout(this.__startTimer),!this.running&&this.canvas&&(this.running=!0,this.ready?this.emitLeafer(it.RESTART):this.emitLeafer(it.START),this.__controllers.forEach(t=>t.start()),this.isApp||this.renderer.render())}stop(){clearTimeout(this.__startTimer),this.running&&this.canvas&&(this.__controllers.forEach(t=>t.stop()),this.running=!1,this.emitLeafer(it.STOP))}unlockLayout(){this.layouter.start(),this.updateLayout()}lockLayout(){this.updateLayout(),this.layouter.stop()}resize(t){const e=lt.copyAttrs({},t,Gt);Object.keys(e).forEach(s=>this[s]=e[s])}forceRender(t){this.renderer.addBlock(t?new J(t):this.canvas.bounds),this.viewReady&&this.renderer.update()}updateCursor(t){const e=this.interaction;e&&(t?e.setCursor(t):e.updateCursor())}updateLazyBounds(){this.lazyBounds=this.canvas.bounds.clone().spread(this.config.lazySpeard)}__doResize(t){const{canvas:e}=this;if(!e||e.isSameSize(t))return;const s=lt.copyAttrs({},this.canvas,Gt);e.resize(t),this.updateLazyBounds(),this.__onResize(new Je(t,s))}__onResize(t){this.emitEvent(t),lt.copyAttrs(this.__,t,Gt),setTimeout(()=>{this.canvasManager&&this.canvasManager.clearRecycled()},0)}__setApp(){}__bindApp(t){this.selector=t.selector,this.interaction=t.interaction,this.canvasManager=t.canvasManager,this.hitCanvasManager=t.hitCanvasManager}__setLeafer(t){this.leafer=t,this.__level=1}__checkAutoLayout(t,e){e||((!t.width||!t.height)&&(this.autoLayout=new tu(t)),this.canvas.startAutoLayout(this.autoLayout,this.__onResize.bind(this)))}__setAttr(t,e){return this.canvas&&(Gt.includes(t)?(e||Wa.warn(t+" is 0"),this.__changeCanvasSize(t,e)):t==="fill"?this.__changeFill(e):t==="hittable"?this.parent||(this.canvas.hittable=e):t==="zIndex"&&(this.canvas.zIndex=e,setTimeout(()=>this.parent&&this.parent.__updateSortChildren()))),super.__setAttr(t,e)}__getAttr(t){return this.canvas&&Gt.includes(t)?this.canvas[t]:super.__getAttr(t)}__changeCanvasSize(t,e){const s=lt.copyAttrs({},this.canvas,Gt);s[t]=this.config[t]=e,e&&this.canvas.stopAutoLayout(),this.__doResize(s)}__changeFill(t){this.config.fill=t,this.canvas.allowBackgroundColor?this.canvas.backgroundColor=t:this.forceRender()}__onCreated(){this.created=!0}__onReady(){this.ready||(this.ready=!0,this.emitLeafer(it.BEFORE_READY),this.emitLeafer(it.READY),this.emitLeafer(it.AFTER_READY),$i.run(this.__readyWait))}__onViewReady(){this.viewReady||(this.viewReady=!0,this.emitLeafer(it.VIEW_READY),$i.run(this.__viewReadyWait))}__onNextRender(){if(this.viewReady){$i.run(this.__nextRenderWait);const{imageReady:t}=this;t&&!this.viewCompleted&&this.__checkViewCompleted(),t||(this.viewCompleted=!1)}}__checkViewCompleted(t=!0){this.nextRender(()=>{this.imageReady&&(t&&this.emitLeafer(it.VIEW_COMPLETED),$i.run(this.__viewCompletedWait),this.viewCompleted=!0)})}__onWatchData(){this.watcher.childrenChanged&&this.interaction&&this.nextRender(()=>this.interaction.updateCursor())}waitInit(t,e){e&&(t=t.bind(e)),this.__initWait||(this.__initWait=[]),this.canvas?t():this.__initWait.push(t)}waitReady(t,e){e&&(t=t.bind(e)),this.ready?t():this.__readyWait.push(t)}waitViewReady(t,e){e&&(t=t.bind(e)),this.viewReady?t():this.__viewReadyWait.push(t)}waitViewCompleted(t,e){e&&(t=t.bind(e)),this.__viewCompletedWait.push(t),this.viewCompleted?this.__checkViewCompleted(!1):this.running||this.start()}nextRender(t,e,s){e&&(t=t.bind(e));const n=this.__nextRenderWait;if(s){for(let r=0;r<n.length;r++)if(n[r]===t){n.splice(r,1);break}}else n.push(t)}zoom(t,e,s){return bi("view")}getValidMove(t,e){return{x:t,y:e}}getValidScale(t){return t}getWorldPointByClient(t,e){return this.interaction&&this.interaction.getLocal(t,e)}getPagePointByClient(t,e){return this.getPagePoint(this.getWorldPointByClient(t,e))}updateClientBounds(){this.canvas&&this.canvas.updateClientBounds()}receiveEvent(t){}__checkUpdateLayout(){this.__layout.update()}emitLeafer(t){this.emitEvent(new it(t,this))}__listenEvents(){const t=Ut.start("FirstCreate "+this.innerName);this.once(it.START,()=>Ut.end(t)),this.once(G.START,()=>this.updateLazyBounds()),this.once(G.END,()=>this.__onReady()),this.once(Y.START,()=>this.__onCreated()),this.once(Y.END,()=>this.__onViewReady()),this.__eventIds.push(this.on_(Ae.DATA,this.__onWatchData,this),this.on_(Y.NEXT,this.__onNextRender,this),this.on_(G.CHECK_UPDATE,this.__checkUpdateLayout,this))}__removeListenEvents(){this.off_(this.__eventIds),this.__eventIds.length=0}destroy(t){const e=()=>{if(!this.destroyed){Xs.list.remove(this);try{this.stop(),this.emitEvent(new it(it.END,this)),this.__removeListenEvents(),this.__controllers.forEach(s=>!(this.parent&&s===this.interaction)&&s.destroy()),this.__controllers.length=0,this.parent||(this.selector&&this.selector.destroy(),this.hitCanvasManager&&this.hitCanvasManager.destroy(),this.canvasManager.destroy()),this.canvas.destroy(),this.config.view=this.view=null,this.userConfig&&(this.userConfig.view=null),super.destroy(),setTimeout(()=>{St.clearRecycled()},100)}catch(s){Wa.error(s)}}};t?e():setTimeout(e)}};xe.list=new nt;p([dt(O_)],xe.prototype,"__",void 0);p([D()],xe.prototype,"pixelRatio",void 0);xe=Xs=p([ft()],xe);let Ke=class extends m{get __tag(){return"Rect"}constructor(t){super(t)}};p([dt(no)],Ke.prototype,"__",void 0);Ke=p([Ft(U_),gn(),ft()],Ke);const{copy:Y_,add:X_,includes:V_}=S,ti=Ke.prototype,q_=qt.prototype,ar={};let ot=class extends qt{get __tag(){return"Box"}get isBranchLeaf(){return!0}constructor(t){super(t),this.__layout.renderChanged||this.__layout.renderChange()}__updateStrokeSpread(){return 0}__updateRectRenderSpread(){return 0}__updateRenderSpread(){return this.__updateRectRenderSpread()||-1}__updateRectBoxBounds(){}__updateBoxBounds(t){const e=this.__;if(this.children.length)if(e.__autoSide){super.__updateBoxBounds();const{boxBounds:s}=this.__layout;e.__autoSize||(e.__autoWidth?(s.width+=s.x,s.x=0,s.height=e.height,s.y=0):(s.height+=s.y,s.y=0,s.width=e.width,s.x=0)),this.__updateNaturalSize()}else this.__updateRectBoxBounds();else this.__updateRectBoxBounds()}__updateStrokeBounds(){}__updateRenderBounds(){let t;const{renderBounds:e}=this.__layout;this.children.length?(super.__updateRenderBounds(),Y_(ar,e),this.__updateRectRenderBounds(),t=!V_(e,ar),t&&this.__.overflow!=="hide"&&X_(e,ar)):this.__updateRectRenderBounds(),!this.isOverflow!=!t&&(this.isOverflow=t)}__updateRectRenderBounds(){}__updateRectChange(){}__updateChange(){super.__updateChange(),this.__updateRectChange()}__renderRect(t,e){}__renderGroup(t,e){}__render(t,e){this.__.__drawAfterFill?this.__renderRect(t,e):(this.__renderRect(t,e),this.children.length&&this.__renderGroup(t,e))}__drawContent(t,e){this.__renderGroup(t,e),this.__.__hasStroke&&(t.setWorld(this.__nowWorld),this.__drawRenderPath(t))}};p([dt(so)],ot.prototype,"__",void 0);p([vt(!1)],ot.prototype,"resizeChildren",void 0);p([pl("show")],ot.prototype,"overflow",void 0);p([Kt(ti.__updateStrokeSpread)],ot.prototype,"__updateStrokeSpread",null);p([Kt(ti.__updateRenderSpread)],ot.prototype,"__updateRectRenderSpread",null);p([Kt(ti.__updateBoxBounds)],ot.prototype,"__updateRectBoxBounds",null);p([Kt(ti.__updateStrokeBounds)],ot.prototype,"__updateStrokeBounds",null);p([Kt(ti.__updateRenderBounds)],ot.prototype,"__updateRectRenderBounds",null);p([Kt(ti.__updateChange)],ot.prototype,"__updateRectChange",null);p([Kt(ti.__render)],ot.prototype,"__renderRect",null);p([Kt(q_.__render)],ot.prototype,"__renderGroup",null);ot=p([gn(),ft()],ot);let es=class extends ot{get __tag(){return"Frame"}get isFrame(){return!0}constructor(t){super(t)}};p([dt(A_)],es.prototype,"__",void 0);p([ls("#FFFFFF")],es.prototype,"fill",void 0);p([pl("hide")],es.prototype,"overflow",void 0);es=p([ft()],es);const{moveTo:$a,closePath:za,ellipse:ui}=Ze;let Ei=class extends m{get __tag(){return"Ellipse"}constructor(t){super(t)}__updatePath(){const{width:t,height:e,innerRadius:s,startAngle:n,endAngle:r}=this.__,o=t/2,a=e/2,h=this.__.path=[];s?(n||r?(s<1&&ui(h,o,a,o*s,a*s,0,n,r,!1),ui(h,o,a,o,a,0,r,n,!0),s<1&&za(h)):(s<1&&(ui(h,o,a,o*s,a*s),$a(h,t,a)),ui(h,o,a,o,a,0,360,0,!0)),x.ellipseToCurve&&(this.__.path=this.getPath(!0))):n||r?($a(h,o,a),ui(h,o,a,o,a,0,n,r,!1),za(h)):ui(h,o,a,o,a)}};p([dt(D_)],Ei.prototype,"__",void 0);p([bt(0)],Ei.prototype,"innerRadius",void 0);p([bt(0)],Ei.prototype,"startAngle",void 0);p([bt(0)],Ei.prototype,"endAngle",void 0);Ei=p([ft()],Ei);const{moveTo:K_,lineTo:Z_,drawPoints:ja}=Ze,{rotate:Q_,getAngle:J_,getDistance:tp,defaultPoint:Na}=T,{toBounds:ep}=eo;let ne=class extends m{get __tag(){return"Line"}get toPoint(){const{width:t,rotation:e}=this.__,s=Qh();return t&&(s.x=t),e&&Q_(s,e),s}set toPoint(t){this.width=tp(Na,t),this.rotation=J_(Na,t),this.height&&(this.height=0)}constructor(t){super(t)}__updatePath(){const t=this.__,e=t.path=[];t.points?ja(e,t.points,!1,t.closed):(K_(e,0,0),Z_(e,this.width,0))}__updateRenderPath(){const t=this.__;!this.pathInputed&&t.points&&t.curve?(ja(t.__pathForRender=[],t.points,t.curve,t.closed),t.__useArrow&&vl.addArrows(this,!1)):super.__updateRenderPath()}__updateBoxBounds(){this.points?ep(this.__.__pathForRender,this.__layout.boxBounds):super.__updateBoxBounds()}};p([dt(L_)],ne.prototype,"__",void 0);p([pn("center")],ne.prototype,"strokeAlign",void 0);p([D(0)],ne.prototype,"height",void 0);p([bt()],ne.prototype,"points",void 0);p([bt(0)],ne.prototype,"curve",void 0);p([bt(!1)],ne.prototype,"closed",void 0);ne=p([ft()],ne);const{sin:ip,cos:sp,PI:Ha}=Math,{moveTo:np,lineTo:rp,closePath:op,drawPoints:ap}=Ze,bl=ne.prototype;let ve=class extends m{get __tag(){return"Polygon"}constructor(t){super(t)}__updatePath(){const t=this.__.path=[];if(this.__.points)ap(t,this.__.points,!1,!0);else{const{width:e,height:s,sides:n}=this.__,r=e/2,o=s/2;np(t,r,0);for(let a=1;a<n;a++)rp(t,r+r*ip(a*2*Ha/n),o-o*sp(a*2*Ha/n))}op(t)}__updateRenderPath(){}__updateBoxBounds(){}};p([dt(M_)],ve.prototype,"__",void 0);p([bt(3)],ve.prototype,"sides",void 0);p([bt()],ve.prototype,"points",void 0);p([bt(0)],ve.prototype,"curve",void 0);p([Kt(bl.__updateRenderPath)],ve.prototype,"__updateRenderPath",null);p([Kt(bl.__updateBoxBounds)],ve.prototype,"__updateBoxBounds",null);ve=p([gn(),ft()],ve);const{sin:hp,cos:lp,PI:Ga}=Math,{moveTo:cp,lineTo:up,closePath:dp}=Ze;let is=class extends m{get __tag(){return"Star"}constructor(t){super(t)}__updatePath(){const{width:t,height:e,corners:s,innerRadius:n}=this.__,r=t/2,o=e/2,a=this.__.path=[];cp(a,r,0);for(let h=1;h<s*2;h++)up(a,r+(h%2===0?r:r*n)*hp(h*Ga/s),o-(h%2===0?o:o*n)*lp(h*Ga/s));dp(a)}};p([dt(F_)],is.prototype,"__",void 0);p([bt(5)],is.prototype,"corners",void 0);p([bt(.382)],is.prototype,"innerRadius",void 0);is=p([ft()],is);let sn=class extends Ke{get __tag(){return"Image"}get ready(){return this.image?this.image.ready:!1}constructor(t){super(t),this.on(ie.LOADED,e=>{e.attrName==="fill"&&e.attrValue.url===this.url&&(this.image=e.image)})}destroy(){this.image=null,super.destroy()}};p([dt(j_)],sn.prototype,"__",void 0);p([D("")],sn.prototype,"url",void 0);sn=p([ft()],sn);let Me=class extends Ke{get __tag(){return"Canvas"}get ready(){return!this.url}constructor(t){super(t),this.canvas=rt.canvas(this.__),this.context=this.canvas.context,t&&t.url&&this.drawImage(t.url)}drawImage(t){new dl({url:t}).load(e=>{this.context.drawImage(e.view,0,0),this.url=void 0,this.paint(),this.emitEvent(new ie(ie.LOADED,{image:e}))})}draw(t,e,s,n){const r=new De(t.worldTransform).invert(),o=new De;e&&o.translate(e.x,e.y),s&&(typeof s=="number"?o.scale(s):o.scale(s.x,s.y)),n&&o.rotate(n),r.multiplyParent(o),t.__render(this.canvas,{matrix:r.withScale()}),this.paint()}paint(){this.forceRender()}__drawContent(t,e){const{width:s,height:n}=this.__,{view:r}=this.canvas;t.drawImage(r,0,0,r.width,r.height,0,0,s,n)}__updateSize(){const{canvas:t}=this;if(t){const{smooth:e}=this.__;t.smooth!==e&&(t.smooth=e),t.resize(this.__)}}destroy(){this.canvas&&(this.canvas.destroy(),this.canvas=this.context=null),super.destroy()}};p([dt(N_)],Me.prototype,"__",void 0);p([ds(100)],Me.prototype,"width",void 0);p([ds(100)],Me.prototype,"height",void 0);p([ds(1)],Me.prototype,"pixelRatio",void 0);p([ds(!0)],Me.prototype,"smooth",void 0);p([ds()],Me.prototype,"contextSettings",void 0);Me=p([ft()],Me);const{copyAndSpread:fp,includes:_p,isSame:pp,spread:gp,setList:yp}=S;let X=class extends m{get __tag(){return"Text"}get textDrawData(){return this.__layout.update(),this.__.__textDrawData}constructor(t){super(t)}__drawHitPath(t){const{__lineHeight:e,fontSize:s,__baseLine:n,__textDrawData:r}=this.__;t.beginPath(),this.__.__letterSpacing<0?this.__drawPathByData(t):r.rows.forEach(o=>t.rect(o.x,o.y-n,o.width,e<s?s:e))}__drawPathByData(t,e){const{x:s,y:n,width:r,height:o}=this.__layout.boxBounds;t.rect(s,n,r,o)}__drawRenderPath(t){t.font=this.__.__font}__updateTextDrawData(){const t=this.__,{lineHeight:e,letterSpacing:s,fontFamily:n,fontSize:r,fontWeight:o,italic:a,textCase:h,textOverflow:l,padding:c}=t;t.__lineHeight=zr.number(e,r),t.__letterSpacing=zr.number(s,r),t.__padding=c?ct.fourNumber(c):void 0,t.__baseLine=t.__lineHeight-(t.__lineHeight-r*.7)/2,t.__font=`${a?"italic ":""}${h==="small-caps"?"small-caps ":""}${o!=="normal"?o+" ":""}${r}px ${n}`,t.__clipText=l!=="show"&&!t.__autoSize,t.__textDrawData=xl.getDrawData(t.text,this.__)}__updateBoxBounds(){const t=this.__,e=this.__layout,{fontSize:s,italic:n,padding:r,__autoWidth:o,__autoHeight:a}=t;this.__updateTextDrawData();const{bounds:h}=t.__textDrawData,l=e.boxBounds;if(t.__lineHeight<s&&gp(h,s/2),o||a){if(l.x=o?h.x:0,l.y=a?h.y:0,l.width=o?h.width:t.width,l.height=a?h.height:t.height,r){const[d,f,u,_]=t.__padding;o&&(l.x-=_,l.width+=f+_),a&&(l.y-=d,l.height+=u+d)}this.__updateNaturalSize()}else super.__updateBoxBounds();n&&(l.width+=s*.16);const c=_p(l,h)?l:h;pp(c,e.contentBounds)?t.__textBoxBounds=c:(e.contentBounds=c,e.renderChanged=!0,yp(t.__textBoxBounds={},[l,h]))}__updateRenderSpread(){let t=super.__updateRenderSpread();return t||(t=this.__layout.boxBounds===this.__layout.contentBounds?0:1),t}__updateRenderBounds(){fp(this.__layout.renderBounds,this.__.__textBoxBounds,this.__layout.renderSpread)}};p([dt(z_)],X.prototype,"__",void 0);p([D(0)],X.prototype,"width",void 0);p([D(0)],X.prototype,"height",void 0);p([vt(!1)],X.prototype,"resizeFontSize",void 0);p([ls("#000000")],X.prototype,"fill",void 0);p([pn("outside")],X.prototype,"strokeAlign",void 0);p([Qe("all")],X.prototype,"hitFill",void 0);p([D("")],X.prototype,"text",void 0);p([D("L")],X.prototype,"fontFamily",void 0);p([D(12)],X.prototype,"fontSize",void 0);p([D("normal")],X.prototype,"fontWeight",void 0);p([D(!1)],X.prototype,"italic",void 0);p([D("none")],X.prototype,"textCase",void 0);p([D("none")],X.prototype,"textDecoration",void 0);p([D(0)],X.prototype,"letterSpacing",void 0);p([D({type:"percent",value:1.5})],X.prototype,"lineHeight",void 0);p([D(0)],X.prototype,"paraIndent",void 0);p([D(0)],X.prototype,"paraSpacing",void 0);p([D("left")],X.prototype,"textAlign",void 0);p([D("top")],X.prototype,"verticalAlign",void 0);p([D(!0)],X.prototype,"autoSizeAlign",void 0);p([D("normal")],X.prototype,"textWrap",void 0);p([D("show")],X.prototype,"textOverflow",void 0);X=p([ft()],X);let Si=class extends m{get __tag(){return"Path"}constructor(t){super(t)}};p([dt(I_)],Si.prototype,"__",void 0);p([pn("center")],Si.prototype,"strokeAlign",void 0);Si=p([ft()],Si);let nn=class extends qt{get __tag(){return"Pen"}constructor(t){super(t)}setStyle(t){const e=this.pathElement=new Si(t);return this.pathStyle=t,this.__path=e.path||(e.path=[]),this.add(e),this}beginPath(){return this}moveTo(t,e){return this}lineTo(t,e){return this}bezierCurveTo(t,e,s,n,r,o){return this}quadraticCurveTo(t,e,s,n){return this}closePath(){return this}rect(t,e,s,n){return this}roundRect(t,e,s,n,r){return this}ellipse(t,e,s,n,r,o,a,h){return this}arc(t,e,s,n,r,o){return this}arcTo(t,e,s,n,r){return this}drawEllipse(t,e,s,n,r,o,a,h){return this}drawArc(t,e,s,n,r,o){return this}drawPoints(t,e,s){return this}clearPath(){return this}paint(){this.pathElement.__layout.boxChanged||this.pathElement.forceUpdate("path")}};p([dt(W_)],nn.prototype,"__",void 0);p([mp()],nn.prototype,"path",void 0);nn=p([Ft(to,["set","path","paint"]),ft()],nn);function mp(){return(i,t)=>{Pi(i,t,{get(){return this.__path}})}}function Ce(i,t,e,s){var n=arguments.length,r=n<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,e):s,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(i,t,e,s);else for(var a=i.length-1;a>=0;a--)(o=i[a])&&(r=(n<3?o(r):n>3?o(t,e,r):o(t,e))||r);return n>3&&r&&Object.defineProperty(t,e,r),r}let Ua=class extends xe{get __tag(){return"App"}get isApp(){return!0}constructor(t,e){super(t,e)}init(t,e){if(super.init(t,e),t){const{ground:s,tree:n,sky:r,editor:o}=t;s&&(this.ground=this.addLeafer(s)),(n||o)&&(this.tree=this.addLeafer(n)),(r||o)&&(this.sky=this.addLeafer(r||{type:"draw",usePartRender:!1})),o&&this.sky.add(this.editor=rt.editor(o))}}__setApp(){const{canvas:t}=this,{realCanvas:e,view:s}=this.config;e||s===this.canvas.view||!t.parentView?this.realCanvas=!0:t.unrealCanvas(),this.leafer=this,this.watcher.disable(),this.layouter.disable(),this.__eventIds.push(this.on_(ye.CHANGE,this.__onPropertyChange,this))}start(){super.start(),this.children.forEach(t=>t.start())}stop(){this.children.forEach(t=>t.stop()),super.stop()}unlockLayout(){super.unlockLayout(),this.children.forEach(t=>t.unlockLayout())}lockLayout(){super.lockLayout(),this.children.forEach(t=>t.lockLayout())}forceRender(t){this.children.forEach(e=>e.forceRender(t))}addLeafer(t){const e=new xe(t);return this.add(e),e}add(t,e){if(!t.view){if(this.realCanvas&&!this.canvas.bounds){setTimeout(()=>this.add(t,e),10);return}t.init(this.__getChildConfig(t.userConfig),this)}super.add(t,e),e!==void 0&&(t.canvas.childIndex=e),this.__listenChildEvents(t)}__onPropertyChange(){N.showHitView&&this.children.forEach(t=>t.forceUpdate("surface"))}__onCreated(){this.created=this.children.every(t=>t.created)}__onReady(){this.children.every(t=>t.ready)&&super.__onReady()}__onViewReady(){this.children.every(t=>t.viewReady)&&super.__onViewReady()}__onChildRenderEnd(t){this.renderer.addBlock(t.renderBounds),this.viewReady&&this.renderer.update()}__render(t,e){if(t.context){const s=e.matrix;s&&t.setTransform(s.a,s.b,s.c,s.d,s.e,s.f),this.children.forEach(n=>t.copyWorld(n.canvas))}}__onResize(t){this.children.forEach(e=>e.resize(t)),super.__onResize(t)}__checkUpdateLayout(){this.children.forEach(t=>t.__layout.update())}__getChildConfig(t){let e=Object.assign({},this.config);return e.hittable=e.realCanvas=void 0,t&&lt.assign(e,t),this.autoLayout&&lt.copyAttrs(e,this,Gt),e.view=this.realCanvas?void 0:this.view,e.fill=void 0,e}__listenChildEvents(t){t.once(G.END,()=>this.__onReady()),t.once(Y.START,()=>this.__onCreated()),t.once(Y.END,()=>this.__onViewReady()),this.realCanvas&&this.__eventIds.push(t.on_(Y.END,this.__onChildRenderEnd,this))}};Ua=Ce([ft()],Ua);const As={},Zi={isHoldSpaceKey(){return Zi.isHold("Space")},isHold(i){return As[i]},setDownCode(i){As[i]||(As[i]=!0)},setUpCode(i){As[i]=!1}},Ht={LEFT:1,RIGHT:2,MIDDLE:4,defaultLeft(i){i.buttons||(i.buttons=1)},left(i){return i.buttons===1},right(i){return i.buttons===2},middle(i){return i.buttons===4}};class wn extends be{get spaceKey(){return Zi.isHoldSpaceKey()}get left(){return Ht.left(this)}get right(){return Ht.right(this)}get middle(){return Ht.middle(this)}constructor(t){super(t.type),this.bubbles=!0,Object.assign(this,t)}getBoxPoint(t){return(t||this.current).getBoxPoint(this)}getInnerPoint(t){return(t||this.current).getInnerPoint(this)}getLocalPoint(t){return(t||this.current).getLocalPoint(this)}getPagePoint(){return this.current.getPagePoint(this)}getInner(t){return this.getInnerPoint(t)}getLocal(t){return this.getLocalPoint(t)}getPage(){return this.getPagePoint()}static changeName(t,e){Bi.changeName(t,e)}}let C=class extends wn{};C.POINTER="pointer";C.BEFORE_DOWN="pointer.before_down";C.BEFORE_MOVE="pointer.before_move";C.BEFORE_UP="pointer.before_up";C.DOWN="pointer.down";C.MOVE="pointer.move";C.UP="pointer.up";C.OVER="pointer.over";C.OUT="pointer.out";C.ENTER="pointer.enter";C.LEAVE="pointer.leave";C.TAP="tap";C.DOUBLE_TAP="double_tap";C.CLICK="click";C.DOUBLE_CLICK="double_click";C.LONG_PRESS="long_press";C.LONG_TAP="long_tap";C.MENU="pointer.menu";C.MENU_TAP="pointer.menu_tap";C=Ce([Fe()],C);const zi={};let W=class extends C{static setList(t){this.list=t instanceof nt?t:new nt(t)}static setData(t){this.data=t}static getValidMove(t,e,s){const{draggable:n,dragBounds:r}=t,o=t.getLocalPoint(s,null,!0);return T.move(o,e.x-t.x,e.y-t.y),r&&this.getMoveInDragBounds(t.__local,r==="parent"?t.parent.boxBounds:r,o,!0),n==="x"&&(o.y=0),n==="y"&&(o.x=0),o}static getMoveInDragBounds(t,e,s,n){const r=t.x+s.x,o=t.y+s.y,a=r+t.width,h=o+t.height,l=e.x+e.width,c=e.y+e.height;return n||(s=Object.assign({},s)),S.includes(t,e)?(r>e.x?s.x+=e.x-r:a<l&&(s.x+=l-a),o>e.y?s.y+=e.y-o:h<c&&(s.y+=c-h)):(r<e.x?s.x+=e.x-r:a>l&&(s.x+=l-a),o<e.y?s.y+=e.y-o:h>c&&(s.y+=c-h)),s}getPageMove(t){return this.assignMove(t),this.current.getPagePoint(zi,null,!0)}getInnerMove(t,e){return t||(t=this.current),this.assignMove(e),t.getInnerPoint(zi,null,!0)}getLocalMove(t,e){return t||(t=this.current),this.assignMove(e),t.getLocalPoint(zi,null,!0)}getPageTotal(){return this.getPageMove(!0)}getInnerTotal(t){return this.getInnerMove(t,!0)}getLocalTotal(t){return this.getLocalMove(t,!0)}getPageBounds(){const t=this.getPageTotal(),e=this.getPagePoint(),s={};return S.set(s,e.x-t.x,e.y-t.y,t.x,t.y),S.unsign(s),s}assignMove(t){zi.x=t?this.totalX:this.moveX,zi.y=t?this.totalY:this.moveY}};W.BEFORE_DRAG="drag.before_drag";W.START="drag.start";W.DRAG="drag";W.END="drag.end";W.OVER="drag.over";W.OUT="drag.out";W.ENTER="drag.enter";W.LEAVE="drag.leave";W=Ce([Fe()],W);let ss=class extends C{static setList(t){W.setList(t)}static setData(t){W.setData(t)}};ss.DROP="drop";ss=Ce([Fe()],ss);let wt=class extends W{};wt.BEFORE_MOVE="move.before_move";wt.START="move.start";wt.MOVE="move";wt.END="move.end";wt=Ce([Fe()],wt);let ee=class extends wn{};ee.BEFORE_ROTATE="rotate.before_rotate";ee.START="rotate.start";ee.ROTATE="rotate";ee.END="rotate.end";ee=Ce([Fe()],ee);let Yt=class extends W{};Yt.SWIPE="swipe";Yt.LEFT="swipe.left";Yt.RIGHT="swipe.right";Yt.UP="swipe.up";Yt.DOWN="swipe.down";Yt=Ce([Fe()],Yt);let Xt=class extends wn{};Xt.BEFORE_ZOOM="zoom.before_zoom";Xt.START="zoom.start";Xt.ZOOM="zoom";Xt.END="zoom.end";Xt=Ce([Fe()],Xt);let Le=class extends wn{};Le.DOWN="key.down";Le.HOLD="key.hold";Le.UP="key.up";Le=Ce([Fe()],Le);function Bl(i){i.isApp||i.__eventIds.push(i.on_(wt.BEFORE_MOVE,t=>{i.zoomLayer.move(i.getValidMove(t.moveX,t.moveY))}),i.on_(Xt.BEFORE_ZOOM,t=>{const{zoomLayer:e}=i,s=i.getValidScale(t.scale);s!==1&&(T.scaleOf(e,t,s),e.scale=e.__.scaleX*s)}))}function wp(i){Bl(i);const{move:t,zoom:e}=i.config;t.scroll="limit",e.min=1}function xp(i){const{config:t}=i;(t.wheel||(t.wheel={})).preventDefault=!1,(t.touch||(t.touch={})).preventDefault="auto"}const vp=N.get("LeaferTypeCreator"),Cl={list:{},register(i,t){hr[i]&&vp.repeat(i),hr[i]=t},run(i,t){const e=hr[i];e&&e(t)}},{list:hr,register:ro}=Cl;ro("design",Bl);ro("document",wp);ro("block",xp);const oo=xe.prototype;oo.initType=function(i){Cl.run(i,this)};oo.getValidMove=function(i,t){const{scroll:e,disabled:s}=this.app.config.move;if(e&&(Math.abs(i)>Math.abs(t)?t=0:i=0,e==="limit")){const{x:n,y:r,width:o,height:a}=new J(this.__world).addPoint(this.zoomLayer),h=n+o-this.width,l=r+a-this.height;n>=0&&h<=0?i=0:i>0?n+i>0&&(i=-n):i<0&&h+i<0&&(i=-h),r>=0&&l<=0?t=0:t>0?r+t>0&&(t=-r):t<0&&l+t<0&&(t=-l)}return{x:s?0:i,y:s?0:t}};oo.getValidScale=function(i){const{scaleX:t}=this.zoomLayer.__,{min:e,max:s,disabled:n}=this.app.config.zoom,r=Math.abs(t*i);return r<e?i=e/t:r>s&&(i=s/t),n?1:i};class bp{get transforming(){return!!(this.moveData||this.zoomData||this.rotateData)}constructor(t){this.interaction=t}move(t){const{interaction:e}=this;if(t.moveType||(t.moveType="move"),!this.moveData){const{path:s}=e.selector.getByPoint(t,e.hitRadius);t.path=s,this.moveData=Object.assign(Object.assign({},t),{moveX:0,moveY:0}),e.cancelHover(),e.emit(wt.START,this.moveData)}t.path=this.moveData.path,e.emit(wt.BEFORE_MOVE,t),e.emit(wt.MOVE,t),this.transformEndWait()}zoom(t){const{interaction:e}=this;if(!this.zoomData){const{path:s}=e.selector.getByPoint(t,e.hitRadius);t.path=s,this.zoomData=Object.assign(Object.assign({},t),{scale:1}),e.cancelHover(),e.emit(Xt.START,this.zoomData)}t.path=this.zoomData.path,e.emit(Xt.BEFORE_ZOOM,t),e.emit(Xt.ZOOM,t),this.transformEndWait()}rotate(t){const{interaction:e}=this;if(!this.rotateData){const{path:s}=e.selector.getByPoint(t,e.hitRadius);t.path=s,this.rotateData=Object.assign(Object.assign({},t),{rotation:0}),e.cancelHover(),e.emit(ee.START,this.rotateData)}t.path=this.rotateData.path,e.emit(ee.BEFORE_ROTATE,t),e.emit(ee.ROTATE,t),this.transformEndWait()}transformEndWait(){clearTimeout(this.transformTimer),this.transformTimer=setTimeout(()=>{this.transformEnd()},this.interaction.config.pointer.transformTime)}transformEnd(){this.moveEnd(),this.zoomEnd(),this.rotateEnd()}moveEnd(){this.moveData&&(this.interaction.emit(wt.END,this.moveData),this.moveData=null)}zoomEnd(){this.zoomData&&(this.interaction.emit(Xt.END,this.zoomData),this.zoomData=null)}rotateEnd(){this.rotateData&&(this.interaction.emit(ee.END,this.rotateData),this.rotateData=null)}destroy(){this.zoomData=this.moveData=this.rotateData=null}}const Vt={getMoveEventData(i,t,e){return Object.assign(Object.assign({},e),{x:i.x,y:i.y,moveX:t.x,moveY:t.y})},getRotateEventData(i,t,e){return Object.assign(Object.assign({},e),{x:i.x,y:i.y,rotation:t})},getZoomEventData(i,t,e){return Object.assign(Object.assign({},e),{x:i.x,y:i.y,scale:t})},getDragEventData(i,t,e){return Object.assign(Object.assign({},e),{x:e.x,y:e.y,moveX:e.x-t.x,moveY:e.y-t.y,totalX:e.x-i.x,totalY:e.y-i.y})},getDropEventData(i,t,e){return Object.assign(Object.assign({},i),{list:t,data:e})},getSwipeDirection(i){return i<-45&&i>-135?Yt.UP:i>45&&i<135?Yt.DOWN:i<=45&&i>=-45?Yt.RIGHT:Yt.LEFT},getSwipeEventData(i,t,e){return Object.assign(Object.assign({},e),{moveX:t.moveX,moveY:t.moveY,totalX:e.x-i.x,totalY:e.y-i.y,type:Bp.getSwipeDirection(T.getAngle(i,e))})},getBase(i){const t=i.button===1?4:i.button;return{altKey:i.altKey,ctrlKey:i.ctrlKey,shiftKey:i.shiftKey,metaKey:i.metaKey,buttons:i.buttons===void 0?1:i.buttons===0?t:i.buttons,origin:i}},pathHasEventType(i,t){const{list:e}=i;for(let s=0,n=e.length;s<n;s++)if(e[s].hasEvent(t))return!0;return!1},filterPathByEventType(i,t){const e=new nt,{list:s}=i;for(let n=0,r=s.length;n<r;n++)s[n].hasEvent(t)&&e.add(s[n]);return e},pathCanDrag(i){return i&&i.list.some(t=>t.draggable||t.editable||!t.isLeafer&&t.hasEvent(W.DRAG))},pathHasOutside(i){return i&&i.list.some(t=>t.isOutside)}},Bp=Vt,Ya=new nt,{getDragEventData:lr,getDropEventData:Cp,getSwipeEventData:Ep}=Vt;class Sp{constructor(t){this.interaction=t}setDragData(t){this.animateWait&&this.dragEndReal(),this.downData=this.interaction.downData,this.dragData=lr(t,t,t),this.canAnimate=this.canDragOut=!0}getList(t,e){const{proxy:s}=this.interaction.selector,n=s&&s.list.length,r=W.list||this.draggableList||Ya;return this.dragging&&(n?t?Ya:new nt(e?[...s.list,...s.dragHoverExclude]:s.list):r)}checkDrag(t,e){const{interaction:s}=this;if(this.moving&&t.buttons<1){this.canAnimate=!1,s.pointerCancel();return}!this.moving&&e&&(this.moving=s.canMove(this.downData)||s.isHoldRightKey||s.isMobileDragEmpty)&&(this.dragData.moveType="drag",s.emit(wt.START,this.dragData)),this.moving||this.dragStart(t,e),this.drag(t)}dragStart(t,e){this.dragging||(this.dragging=e&&Ht.left(t),this.dragging&&(this.interaction.emit(W.START,this.dragData),this.getDraggableList(this.dragData.path),this.setDragStartPoints(this.realDraggableList=this.getList(!0))))}setDragStartPoints(t){this.dragStartPoints={},t.forEach(e=>this.dragStartPoints[e.innerId]={x:e.x,y:e.y})}getDraggableList(t){let e;for(let s=0,n=t.length;s<n;s++)if(e=t.list[s],(e.draggable||e.editable)&&e.hitSelf&&!e.locked){this.draggableList=new nt(e);break}}drag(t){const{interaction:e,dragData:s,downData:n}=this,{path:r,throughPath:o}=n;this.dragData=lr(n,s,t),o&&(this.dragData.throughPath=o),this.dragData.path=r,this.moving?(this.dragData.moveType="drag",e.emit(wt.BEFORE_MOVE,this.dragData),e.emit(wt.MOVE,this.dragData)):this.dragging&&(this.dragReal(),e.emit(W.BEFORE_DRAG,this.dragData),e.emit(W.DRAG,this.dragData))}dragReal(){const{running:t}=this.interaction,e=this.realDraggableList;if(e.length&&t){const{totalX:s,totalY:n}=this.dragData;e.forEach(r=>r.draggable&&r.move(W.getValidMove(r,this.dragStartPoints[r.innerId],{x:s,y:n})))}}dragOverOrOut(t){const{interaction:e}=this,{dragOverPath:s}=this,{path:n}=t;this.dragOverPath=n,s?n.indexAt(0)!==s.indexAt(0)&&(e.emit(W.OUT,t,s),e.emit(W.OVER,t,n)):e.emit(W.OVER,t,n)}dragEnterOrLeave(t){const{interaction:e}=this,{dragEnterPath:s}=this,{path:n}=t;e.emit(W.LEAVE,t,s,n),e.emit(W.ENTER,t,n,s),this.dragEnterPath=n}dragEnd(t,e){if(!this.dragging&&!this.moving)return;const{moveX:s,moveY:n}=this.dragData;this.interaction.config.move.dragAnimate&&this.canAnimate&&this.moving&&(Math.abs(s)>1||Math.abs(n)>1)?(t=Object.assign({},t),e=(e||(t.pointerType==="touch"?2:1))*.9,T.move(t,s*e,n*e),this.drag(t),this.animate(()=>{this.dragEnd(t,1)})):this.dragEndReal(t)}dragEndReal(t){const{interaction:e,downData:s,dragData:n}=this;t||(t=n);const{path:r,throughPath:o}=s,a=lr(s,t,t);if(o&&(a.throughPath=o),a.path=r,this.moving&&(this.moving=!1,a.moveType="drag",e.emit(wt.END,a)),this.dragging){const h=this.getList();this.dragging=!1,e.emit(W.END,a),this.swipe(t,s,n,a),this.drop(t,h,this.dragEnterPath)}this.autoMoveCancel(),this.dragReset(),this.animate(null,"off")}animate(t,e){const s=t||this.animateWait;s&&this.interaction.target.nextRender(s,null,e),this.animateWait=t}swipe(t,e,s,n){const{interaction:r}=this;if(T.getDistance(e,t)>r.config.pointer.swipeDistance){const o=Ep(e,s,n);this.interaction.emit(o.type,o)}}drop(t,e,s){const n=Cp(t,e,W.data);n.path=s,this.interaction.emit(ss.DROP,n),this.interaction.emit(W.LEAVE,t,s)}dragReset(){W.list=W.data=this.draggableList=this.dragData=this.downData=this.dragOverPath=this.dragEnterPath=null}checkDragOut(t){const{interaction:e}=this;this.autoMoveCancel(),this.dragging&&!e.shrinkCanvasBounds.hitPoint(t)&&this.autoMoveOnDragOut(t)}autoMoveOnDragOut(t){const{interaction:e,downData:s,canDragOut:n}=this,{autoDistance:r,dragOut:o}=e.config.move;if(!o||!n||!r)return;const a=e.shrinkCanvasBounds,{x:h,y:l}=a,c=S.maxX(a),d=S.maxY(a),f=t.x<h?r:c<t.x?-r:0,u=t.y<l?r:d<t.y?-r:0;let _=0,y=0;this.autoMoveTimer=setInterval(()=>{_+=f,y+=u,T.move(s,f,u),T.move(this.dragData,f,u),e.move(Object.assign(Object.assign({},t),{moveX:f,moveY:u,totalX:_,totalY:y,moveType:"drag"})),e.pointerMoveReal(t)},10)}autoMoveCancel(){this.autoMoveTimer&&(clearInterval(this.autoMoveTimer),this.autoMoveTimer=0)}destroy(){this.dragReset()}}const Rp=N.get("emit");function Tp(i,t,e,s){if(!e&&!t.path)return;let n;t.type=i,e?t=Object.assign(Object.assign({},t),{path:e}):e=t.path,t.target=e.indexAt(0);try{for(let r=e.length-1;r>-1;r--){if(n=e.list[r],Hr(n,i,t,!0,s))return;n.isApp&&Xa(n,i,t,!0,s)}for(let r=0,o=e.length;r<o;r++)if(n=e.list[r],n.isApp&&Xa(n,i,t,!1,s),Hr(n,i,t,!1,s))return}catch(r){Rp.error(r)}}const kp=["move","zoom","rotate","key"];function Xa(i,t,e,s,n){if(kp.some(r=>t.startsWith(r))&&i.__.hitChildren&&!El(i,n)){let r;for(let o=0,a=i.children.length;o<a;o++)r=i.children[o],!e.path.has(r)&&r.__.hittable&&Hr(r,t,e,s,n)}}function Hr(i,t,e,s,n){if(i.destroyed)return!1;if(i.__.hitSelf&&!El(i,n)&&($.updateEventStyle&&!s&&$.updateEventStyle(i,t),i.hasEvent(t,s))){e.phase=s?1:i===e.target?2:3;const r=Bi.get(t,e);if(i.emitEvent(r,s),r.isStop)return!0}return!1}function El(i,t){return t&&t.has(i)}const Pp={getData(i){const t=i[0],e=i[1],s=T.getCenter(t.from,e.from),n=T.getCenter(t.to,e.to),r={x:n.x-s.x,y:n.y-s.y},o=T.getDistance(t.from,e.from),h=T.getDistance(t.to,e.to)/o,l=T.getRotation(t.from,e.from,t.to,e.to);return{move:r,scale:h,angle:l,center:n}}},Op={wheel:{zoomSpeed:.5,moveSpeed:.5,rotateSpeed:.5,delta:{x:80/4,y:8},preventDefault:!0},pointer:{hitRadius:5,tapTime:120,longPressTime:800,transformTime:500,hover:!0,dragHover:!0,dragDistance:2,swipeDistance:20,preventDefaultMenu:!0},touch:{preventDefault:!0},multiTouch:{},cursor:!0,keyEvent:!0},{pathHasEventType:cr,getMoveEventData:Ap,getZoomEventData:Lp,getRotateEventData:Dp,pathCanDrag:Mp,pathHasOutside:Va}=Vt;class Fp{get dragging(){return this.dragger.dragging}get transforming(){return this.transformer.transforming}get moveMode(){return this.m.drag===!0||this.isHoldSpaceKey||this.isHoldMiddleKey||this.isHoldRightKey&&this.dragger.moving||this.isDragEmpty}get canHover(){return this.p.hover&&!this.config.mobile}get isDragEmpty(){return this.m.dragEmpty&&this.isRootPath(this.hoverData)&&(!this.downData||this.isRootPath(this.downData))}get isMobileDragEmpty(){return this.m.dragEmpty&&!this.canHover&&this.downData&&this.isTreePath(this.downData)}get isHoldMiddleKey(){return this.m.holdMiddleKey&&this.downData&&Ht.middle(this.downData)}get isHoldRightKey(){return this.m.holdRightKey&&this.downData&&Ht.right(this.downData)}get isHoldSpaceKey(){return this.m.holdSpaceKey&&Zi.isHoldSpaceKey()}get m(){return this.config.move}get p(){return this.config.pointer}get hitRadius(){return this.p.hitRadius}constructor(t,e,s,n){this.config=lt.clone(Op),this.tapCount=0,this.downKeyMap={},this.target=t,this.canvas=e,this.selector=s,this.defaultPath=new nt(t),this.transformer=new bp(this),this.dragger=new Sp(this),n&&(this.config=lt.default(n,this.config)),this.__listenEvents()}start(){this.running=!0}stop(){this.running=!1}receive(t){}pointerDown(t,e){t||(t=this.hoverData),t&&(Ht.defaultLeft(t),this.updateDownData(t),this.checkPath(t,e),this.downTime=Date.now(),this.emit(C.BEFORE_DOWN,t),this.emit(C.DOWN,t),Ht.left(t)&&(this.tapWait(),this.longPressWait(t)),this.waitRightTap=Ht.right(t),this.dragger.setDragData(t),this.isHoldRightKey||this.updateCursor(t))}pointerMove(t){if(t||(t=this.hoverData),!t)return;const{downData:e}=this;e&&Ht.defaultLeft(t),(this.canvas.bounds.hitPoint(t)||e)&&(this.pointerMoveReal(t),e&&this.dragger.checkDragOut(t))}pointerMoveReal(t){const{dragHover:e,dragDistance:s}=this.p;if(this.emit(C.BEFORE_MOVE,t,this.defaultPath),this.downData){const n=T.getDistance(this.downData,t)>s;n&&(this.waitTap&&this.pointerWaitCancel(),this.waitRightTap=!1),this.dragger.checkDrag(t,n)}this.dragger.moving||(this.updateHoverData(t),this.checkPath(t),this.emit(C.MOVE,t),this.dragging&&!e||this.pointerHover(t),this.dragger.dragging&&(this.dragger.dragOverOrOut(t),this.dragger.dragEnterOrLeave(t))),this.updateCursor(this.downData||t)}pointerUp(t){const{downData:e}=this;if(t||(t=e),!e)return;Ht.defaultLeft(t),t.multiTouch=e.multiTouch,this.findPath(t);const s=Object.assign(Object.assign({},t),{path:t.path.clone()});t.path.addList(e.path.list),this.checkPath(t),this.downData=null,this.emit(C.BEFORE_UP,t),this.emit(C.UP,t),this.touchLeave(t),t.isCancel||(this.tap(t),this.menuTap(t)),this.dragger.dragEnd(t),this.updateCursor(s)}pointerCancel(){const t=Object.assign({},this.dragger.dragData);t.isCancel=!0,this.pointerUp(t)}multiTouch(t,e){if(this.config.multiTouch.disabled)return;const{move:s,angle:n,scale:r,center:o}=Pp.getData(e);this.rotate(Dp(o,n,t)),this.zoom(Lp(o,r,t)),this.move(Ap(o,s,t))}menu(t){this.findPath(t),this.emit(C.MENU,t),this.waitMenuTap=!0,!this.downData&&this.waitRightTap&&this.menuTap(t)}menuTap(t){this.waitRightTap&&this.waitMenuTap&&(this.emit(C.MENU_TAP,t),this.waitRightTap=this.waitMenuTap=!1)}move(t){this.transformer.move(t)}zoom(t){this.transformer.zoom(t)}rotate(t){this.transformer.rotate(t)}transformEnd(){this.transformer.transformEnd()}keyDown(t){if(!this.config.keyEvent)return;const{code:e}=t;this.downKeyMap[e]||(this.downKeyMap[e]=!0,Zi.setDownCode(e),this.emit(Le.HOLD,t,this.defaultPath),this.moveMode&&(this.cancelHover(),this.updateCursor())),this.emit(Le.DOWN,t,this.defaultPath)}keyUp(t){if(!this.config.keyEvent)return;const{code:e}=t;this.downKeyMap[e]=!1,Zi.setUpCode(e),this.emit(Le.UP,t,this.defaultPath),this.cursor==="grab"&&this.updateCursor()}pointerHover(t){this.canHover&&(this.pointerOverOrOut(t),this.pointerEnterOrLeave(t))}pointerOverOrOut(t){const{path:e}=t,{overPath:s}=this;this.overPath=e,s?e.indexAt(0)!==s.indexAt(0)&&(this.emit(C.OUT,t,s),this.emit(C.OVER,t,e)):this.emit(C.OVER,t,e)}pointerEnterOrLeave(t){let{path:e}=t;this.downData&&!this.moveMode&&(e=e.clone(),this.downData.path.forEach(n=>e.add(n)));const{enterPath:s}=this;this.enterPath=e,this.emit(C.LEAVE,t,s,e),this.emit(C.ENTER,t,e,s)}touchLeave(t){t.pointerType==="touch"&&this.enterPath&&(this.emit(C.LEAVE,t),this.dragger.dragging&&this.emit(ss.LEAVE,t))}tap(t){const{pointer:e}=this.config,s=this.longTap(t);if(!e.tapMore&&s||!this.waitTap)return;e.tapMore&&this.emitTap(t);const n=Date.now()-this.downTime,r=[C.DOUBLE_TAP,C.DOUBLE_CLICK].some(o=>cr(t.path,o));n<e.tapTime+50&&r?(this.tapCount++,this.tapCount===2?(this.tapWaitCancel(),this.emitDoubleTap(t)):(clearTimeout(this.tapTimer),this.tapTimer=setTimeout(()=>{e.tapMore||(this.tapWaitCancel(),this.emitTap(t))},e.tapTime))):e.tapMore||(this.tapWaitCancel(),this.emitTap(t))}findPath(t,e){const{hitRadius:s,through:n}=this.p,{bottomList:r}=this,o=this.selector.getByPoint(t,s,Object.assign({bottomList:r,name:t.type},e||{through:n}));return o.throughPath&&(t.throughPath=o.throughPath),t.path=o.path,o.path}isRootPath(t){return t&&t.path.list[0].isLeafer}isTreePath(t){const e=this.target.app;return!e||!e.isApp?!1:e.editor&&!t.path.has(e.editor)&&t.path.has(e.tree)&&!t.target.syncEventer}checkPath(t,e){(e||this.moveMode&&!Va(t.path))&&(t.path=this.defaultPath)}canMove(t){return t&&(this.moveMode||this.m.drag==="auto"&&!Mp(t.path))&&!Va(t.path)}isDrag(t){return this.dragger.getList().has(t)}isPress(t){return this.downData&&this.downData.path.has(t)}isHover(t){return this.enterPath&&this.enterPath.has(t)}isFocus(t){return this.focusData===t}cancelHover(){const{hoverData:t}=this;t&&(t.path=this.defaultPath,this.pointerHover(t))}updateDownData(t,e,s){const{downData:n}=this;!t&&n&&(t=n),t&&(this.findPath(t,e),s&&n&&t.path.addList(n.path.list),this.downData=t)}updateHoverData(t){t||(t=this.hoverData),t&&(this.findPath(t,{exclude:this.dragger.getList(!1,!0),name:C.MOVE}),this.hoverData=t)}updateCursor(t){if(!this.config.cursor||!this.canHover)return;if(t||(this.updateHoverData(),t=this.downData||this.hoverData),this.dragger.moving)return this.setCursor("grabbing");if(this.canMove(t))return this.setCursor(this.downData?"grabbing":"grab");if(!t)return;let e,s;const{path:n}=t;for(let r=0,o=n.length;r<o&&(e=n.list[r],s=e.syncEventer&&e.syncEventer.cursor||e.cursor,!s);r++);this.setCursor(s)}setCursor(t){this.cursor=t}getLocal(t,e){const s=this.canvas.getClientBounds(e);return{x:t.clientX-s.x,y:t.clientY-s.y}}emitTap(t){this.emit(C.TAP,t),this.emit(C.CLICK,t)}emitDoubleTap(t){this.emit(C.DOUBLE_TAP,t),this.emit(C.DOUBLE_CLICK,t)}pointerWaitCancel(){this.tapWaitCancel(),this.longPressWaitCancel()}tapWait(){clearTimeout(this.tapTimer),this.waitTap=!0}tapWaitCancel(){clearTimeout(this.tapTimer),this.waitTap=!1,this.tapCount=0}longPressWait(t){clearTimeout(this.longPressTimer),this.longPressTimer=setTimeout(()=>{this.longPressed=!0,this.emit(C.LONG_PRESS,t)},this.p.longPressTime)}longTap(t){let e;return this.longPressed&&(this.emit(C.LONG_TAP,t),(cr(t.path,C.LONG_TAP)||cr(t.path,C.LONG_PRESS))&&(e=!0)),this.longPressWaitCancel(),e}longPressWaitCancel(){clearTimeout(this.longPressTimer),this.longPressed=!1}__onResize(){this.shrinkCanvasBounds=new J(this.canvas.bounds),this.shrinkCanvasBounds.spread(-2)}__listenEvents(){const{target:t}=this;this.__eventIds=[t.on_(Je.RESIZE,this.__onResize,this)],t.once(it.READY,()=>this.__onResize())}__removeListenEvents(){this.target.off_(this.__eventIds),this.__eventIds.length=0}emit(t,e,s,n){this.running&&Tp(t,e,s,n)}destroy(){this.__eventIds.length&&(this.stop(),this.__removeListenEvents(),this.dragger.destroy(),this.transformer.destroy(),this.downData=this.overPath=this.enterPath=null)}}class Sl{static set(t,e){this.custom[t]=e}static get(t){return this.custom[t]}}Sl.custom={};class Ip extends el{constructor(){super(...arguments),this.maxTotal=1e3,this.pathList=new nt,this.pixelList=new nt}getPixelType(t,e){return this.__autoClear(),this.pixelList.add(t),rt.hitCanvas(e)}getPathType(t){return this.__autoClear(),this.pathList.add(t),rt.hitCanvas()}clearImageType(){this.__clearLeafList(this.pixelList)}clearPathType(){this.__clearLeafList(this.pathList)}__clearLeafList(t){t.length&&(t.forEach(e=>{e.__hitCanvas&&(e.__hitCanvas.destroy(),e.__hitCanvas=null)}),t.reset())}__autoClear(){this.pathList.length+this.pixelList.length>this.maxTotal&&this.clear()}clear(){this.clearPathType(),this.clearImageType()}}const{toInnerRadiusPointOf:Wp,copy:$p,setRadius:zp}=T,ji={},fs=Ve.prototype;fs.__hitWorld=function(i){if(!this.__.hitSelf)return!1;this.__.hitRadius&&($p(ji,i),i=ji,zp(i,this.__.hitRadius)),Wp(i,this.__world,ji);const{width:t,height:e}=this.__world,s=t<10&&e<10;if(this.__.hitBox||s){if(S.hitRadiusPoint(this.__layout.boxBounds,ji))return!0;if(s)return!1}return(this.__layout.hitCanvasChanged||!this.__hitCanvas)&&(this.__updateHitCanvas(),this.__layout.boundsChanged||(this.__layout.hitCanvasChanged=!1)),this.__hit(ji)};fs.__hitFill=function(i){var t;return(t=this.__hitCanvas)===null||t===void 0?void 0:t.hitFill(i,this.__.windingRule)};fs.__hitStroke=function(i,t){var e;return(e=this.__hitCanvas)===null||e===void 0?void 0:e.hitStroke(i,t)};fs.__hitPixel=function(i){var t;return(t=this.__hitCanvas)===null||t===void 0?void 0:t.hitPixel(i,this.__layout.renderBounds,this.__hitCanvas.hitScale)};fs.__drawHitPath=function(i){i&&this.__drawRenderPath(i)};const jp=new De,Rl=m.prototype;Rl.__updateHitCanvas=function(){const i=this.__,{hitCanvasManager:t}=this.leafer,e=(i.__pixelFill||i.__isCanvas)&&i.hitFill==="pixel",s=i.__pixelStroke&&i.hitStroke==="pixel",n=e||s;this.__hitCanvas||(this.__hitCanvas=n?t.getPixelType(this,{contextSettings:{willReadFrequently:!0}}):t.getPathType(this));const r=this.__hitCanvas;if(n){const{renderBounds:o}=this.__layout,a=x.image.hitCanvasSize,h=r.hitScale=M.set(0,0,a,a).getFitMatrix(o).a,{x:l,y:c,width:d,height:f}=M.set(o).scale(h);r.resize({width:d,height:f,pixelRatio:1}),r.clear(),St.patternLocked=!0,this.__renderShape(r,{matrix:jp.setWith(this.__world).scaleWith(1/h).invertWith().translate(-l,-c)},!e,!s),St.patternLocked=!1,r.resetTransform(),i.__isHitPixel=!0}else i.__isHitPixel&&(i.__isHitPixel=!1);this.__drawHitPath(r),r.setStrokeOptions(i)};Rl.__hit=function(i){x.name==="miniapp"&&this.__drawHitPath(this.__hitCanvas);const t=this.__;if(t.__isHitPixel&&this.__hitPixel(i))return!0;const{hitFill:e}=t,s=(t.fill||t.__isCanvas)&&(e==="path"||e==="pixel"&&!(t.__pixelFill||t.__isCanvas))||e==="all";if(s&&this.__hitFill(i))return!0;const{hitStroke:n,__strokeWidth:r}=t,o=t.stroke&&(n==="path"||n==="pixel"&&!t.__pixelStroke)||n==="all";if(!s&&!o)return!1;const a=i.radiusX*2;let h=a;if(o)switch(t.strokeAlign){case"inside":if(h+=r*2,!s&&this.__hitFill(i)&&this.__hitStroke(i,h))return!0;h=a;break;case"center":h+=r;break;case"outside":if(h+=r*2,!s){if(!this.__hitFill(i)&&this.__hitStroke(i,h))return!0;h=a}break}return h?this.__hitStroke(i,h):!1};const Tl=m.prototype,kl=Ke.prototype,Pl=ot.prototype;kl.__updateHitCanvas=Pl.__updateHitCanvas=function(){this.stroke||this.cornerRadius||(this.fill||this.__.__isCanvas)&&this.hitFill==="pixel"||this.hitStroke==="all"?Tl.__updateHitCanvas.call(this):this.__hitCanvas&&(this.__hitCanvas=null)};kl.__hitFill=Pl.__hitFill=function(i){return this.__hitCanvas?Tl.__hitFill.call(this,i):S.hitRadiusPoint(this.__layout.boxBounds,i)};const Ol=m.prototype,Np=qt.prototype;function ao(i){return i.leafer?i.leafer.selector:x.selector||(x.selector=rt.selector())}Ol.find=function(i,t){return ao(this).getBy(i,this,!1,t)};Ol.findOne=function(i,t){return ao(this).getBy(i,this,!0,t)};Np.pick=function(i,t){return this.__layout.update(),t||(t={}),ao(this).getByPoint(i,t.hitRadius||0,Object.assign(Object.assign({},t),{target:this}))};const ho=Jr.prototype;ho.hitFill=function(i,t){return t?this.context.isPointInPath(i.x,i.y,t):this.context.isPointInPath(i.x,i.y)};ho.hitStroke=function(i,t){return this.strokeWidth=t,this.context.isPointInStroke(i.x,i.y)};ho.hitPixel=function(i,t,e=1){let{x:s,y:n,radiusX:r,radiusY:o}=i;t&&(s-=t.x,n-=t.y),M.set(s-r,n-o,r*2,o*2).scale(e).ceil();const{data:a}=this.context.getImageData(M.x,M.y,M.width||1,M.height||1);for(let h=0,l=a.length;h<l;h+=4)if(a[h+3]>0)return!0;return a[3]>0};const qa=N.get("LeaferCanvas");class Al extends Jr{set zIndex(t){const{style:e}=this.view;e.zIndex=t,this.setAbsolute(this.view)}set childIndex(t){const{view:e,parentView:s}=this;if(e&&s){const n=s.children[t];n?(this.setAbsolute(n),s.insertBefore(e,n)):s.appendChild(n)}}init(){const{config:t}=this,e=t.view||t.canvas;e?this.__createViewFrom(e):this.__createView();const{style:s}=this.view;if(s.display||(s.display="block"),this.parentView=this.view.parentElement,this.parentView){const n=this.parentView.style;n.webkitUserSelect=n.userSelect="none"}x.syncDomFont&&!this.parentView&&(s.display="none",document.body.appendChild(this.view)),this.__createContext(),this.autoLayout||this.resize(t)}set backgroundColor(t){this.view.style.backgroundColor=t}get backgroundColor(){return this.view.style.backgroundColor}set hittable(t){this.view.style.pointerEvents=t?"auto":"none"}get hittable(){return this.view.style.pointerEvents!=="none"}__createView(){this.view=document.createElement("canvas")}__createViewFrom(t){let e=typeof t=="string"?document.getElementById(t):t;if(e)if(e instanceof HTMLCanvasElement)this.view=e;else{let s=e;if(e===window||e===document){const r=document.createElement("div"),{style:o}=r;o.position="absolute",o.top=o.bottom=o.left=o.right="0px",document.body.appendChild(r),s=r}this.__createView();const n=this.view;s.hasChildNodes()&&(this.setAbsolute(n),s.style.position||(s.style.position="relative")),s.appendChild(n)}else qa.error(`no id: ${t}`),this.__createView()}setAbsolute(t){const{style:e}=t;e.position="absolute",e.top=e.left="0px"}updateViewSize(){const{width:t,height:e,pixelRatio:s}=this,{style:n}=this.view;n.width=t+"px",n.height=e+"px",this.view.width=Math.ceil(t*s),this.view.height=Math.ceil(e*s)}updateClientBounds(){this.clientBounds=this.view.getBoundingClientRect()}startAutoLayout(t,e){if(this.resizeListener=e,t){this.autoBounds=t;try{this.resizeObserver=new ResizeObserver(n=>{this.updateClientBounds();for(const r of n)this.checkAutoBounds(r.contentRect)});const s=this.parentView;s?(this.resizeObserver.observe(s),this.checkAutoBounds(s.getBoundingClientRect())):(this.checkAutoBounds(this.view),qa.warn("no parent"))}catch{this.imitateResizeObserver()}}else window.addEventListener("resize",()=>{const s=x.devicePixelRatio;if(this.pixelRatio!==s){const{width:n,height:r}=this;this.emitResize({width:n,height:r,pixelRatio:s})}})}imitateResizeObserver(){this.autoLayout&&(this.parentView&&this.checkAutoBounds(this.parentView.getBoundingClientRect()),x.requestRender(this.imitateResizeObserver.bind(this)))}checkAutoBounds(t){const e=this.view,{x:s,y:n,width:r,height:o}=this.autoBounds.getBoundsFrom(t),a={width:r,height:o,pixelRatio:x.devicePixelRatio};if(!this.isSameSize(a)){const{style:h}=e;h.marginLeft=s+"px",h.marginTop=n+"px",this.emitResize(a)}}stopAutoLayout(){this.autoLayout=!1,this.resizeListener=null,this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null)}emitResize(t){const e={};lt.copyAttrs(e,this,Gt),this.resize(t),this.resizeListener&&this.width!==void 0&&this.resizeListener(new Je(t,e))}unrealCanvas(){if(!this.unreal&&this.parentView){const t=this.view;t&&t.remove(),this.view=this.parentView,this.unreal=!0}}destroy(){if(this.view){if(this.stopAutoLayout(),!this.unreal){const t=this.view;t.parentElement&&t.remove()}super.destroy()}}}ul(CanvasRenderingContext2D.prototype);ul(Path2D.prototype);const{mineType:ur,fileType:Hp}=me;Object.assign(rt,{canvas:(i,t)=>new Al(i,t),image:i=>new dl(i)});function Gp(i,t){x.origin={createCanvas(e,s){const n=document.createElement("canvas");return n.width=e,n.height=s,n},canvasToDataURL:(e,s,n)=>e.toDataURL(ur(s),n),canvasToBolb:(e,s,n)=>new Promise(r=>e.toBlob(r,ur(s),n)),canvasSaveAs:(e,s,n)=>{const r=e.toDataURL(ur(Hp(s)),n);return x.origin.download(r,s)},download(e,s){return new Promise(n=>{let r=document.createElement("a");r.href=e,r.download=s,document.body.appendChild(r),r.click(),document.body.removeChild(r),n()})},loadImage(e){return new Promise((s,n)=>{const r=new Image,{crossOrigin:o}=x.image;o&&(r.setAttribute("crossOrigin",o),r.crossOrigin=o),r.onload=()=>{s(r)},r.onerror=a=>{n(a)},r.src=x.image.getRealURL(e)})}},x.event={stopDefault(e){e.preventDefault()},stopNow(e){e.stopImmediatePropagation()},stop(e){e.stopPropagation()}},x.canvas=rt.canvas(),x.conicGradientSupport=!!x.canvas.context.createConicGradient}x.name="web";x.isMobile="ontouchstart"in window;x.requestRender=function(i){window.requestAnimationFrame(i)};Pi(x,"devicePixelRatio",{get(){return Math.max(1,devicePixelRatio)}});const{userAgent:wi}=navigator;wi.indexOf("Firefox")>-1?(x.conicGradientRotate90=!0,x.intWheelDeltaY=!0,x.syncDomFont=!0):wi.indexOf("Safari")>-1&&wi.indexOf("Chrome")===-1&&(x.fullImageShadow=!0);wi.indexOf("Windows")>-1?(x.os="Windows",x.intWheelDeltaY=!0):wi.indexOf("Mac")>-1?x.os="Mac":wi.indexOf("Linux")>-1&&(x.os="Linux");class Up{get childrenChanged(){return this.hasAdd||this.hasRemove||this.hasVisible}get updatedList(){if(this.hasRemove){const t=new nt;return this.__updatedList.list.forEach(e=>{e.leafer&&t.add(e)}),t}else return this.__updatedList}constructor(t,e){this.totalTimes=0,this.config={},this.__updatedList=new nt,this.target=t,e&&(this.config=lt.default(e,this.config)),this.__listenEvents()}start(){this.disabled||(this.running=!0)}stop(){this.running=!1}disable(){this.stop(),this.__removeListenEvents(),this.disabled=!0}update(){this.changed=!0,this.running&&this.target.emit(Y.REQUEST)}__onAttrChange(t){this.__updatedList.add(t.target),this.update()}__onChildEvent(t){t.type===st.ADD?(this.hasAdd=!0,this.__pushChild(t.child)):(this.hasRemove=!0,this.__updatedList.add(t.parent)),this.update()}__pushChild(t){this.__updatedList.add(t),t.isBranch&&this.__loopChildren(t)}__loopChildren(t){const{children:e}=t;for(let s=0,n=e.length;s<n;s++)this.__pushChild(e[s])}__onRquestData(){this.target.emitEvent(new Ae(Ae.DATA,{updatedList:this.updatedList})),this.__updatedList=new nt,this.totalTimes++,this.changed=!1,this.hasVisible=!1,this.hasRemove=!1,this.hasAdd=!1}__listenEvents(){const{target:t}=this;this.__eventIds=[t.on_(ye.CHANGE,this.__onAttrChange,this),t.on_([st.ADD,st.REMOVE],this.__onChildEvent,this),t.on_(Ae.REQUEST,this.__onRquestData,this)]}__removeListenEvents(){this.target.off_(this.__eventIds)}destroy(){this.target&&(this.stop(),this.__removeListenEvents(),this.target=null,this.__updatedList=null)}}const{updateAllMatrix:Yp,updateBounds:Ka,updateAllWorldOpacity:Xp}=oe,{pushAllChildBranch:Vp,pushAllParent:Za}=cs;function qp(i,t){let e;i.list.forEach(s=>{e=s.__layout,t.without(s)&&!e.proxyZoom&&(e.matrixChanged?(Yp(s,!0),t.add(s),s.isBranch&&Vp(s,t),Za(s,t)):e.boundsChanged&&(t.add(s),s.isBranch&&(s.__tempNumber=0),Za(s,t)))})}function Kp(i){let t,e,s;i.sort(!0),i.levels.forEach(n=>{t=i.levelMap[n];for(let r=0,o=t.length;r<o;r++){if(e=t[r],e.isBranch&&e.__tempNumber){s=e.children;for(let a=0,h=s.length;a<h;a++)s[a].isBranch||Ka(s[a])}Ka(e)}})}function Zp(i){let t;i.list.forEach(e=>{t=e.__layout,t.opacityChanged&&Xp(e),t.stateStyleChanged&&setTimeout(()=>t.stateStyleChanged&&e.updateState()),e.__updateChange()})}const{worldBounds:Qa}=yn,Qp={x:0,y:0,width:1e5,height:1e5};class Ja{constructor(t){this.updatedBounds=new J,this.beforeBounds=new J,this.afterBounds=new J,t instanceof Array&&(t=new nt(t)),this.updatedList=t}setBefore(){this.beforeBounds.setListWithFn(this.updatedList.list,Qa)}setAfter(){const{list:t}=this.updatedList;t.some(e=>e.noBounds)?this.afterBounds.set(Qp):this.afterBounds.setListWithFn(t,Qa),this.updatedBounds.setList([this.beforeBounds,this.afterBounds])}merge(t){this.updatedList.addList(t.updatedList.list),this.beforeBounds.add(t.beforeBounds),this.afterBounds.add(t.afterBounds),this.updatedBounds.add(t.updatedBounds)}destroy(){this.updatedList=null}}const{updateAllMatrix:Jp,updateAllChange:tg}=oe,dr=N.get("Layouter");class xn{constructor(t,e){this.totalTimes=0,this.config={},this.__levelList=new R_,this.target=t,e&&(this.config=lt.default(e,this.config)),this.__listenEvents()}start(){this.disabled||(this.running=!0)}stop(){this.running=!1}disable(){this.stop(),this.__removeListenEvents(),this.disabled=!0}layout(){if(!this.running)return;const{target:t}=this;this.times=0;try{t.emit(G.START),this.layoutOnce(),t.emitEvent(new G(G.END,this.layoutedBlocks,this.times))}catch(e){dr.error(e)}this.layoutedBlocks=null}layoutAgain(){this.layouting?this.waitAgain=!0:this.layoutOnce()}layoutOnce(){if(this.layouting)return dr.warn("layouting");if(this.times>3)return dr.warn("layout max times");this.times++,this.totalTimes++,this.layouting=!0,this.target.emit(Ae.REQUEST),this.totalTimes>1?this.partLayout():this.fullLayout(),this.layouting=!1,this.waitAgain&&(this.waitAgain=!1,this.layoutOnce())}partLayout(){var t;if(!(!((t=this.__updatedList)===null||t===void 0)&&t.length))return;const e=Ut.start("PartLayout"),{target:s,__updatedList:n}=this,{BEFORE:r,LAYOUT:o,AFTER:a}=G,h=this.getBlocks(n);h.forEach(l=>l.setBefore()),s.emitEvent(new G(r,h,this.times)),this.extraBlock=null,n.sort(),qp(n,this.__levelList),Kp(this.__levelList),Zp(n),this.extraBlock&&h.push(this.extraBlock),h.forEach(l=>l.setAfter()),s.emitEvent(new G(o,h,this.times)),s.emitEvent(new G(a,h,this.times)),this.addBlocks(h),this.__levelList.reset(),this.__updatedList=null,Ut.end(e)}fullLayout(){const t=Ut.start("FullLayout"),{target:e}=this,{BEFORE:s,LAYOUT:n,AFTER:r}=G,o=this.getBlocks(new nt(e));e.emitEvent(new G(s,o,this.times)),xn.fullLayout(e),o.forEach(a=>{a.setAfter()}),e.emitEvent(new G(n,o,this.times)),e.emitEvent(new G(r,o,this.times)),this.addBlocks(o),Ut.end(t)}static fullLayout(t){Jp(t,!0),t.isBranch?cs.updateBounds(t):oe.updateBounds(t),tg(t)}addExtra(t){if(!this.__updatedList.has(t)){const{updatedList:e,beforeBounds:s}=this.extraBlock||(this.extraBlock=new Ja([]));e.length?s.add(t.__world):s.set(t.__world),e.add(t)}}createBlock(t){return new Ja(t)}getBlocks(t){return[this.createBlock(t)]}addBlocks(t){this.layoutedBlocks?this.layoutedBlocks.push(...t):this.layoutedBlocks=t}__onReceiveWatchData(t){this.__updatedList=t.data.updatedList}__listenEvents(){const{target:t}=this;this.__eventIds=[t.on_(G.REQUEST,this.layout,this),t.on_(G.AGAIN,this.layoutAgain,this),t.on_(Ae.DATA,this.__onReceiveWatchData,this)]}__removeListenEvents(){this.target.off_(this.__eventIds)}destroy(){this.target&&(this.stop(),this.__removeListenEvents(),this.target=this.config=null)}}const Ne=N.get("Renderer");class eg{get needFill(){return!!(!this.canvas.allowBackgroundColor&&this.config.fill)}constructor(t,e,s){this.FPS=60,this.totalTimes=0,this.times=0,this.config={usePartRender:!0,maxFPS:60},this.target=t,this.canvas=e,s&&(this.config=lt.default(s,this.config)),this.__listenEvents(),this.__requestRender()}start(){this.running=!0}stop(){this.running=!1}update(){this.changed=!0}requestLayout(){this.target.emit(G.REQUEST)}render(t){if(!(this.running&&this.canvas.view)){this.changed=!0;return}const{target:e}=this;this.times=0,this.totalBounds=new J,Ne.log(e.innerName,"--->");try{e.isApp||e.app.emit(Y.CHILD_START,e),this.emitRender(Y.START),this.renderOnce(t),this.emitRender(Y.END,this.totalBounds),St.clearRecycled()}catch(s){this.rendering=!1,Ne.error(s)}Ne.log("-------------|")}renderAgain(){this.rendering?this.waitAgain=!0:this.renderOnce()}renderOnce(t){if(this.rendering)return Ne.warn("rendering");if(this.times>3)return Ne.warn("render max times");if(this.times++,this.totalTimes++,this.rendering=!0,this.changed=!1,this.renderBounds=new J,this.renderOptions={},t)this.emitRender(Y.BEFORE),t();else{if(this.requestLayout(),this.ignore){this.ignore=this.rendering=!1;return}this.emitRender(Y.BEFORE),this.config.usePartRender&&this.totalTimes>1?this.partRender():this.fullRender()}this.emitRender(Y.RENDER,this.renderBounds,this.renderOptions),this.emitRender(Y.AFTER,this.renderBounds,this.renderOptions),this.updateBlocks=null,this.rendering=!1,this.waitAgain&&(this.waitAgain=!1,this.renderOnce())}partRender(){const{canvas:t,updateBlocks:e}=this;if(!e)return Ne.warn("PartRender: need update attr");this.mergeBlocks(),e.forEach(s=>{t.bounds.hit(s)&&!s.isEmpty()&&this.clipRender(s)})}clipRender(t){const e=Ut.start("PartRender"),{canvas:s}=this,n=t.getIntersect(s.bounds),r=t.includes(this.target.__world),o=new J(n);s.save(),r&&!N.showRepaint?s.clear():(n.spread(10+1/this.canvas.pixelRatio).ceil(),s.clearWorld(n,!0),s.clipWorld(n,!0)),this.__render(n,r,o),s.restore(),Ut.end(e)}fullRender(){const t=Ut.start("FullRender"),{canvas:e}=this;e.save(),e.clear(),this.__render(e.bounds,!0),e.restore(),Ut.end(t)}__render(t,e,s){const n=t.includes(this.target.__world)?{includes:e}:{bounds:t,includes:e};this.needFill&&this.canvas.fillWorld(t,this.config.fill),N.showRepaint&&this.canvas.strokeWorld(t,"red"),this.target.__render(this.canvas,n),this.renderBounds=s=s||t,this.renderOptions=n,this.totalBounds.isEmpty()?this.totalBounds=s:this.totalBounds.add(s),N.showHitView&&this.renderHitView(n),N.showBoundsView&&this.renderBoundsView(n),this.canvas.updateRender(s)}renderHitView(t){}renderBoundsView(t){}addBlock(t){this.updateBlocks||(this.updateBlocks=[]),this.updateBlocks.push(t)}mergeBlocks(){const{updateBlocks:t}=this;if(t){const e=new J;e.setList(t),t.length=0,t.push(e)}}__requestRender(){const t=Date.now();x.requestRender(()=>{this.FPS=Math.min(60,Math.ceil(1e3/(Date.now()-t))),this.running&&(this.changed&&this.canvas.view&&this.render(),this.target.emit(Y.NEXT)),this.target&&this.__requestRender()})}__onResize(t){if(!this.canvas.unreal){if(t.bigger||!t.samePixelRatio){const{width:e,height:s}=t.old;if(!new J(0,0,e,s).includes(this.target.__world)||this.needFill||!t.samePixelRatio){this.addBlock(this.canvas.bounds),this.target.forceUpdate("surface");return}}this.addBlock(new J(0,0,1,1)),this.changed=!0}}__onLayoutEnd(t){t.data&&t.data.map(e=>{let s;e.updatedList&&e.updatedList.list.some(n=>(s=!n.__world.width||!n.__world.height,s&&(n.isLeafer||Ne.tip(n.innerName,": empty"),s=!n.isBranch||n.isBranchLeaf),s)),this.addBlock(s?this.canvas.bounds:e.updatedBounds)})}emitRender(t,e,s){this.target.emitEvent(new Y(t,this.times,e,s))}__listenEvents(){const{target:t}=this;this.__eventIds=[t.on_(Y.REQUEST,this.update,this),t.on_(G.END,this.__onLayoutEnd,this),t.on_(Y.AGAIN,this.renderAgain,this),t.on_(Je.RESIZE,this.__onResize,this)]}__removeListenEvents(){this.target.off_(this.__eventIds)}destroy(){this.target&&(this.stop(),this.__removeListenEvents(),this.target=this.canvas=this.config=null)}}const{hitRadiusPoint:ig}=S;class sg{constructor(t,e){this.target=t,this.selector=e}getByPoint(t,e,s){e||(e=0),s||(s={});const n=s.through||!1,r=s.ignoreHittable||!1,o=s.target||this.target;this.exclude=s.exclude||null,this.point={x:t.x,y:t.y,radiusX:e,radiusY:e},this.findList=new nt(s.findList),s.findList||this.hitBranch(o);const{list:a}=this.findList,h=this.getBestMatchLeaf(a,s.bottomList,r),l=r?this.getPath(h):this.getHitablePath(h);return this.clear(),n?{path:l,target:h,throughPath:a.length?this.getThroughPath(a):l}:{path:l,target:h}}getBestMatchLeaf(t,e,s){if(t.length){let n;this.findList=new nt;const{x:r,y:o}=this.point,a={x:r,y:o,radiusX:0,radiusY:0};for(let h=0,l=t.length;h<l;h++)if(n=t[h],(s||oe.worldHittable(n))&&(this.hitChild(n,a),this.findList.length))return this.findList.list[0]}if(e){for(let n=0,r=e.length;n<r;n++)if(this.hitChild(e[n].target,this.point,e[n].proxy),this.findList.length)return this.findList.list[0]}return t[0]}getPath(t){const e=new nt;for(;t;)e.add(t),t=t.parent;return this.target&&e.add(this.target),e}getHitablePath(t){const e=this.getPath(t&&t.hittable?t:null);let s,n=new nt;for(let r=e.list.length-1;r>-1&&(s=e.list[r],!(!s.__.hittable||(n.addAt(s,0),!s.__.hitChildren)));r--);return n}getThroughPath(t){const e=new nt,s=[];for(let a=t.length-1;a>-1;a--)s.push(this.getPath(t[a]));let n,r,o;for(let a=0,h=s.length;a<h;a++){n=s[a],r=s[a+1];for(let l=0,c=n.length;l<c&&(o=n.list[l],!(r&&r.has(o)));l++)e.add(o)}return e}hitBranch(t){this.eachFind(t.children,t.__onlyHitMask)}eachFind(t,e){let s,n;const{point:r}=this,o=t.length;for(let a=o-1;a>-1;a--)s=t[a],!(!s.__.visible||e&&!s.__.mask)&&(n=s.__.hitRadius?!0:ig(s.__world,r),s.isBranch?(n||s.__ignoreHitWorld)&&(this.eachFind(s.children,s.__onlyHitMask),s.isBranchLeaf&&this.hitChild(s,r)):n&&this.hitChild(s,r))}hitChild(t,e,s){if(!(this.exclude&&this.exclude.has(t))&&t.__hitWorld(e)){const{parent:n}=t;if(n&&n.__hasMask&&!t.__.mask&&!n.children.some(r=>r.__.mask&&r.__hitWorld(e)))return;this.findList.add(s||t)}}clear(){this.point=null,this.findList=null,this.exclude=null}destroy(){this.clear()}}const{Yes:ng,NoAndSkip:rg,YesAndSkip:og}=Fr,th={},eh={},ih={};class ag{constructor(t,e){this.config={},this.innerIdMap={},this.idMap={},this.methods={id:(s,n)=>s.id===n?(this.target&&(this.idMap[n]=s),1):0,innerId:(s,n)=>s.innerId===n?(this.target&&(this.innerIdMap[n]=s),1):0,className:(s,n)=>s.className===n?1:0,tag:(s,n)=>s.__tag===n?1:0,tags:(s,n)=>n[s.__tag]?1:0},this.target=t,e&&(this.config=lt.default(e,this.config)),this.picker=new sg(t,this),t&&this.__listenEvents()}getBy(t,e,s,n){switch(typeof t){case"number":const r=this.getByInnerId(t,e);return s?r:r?[r]:[];case"string":switch(t[0]){case"#":th.id=t.substring(1),t=th;break;case".":eh.className=t.substring(1),t=eh;break;default:ih.tag=t,t=ih}case"object":if(t.id!==void 0){const o=this.getById(t.id,e);return s?o:o?[o]:[]}else if(t.tag){const{tag:o}=t,a=o instanceof Array;return this.getByMethod(a?this.methods.tags:this.methods.tag,e,s,a?lt.toMap(o):o)}else return this.getByMethod(this.methods.className,e,s,t.className);case"function":return this.getByMethod(t,e,s,n)}}getByPoint(t,e,s){return x.name==="node"&&this.target&&this.target.emit(G.CHECK_UPDATE),this.picker.getByPoint(t,e,s)}getByInnerId(t,e){const s=this.innerIdMap[t];return s||(this.eachFind(this.toChildren(e),this.methods.innerId,null,t),this.findLeaf)}getById(t,e){const s=this.idMap[t];return s&&oe.hasParent(s,e||this.target)?s:(this.eachFind(this.toChildren(e),this.methods.id,null,t),this.findLeaf)}getByClassName(t,e){return this.getByMethod(this.methods.className,e,!1,t)}getByTag(t,e){return this.getByMethod(this.methods.tag,e,!1,t)}getByMethod(t,e,s,n){const r=s?null:[];return this.eachFind(this.toChildren(e),t,r,n),r||this.findLeaf}eachFind(t,e,s,n){let r,o;for(let a=0,h=t.length;a<h;a++){if(r=t[a],o=e(r,n),o===ng||o===og)if(s)s.push(r);else{this.findLeaf=r;return}r.isBranch&&o<rg&&this.eachFind(r.children,e,s,n)}}toChildren(t){return this.findLeaf=null,[t||this.target]}__onRemoveChild(t){const{id:e,innerId:s}=t.child;this.idMap[e]&&delete this.idMap[e],this.innerIdMap[s]&&delete this.innerIdMap[s]}__checkIdChange(t){if(t.attrName==="id"){const e=t.oldValue;this.idMap[e]&&delete this.idMap[e]}}__listenEvents(){this.__eventIds=[this.target.on_(st.REMOVE,this.__onRemoveChild,this),this.target.on_(ye.CHANGE,this.__checkIdChange,this)]}__removeListenEvents(){this.target.off_(this.__eventIds),this.__eventIds.length=0}destroy(){this.__eventIds.length&&(this.__removeListenEvents(),this.picker.destroy(),this.findLeaf=null,this.innerIdMap={},this.idMap={})}}Object.assign(rt,{watcher:(i,t)=>new Up(i,t),layouter:(i,t)=>new xn(i,t),renderer:(i,t,e)=>new eg(i,t,e),selector:(i,t)=>new ag(i,t)});x.layout=xn.fullLayout;const Ct={convert(i,t){const e=Vt.getBase(i),s=Object.assign(Object.assign({},e),{x:t.x,y:t.y,width:i.width,height:i.height,pointerType:i.pointerType,pressure:i.pressure});return s.pointerType==="pen"&&(s.tangentialPressure=i.tangentialPressure,s.tiltX=i.tiltX,s.tiltY=i.tiltY,s.twist=i.twist),s},convertMouse(i,t){const e=Vt.getBase(i);return Object.assign(Object.assign({},e),{x:t.x,y:t.y,width:1,height:1,pointerType:"mouse",pressure:.5})},convertTouch(i,t){const e=Ct.getTouch(i),s=Vt.getBase(i);return Object.assign(Object.assign({},s),{x:t.x,y:t.y,width:1,height:1,pointerType:"touch",multiTouch:i.touches.length>1,pressure:e.force})},getTouch(i){return i.targetTouches[0]||i.changedTouches[0]}},sh={getMove(i,t){let{moveSpeed:e}=t,{deltaX:s,deltaY:n}=i;return i.shiftKey&&!s&&(s=n,n=0),s>50&&(s=Math.max(50,s/3)),n>50&&(n=Math.max(50,n/3)),{x:-s*e*2,y:-n*e*2}},getScale(i,t){let e,s=1,{zoomMode:n,zoomSpeed:r}=t;const o=i.deltaY||i.deltaX;if(n?(e=n==="mouse"?!0:!i.deltaX&&(x.intWheelDeltaY?Math.abs(o)>17:Math.ceil(o)!==o),(i.shiftKey||i.metaKey||i.ctrlKey)&&(e=!0)):e=!i.shiftKey&&(i.metaKey||i.ctrlKey),e){r=ct.within(r,0,1);const a=i.deltaY?t.delta.y:t.delta.x;s=1-o/(a*4)*r,s<.5&&(s=.5),s>=1.5&&(s=1.5)}return s}},nh={convert(i){const t=Vt.getBase(i);return Object.assign(Object.assign({},t),{code:i.code,key:i.key})}},{getMoveEventData:hg,getZoomEventData:rh,getRotateEventData:lg,pathCanDrag:cg}=Vt;class ug extends Fp{__listenEvents(){super.__listenEvents();const t=this.view=this.canvas.view;this.viewEvents={pointerdown:this.onPointerDown,mousedown:this.onMouseDown,touchstart:this.onTouchStart,contextmenu:this.onContextMenu,wheel:this.onWheel,gesturestart:this.onGesturestart,gesturechange:this.onGesturechange,gestureend:this.onGestureend},this.windowEvents={pointermove:this.onPointerMove,pointerup:this.onPointerUp,pointercancel:this.onPointerCancel,mousemove:this.onMouseMove,mouseup:this.onMouseUp,touchmove:this.onTouchMove,touchend:this.onTouchEnd,touchcancel:this.onTouchCancel,keydown:this.onKeyDown,keyup:this.onKeyUp,scroll:this.onScroll};const{viewEvents:e,windowEvents:s}=this;for(let n in e)e[n]=e[n].bind(this),t.addEventListener(n,e[n]);for(let n in s)s[n]=s[n].bind(this),window.addEventListener(n,s[n])}__removeListenEvents(){super.__removeListenEvents();const{viewEvents:t,windowEvents:e}=this;for(let s in t)this.view.removeEventListener(s,t[s]),this.viewEvents={};for(let s in e)window.removeEventListener(s,e[s]),this.windowEvents={}}getTouches(t){const e=[];for(let s=0,n=t.length;s<n;s++)e.push(t[s]);return e}preventDefaultPointer(t){const{pointer:e}=this.config;e.preventDefault&&t.preventDefault()}preventDefaultWheel(t){const{wheel:e}=this.config;e.preventDefault&&t.preventDefault()}preventWindowPointer(t){return!this.downData&&t.target!==this.view}onKeyDown(t){this.keyDown(nh.convert(t))}onKeyUp(t){this.keyUp(nh.convert(t))}onContextMenu(t){this.config.pointer.preventDefaultMenu&&t.preventDefault(),this.menu(Ct.convert(t,this.getLocal(t)))}onScroll(){this.canvas.updateClientBounds()}onPointerDown(t){this.preventDefaultPointer(t),!(this.config.pointer.touch||this.useMultiTouch)&&(this.usePointer||(this.usePointer=!0),this.pointerDown(Ct.convert(t,this.getLocal(t))))}onPointerMove(t){this.config.pointer.touch||this.useMultiTouch||this.preventWindowPointer(t)||(this.usePointer||(this.usePointer=!0),this.pointerMove(Ct.convert(t,this.getLocal(t,!0))))}onPointerUp(t){this.downData&&this.preventDefaultPointer(t),!(this.config.pointer.touch||this.useMultiTouch||this.preventWindowPointer(t))&&this.pointerUp(Ct.convert(t,this.getLocal(t)))}onPointerCancel(){this.useMultiTouch||this.pointerCancel()}onMouseDown(t){this.preventDefaultPointer(t),!(this.useTouch||this.usePointer)&&this.pointerDown(Ct.convertMouse(t,this.getLocal(t)))}onMouseMove(t){this.useTouch||this.usePointer||this.preventWindowPointer(t)||this.pointerMove(Ct.convertMouse(t,this.getLocal(t,!0)))}onMouseUp(t){this.downData&&this.preventDefaultPointer(t),!(this.useTouch||this.usePointer||this.preventWindowPointer(t))&&this.pointerUp(Ct.convertMouse(t,this.getLocal(t)))}onMouseCancel(){this.useTouch||this.usePointer||this.pointerCancel()}onTouchStart(t){const e=Ct.getTouch(t),s=this.getLocal(e,!0),{preventDefault:n}=this.config.touch;(n===!0||n==="auto"&&cg(this.findPath(s)))&&t.preventDefault(),this.multiTouchStart(t),!this.usePointer&&(this.touchTimer&&(window.clearTimeout(this.touchTimer),this.touchTimer=0),this.useTouch=!0,this.pointerDown(Ct.convertTouch(t,s)))}onTouchMove(t){if(this.multiTouchMove(t),this.usePointer||this.preventWindowPointer(t))return;const e=Ct.getTouch(t);this.pointerMove(Ct.convertTouch(t,this.getLocal(e)))}onTouchEnd(t){if(this.multiTouchEnd(),this.usePointer||this.preventWindowPointer(t))return;this.touchTimer&&clearTimeout(this.touchTimer),this.touchTimer=setTimeout(()=>{this.useTouch=!1},500);const e=Ct.getTouch(t);this.pointerUp(Ct.convertTouch(t,this.getLocal(e)))}onTouchCancel(){this.usePointer||this.pointerCancel()}multiTouchStart(t){this.useMultiTouch=t.touches.length>1,this.touches=this.useMultiTouch?this.getTouches(t.touches):void 0,this.useMultiTouch&&this.pointerCancel()}multiTouchMove(t){if(this.useMultiTouch&&t.touches.length>1){const e=this.getTouches(t.touches),s=this.getKeepTouchList(this.touches,e);s.length>1&&(this.multiTouch(Vt.getBase(t),s),this.touches=e)}}multiTouchEnd(){this.touches=null,this.useMultiTouch=!1,this.transformEnd()}getKeepTouchList(t,e){let s;const n=[];return t.forEach(r=>{s=e.find(o=>o.identifier===r.identifier),s&&n.push({from:this.getLocal(r),to:this.getLocal(s)})}),n}getLocalTouchs(t){return t.map(e=>this.getLocal(e))}onWheel(t){this.preventDefaultWheel(t);const{wheel:e}=this.config;if(e.disabled)return;const s=e.getScale?e.getScale(t,e):sh.getScale(t,e),n=this.getLocal(t),r=Vt.getBase(t);s!==1?this.zoom(rh(n,s,r)):this.move(hg(n,e.getMove?e.getMove(t,e):sh.getMove(t,e),r))}onGesturestart(t){this.useMultiTouch||(this.preventDefaultWheel(t),this.lastGestureScale=1,this.lastGestureRotation=0)}onGesturechange(t){if(this.useMultiTouch)return;this.preventDefaultWheel(t);const e=this.getLocal(t),s=Vt.getBase(t),n=t.scale/this.lastGestureScale,r=t.rotation-this.lastGestureRotation;let{rotateSpeed:o}=this.config.wheel;o=ct.within(o,0,1),this.zoom(rh(e,n*n,s)),this.rotate(lg(e,r/Math.PI*180*(o/4+.1),s)),this.lastGestureScale=t.scale,this.lastGestureRotation=t.rotation}onGestureend(t){this.useMultiTouch||(this.preventDefaultWheel(t),this.transformEnd())}setCursor(t){super.setCursor(t);const e=[];this.eachCursor(t,e),typeof e[e.length-1]=="object"&&e.push("default"),this.canvas.view.style.cursor=e.map(s=>typeof s=="object"?`url(${s.url}) ${s.x||0} ${s.y||0}`:s).join(",")}eachCursor(t,e,s=0){if(s++,t instanceof Array)t.forEach(n=>this.eachCursor(n,e,s));else{const n=typeof t=="string"&&Sl.get(t);n&&s<2?this.eachCursor(n,e,s):e.push(t)}}destroy(){this.view&&(super.destroy(),this.view=null,this.touches=null)}}function xi(i,t){let e;const{rows:s,decorationY:n,decorationHeight:r}=i.__.__textDrawData;for(let o=0,a=s.length;o<a;o++)e=s[o],e.text?t.fillText(e.text,e.x,e.y):e.data&&e.data.forEach(h=>{t.fillText(h.char,h.x,e.y)}),n&&t.fillRect(e.x,e.y+n,e.width,r)}function dg(i,t,e){e.fillStyle=i,t.__.__font?xi(t,e):t.__.windingRule?e.fill(t.__.windingRule):e.fill()}function fg(i,t,e){let s;const{windingRule:n,__font:r}=t.__;for(let o=0,a=i.length;o<a;o++)s=i[o],!(s.image&&qe.checkImage(t,e,s,!r))&&s.style&&(e.fillStyle=s.style,s.transform?(e.save(),e.transform(s.transform),s.blendMode&&(e.blendMode=s.blendMode),r?xi(t,e):n?e.fill(n):e.fill(),e.restore()):s.blendMode?(e.saveBlendMode(s.blendMode),r?xi(t,e):n?e.fill(n):e.fill(),e.restoreBlendMode()):r?xi(t,e):n?e.fill(n):e.fill())}function lo(i,t,e){const{strokeAlign:s}=t.__,n=typeof i!="string";switch(s){case"center":e.setStroke(n?void 0:i,t.__.strokeWidth,t.__),n?Qi(i,!0,t,e):ns(t,e);break;case"inside":oh("inside",i,n,t,e);break;case"outside":oh("outside",i,n,t,e);break}}function oh(i,t,e,s,n){const{__strokeWidth:r,__font:o}=s.__,a=n.getSameCanvas(!0,!0);a.setStroke(e?void 0:t,r*2,s.__),a.font=o,e?Qi(t,!0,s,a):ns(s,a),a.blendMode=i==="outside"?"destination-out":"destination-in",xi(s,a),a.blendMode="normal",s.__worldFlipped?n.copyWorldByReset(a,s.__nowWorld):n.copyWorldToInner(a,s.__nowWorld,s.__layout.renderBounds),a.recycle(s.__nowWorld)}function ns(i,t){let e;const{rows:s,decorationY:n,decorationHeight:r}=i.__.__textDrawData;for(let o=0,a=s.length;o<a;o++)e=s[o],e.text?t.strokeText(e.text,e.x,e.y):e.data&&e.data.forEach(h=>{t.strokeText(h.char,h.x,e.y)}),n&&t.strokeRect(e.x,e.y+n,e.width,r)}function Qi(i,t,e,s){let n;for(let r=0,o=i.length;r<o;r++)n=i[r],!(n.image&&qe.checkImage(e,s,n,!1))&&n.style&&(s.strokeStyle=n.style,n.blendMode?(s.saveBlendMode(n.blendMode),t?ns(e,s):s.stroke(),s.restoreBlendMode()):t?ns(e,s):s.stroke())}function _g(i,t,e){const s=t.__,{__strokeWidth:n,strokeAlign:r,__font:o}=s;if(n)if(o)lo(i,t,e);else switch(r){case"center":e.setStroke(i,n,s),e.stroke(),s.__useArrow&&Ll(t,e);break;case"inside":e.save(),e.setStroke(i,n*2,s),s.windingRule?e.clip(s.windingRule):e.clip(),e.stroke(),e.restore();break;case"outside":const a=e.getSameCanvas(!0,!0);a.setStroke(i,n*2,s),t.__drawRenderPath(a),a.stroke(),s.windingRule?a.clip(s.windingRule):a.clip(),a.clearWorld(t.__layout.renderBounds),t.__worldFlipped?e.copyWorldByReset(a,t.__nowWorld):e.copyWorldToInner(a,t.__nowWorld,t.__layout.renderBounds),a.recycle(t.__nowWorld);break}}function pg(i,t,e){const s=t.__,{__strokeWidth:n,strokeAlign:r,__font:o}=s;if(n)if(o)lo(i,t,e);else switch(r){case"center":e.setStroke(void 0,n,s),Qi(i,!1,t,e),s.__useArrow&&Ll(t,e);break;case"inside":e.save(),e.setStroke(void 0,n*2,s),s.windingRule?e.clip(s.windingRule):e.clip(),Qi(i,!1,t,e),e.restore();break;case"outside":const{renderBounds:a}=t.__layout,h=e.getSameCanvas(!0,!0);t.__drawRenderPath(h),h.setStroke(void 0,n*2,s),Qi(i,!1,t,h),s.windingRule?h.clip(s.windingRule):h.clip(),h.clearWorld(a),t.__worldFlipped?e.copyWorldByReset(h,t.__nowWorld):e.copyWorldToInner(h,t.__nowWorld,a),h.recycle(t.__nowWorld);break}}function Ll(i,t){i.__.dashPattern&&(t.beginPath(),i.__drawPathByData(t,i.__.__pathForArrow),t.dashPattern=null,t.stroke())}const{getSpread:gg,getOuterOf:yg,getByMove:mg,getIntersectData:wg}=S;function xg(i,t,e){const s=t.getSameCanvas(),n=i.__nowWorld;let r,o,a,h,{scaleX:l,scaleY:c}=n;if(l<0&&(l=-l),c<0&&(c=-c),t.bounds.includes(n))h=s,r=a=n;else{const{renderShapeSpread:d}=i.__layout,f=wg(d?gg(t.bounds,l===c?d*l:[d*c,d*l]):t.bounds,n);o=t.bounds.getFitMatrix(f);let{a:u,d:_}=o;if(o.a<1&&(h=t.getSameCanvas(),i.__renderShape(h,e),l*=u,c*=_),a=yg(n,o),r=mg(a,-o.e,-o.f),e.matrix){const{matrix:y}=e;o.multiply(y),u*=y.scaleX,_*=y.scaleY}e=Object.assign(Object.assign({},e),{matrix:o.withScale(u,_)})}return i.__renderShape(s,e),{canvas:s,matrix:o,bounds:r,worldCanvas:h,shapeBounds:a,scaleX:l,scaleY:c}}let Gr;function vg(i,t){const e=t.__,s=[];let n=e.__input[i],r;n instanceof Array||(n=[n]),Gr=qe.recycleImage(i,e);for(let o=0,a=n.length,h;o<a;o++)h=bg(i,n[o],t),h&&s.push(h);e["_"+i]=s.length?s:void 0,s.length&&s[0].image&&(r=s[0].image.hasOpacityPixel),i==="fill"?e.__pixelFill=r:e.__pixelStroke=r}function bg(i,t,e){if(typeof t!="object"||t.visible===!1||t.opacity===0)return;const{boxBounds:s}=e.__layout;switch(t.type){case"solid":let{type:n,blendMode:r,color:o,opacity:a}=t;return{type:n,blendMode:r,style:se.string(o,a)};case"image":return qe.image(e,i,t,s,!Gr||!Gr[t.url]);case"linear":return Ys.linearGradient(t,s);case"radial":return Ys.radialGradient(t,s);case"angular":return Ys.conicGradient(t,s);default:return t.r!==void 0?{type:"solid",style:se.string(t)}:void 0}}const Bg={compute:vg,fill:dg,fills:fg,fillText:xi,stroke:_g,strokes:pg,strokeText:lo,drawTextStroke:ns,shape:xg};let Ni={};const{get:co,rotateOfOuter:Dl,translate:gi,scaleOfOuter:Cg,scale:Ml,rotate:Fl}=k;function Il(i,t,e,s,n,r,o){const a=co();gi(a,t.x+e,t.y+s),Ml(a,n,r),o&&Dl(a,{x:t.x+t.width/2,y:t.y+t.height/2},o),i.transform=a}function Wl(i,t,e,s,n,r,o){const a=co();gi(a,t.x+e,t.y+s),n&&Ml(a,n,r),o&&Fl(a,o),i.transform=a}function $l(i,t,e,s,n,r,o,a,h,l){const c=co();if(h)if(l==="center")Dl(c,{x:e/2,y:s/2},h);else switch(Fl(c,h),h){case 90:gi(c,s,0);break;case 180:gi(c,e,s);break;case 270:gi(c,0,e);break}Ni.x=t.x+n,Ni.y=t.y+r,gi(c,Ni.x,Ni.y),o&&Cg(c,Ni,o,a),i.transform=c}const{get:Eg,translate:Sg}=k,Rg=new J,fr={},_r={};function zl(i,t,e,s){const{blendMode:n,sync:r}=e;n&&(i.blendMode=n),r&&(i.sync=r),i.data=jl(e,s,t)}function jl(i,t,e){let{width:s,height:n}=e;i.padding&&(t=Rg.set(t).shrink(i.padding)),i.mode==="strench"&&(i.mode="stretch");const{opacity:r,mode:o,align:a,offset:h,scale:l,size:c,rotation:d,repeat:f}=i,u=t.width===s&&t.height===n,_={mode:o},y=a!=="center"&&(d||0)%180===90,w=y?n:s,B=y?s:n;let g=0,R=0,v,A;if(!o||o==="cover"||o==="fit"){if(!u||d){const L=t.width/w,P=t.height/B;v=A=o==="fit"?Math.min(L,P):Math.max(L,P),g+=(t.width-s*v)/2,R+=(t.height-n*A)/2}}else(l||c)&&(ct.getScaleData(l,c,e,_r),v=_r.scaleX,A=_r.scaleY);if(a){const L={x:g,y:R,width:w,height:B};v&&(L.width*=v,L.height*=A),tl.toPoint(a,L,t,fr,!0),g+=fr.x,R+=fr.y}switch(h&&(g+=h.x,R+=h.y),o){case"stretch":u||(s=t.width,n=t.height);break;case"normal":case"clip":(g||R||v||d)&&Wl(_,t,g,R,v,A,d);break;case"repeat":(!u||v||d)&&$l(_,t,s,n,g,R,v,A,d,a),f||(_.repeat="repeat");break;case"fit":case"cover":default:v&&Il(_,t,g,R,v,A,d)}return _.transform||(t.x||t.y)&&(_.transform=Eg(),Sg(_.transform,t.x,t.y)),v&&o!=="stretch"&&(_.scaleX=v,_.scaleY=A),_.width=s,_.height=n,r&&(_.opacity=r),f&&(_.repeat=typeof f=="string"?f==="x"?"repeat-x":"repeat-y":"repeat"),_}let Hi,Tg=new J;const{isSame:kg}=S;function Pg(i,t,e,s,n){let r,o;const a=St.get(e);return Hi&&e===Hi.paint&&kg(s,Hi.boxBounds)?r=Hi.leafPaint:(r={type:e.type,image:a},Hi=a.use>1?{leafPaint:r,paint:e,boxBounds:Tg.set(s)}:null),(n||a.loading)&&(o={image:a,attrName:t,attrValue:e}),a.ready?(ah(i,t,e,a,r,s),n&&(hh(i,o),lh(i,o))):a.error?n&&ch(i,o,a.error):(n&&(pr(i,!0),hh(i,o)),r.loadId=a.load(()=>{pr(i,!1),i.destroyed||(ah(i,t,e,a,r,s)&&(a.hasOpacityPixel&&(i.__layout.hitCanvasChanged=!0),i.forceUpdate("surface")),lh(i,o)),r.loadId=null},h=>{pr(i,!1),ch(i,o,h),r.loadId=null})),r}function ah(i,t,e,s,n,r){if(t==="fill"&&!i.__.__naturalWidth){const o=i.__;if(o.__naturalWidth=s.width/o.pixelRatio,o.__naturalHeight=s.height/o.pixelRatio,o.__autoSide)return i.forceUpdate("width"),i.__proxyData&&(i.setProxyAttr("width",o.width),i.setProxyAttr("height",o.height)),!1}return n.data||zl(n,s,e,r),!0}function hh(i,t){uo(i,ie.LOAD,t)}function lh(i,t){uo(i,ie.LOADED,t)}function ch(i,t,e){t.error=e,i.forceUpdate("surface"),uo(i,ie.ERROR,t)}function uo(i,t,e){i.hasEvent(t)&&i.emitEvent(new ie(t,e))}function pr(i,t){const{leafer:e}=i;e&&e.viewReady&&(e.renderer.ignore=t)}const{get:uh,scale:dh,copy:fh}=k,{ceil:_h,abs:ph}=Math;function Ur(i,t,e){let{scaleX:s,scaleY:n}=St.patternLocked?i.__world:i.__nowWorld;const r=s+"-"+n+"-"+e;if(t.patternId!==r&&!i.destroyed){s=ph(s),n=ph(n);const{image:o,data:a}=t;let h,l,{width:c,height:d,scaleX:f,scaleY:u,opacity:_,transform:y,repeat:w}=a;f&&(l=uh(),fh(l,y),dh(l,1/f,1/u),s*=f,n*=u),s*=e,n*=e,c*=s,d*=n;const B=c*d;if(!w&&B>x.image.maxCacheSize)return!1;let g=x.image.maxPatternSize;if(!o.isSVG){const A=o.width*o.height;g>A&&(g=A)}B>g&&(h=Math.sqrt(B/g)),h&&(s/=h,n/=h,c/=h,d/=h),f&&(s/=f,n/=u),(y||s!==1||n!==1)&&(l||(l=uh(),y&&fh(l,y)),dh(l,1/s,1/n));const R=o.getCanvas(_h(c)||1,_h(d)||1,_),v=o.getPattern(R,w||x.origin.noRepeat||"no-repeat",l,t);return t.style=v,t.patternId=r,!0}else return!1}function fo(i,t,e,s){function n(r){return r instanceof e?r:new e(function(o){o(r)})}return new(e||(e=Promise))(function(r,o){function a(c){try{l(s.next(c))}catch(d){o(d)}}function h(c){try{l(s.throw(c))}catch(d){o(d)}}function l(c){c.done?r(c.value):n(c.value).then(a,h)}l((s=s.apply(i,[])).next())})}const{abs:gh}=Math;function Og(i,t,e,s){const{scaleX:n,scaleY:r}=St.patternLocked?i.__world:i.__nowWorld,{pixelRatio:o}=t;if(!e.data||e.patternId===n+"-"+r+"-"+o&&!mi.running)return!1;{const{data:a}=e;if(s)if(a.repeat)s=!1;else{let{width:h,height:l}=a;h*=gh(n)*o,l*=gh(r)*o,a.scaleX&&(h*=a.scaleX,l*=a.scaleY),s=h*l>x.image.maxCacheSize||mi.running}return s?(t.save(),i.windingRule?t.clip(i.windingRule):t.clip(),e.blendMode&&(t.blendMode=e.blendMode),a.opacity&&(t.opacity*=a.opacity),a.transform&&t.transform(a.transform),t.drawImage(e.image.view,0,0,a.width,a.height),t.restore(),!0):(!e.style||e.sync||mi.running?Ur(i,e,o):e.patternTask||(e.patternTask=St.patternTasker.add(()=>fo(this,void 0,void 0,function*(){e.patternTask=null,t.bounds.hit(i.__nowWorld)&&Ur(i,e,o),i.forceUpdate("surface")}),300)),!1)}}function Ag(i,t){const e=t["_"+i];if(e instanceof Array){let s,n,r,o;for(let a=0,h=e.length;a<h;a++)s=e[a].image,o=s&&s.url,o&&(n||(n={}),n[o]=!0,St.recycle(s),s.loading&&(r||(r=t.__input&&t.__input[i]||[],r instanceof Array||(r=[r])),s.unload(e[a].loadId,!r.some(l=>l.url===o))));return n}return null}const Lg={image:Pg,checkImage:Og,createPattern:Ur,recycleImage:Ag,createData:zl,getPatternData:jl,fillOrFitMode:Il,clipMode:Wl,repeatMode:$l},{toPoint:yh}=ki,gr={},yr={};function Dg(i,t){let{from:e,to:s,type:n,blendMode:r,opacity:o}=i;yh(e||"top",t,gr),yh(s||"bottom",t,yr);const a=x.canvas.createLinearGradient(gr.x,gr.y,yr.x,yr.y);_o(a,i.stops,o);const h={type:n,style:a};return r&&(h.blendMode=r),h}function _o(i,t,e){if(t){let s;for(let n=0,r=t.length;n<r;n++)s=t[n],typeof s=="string"?i.addColorStop(n/(r-1),se.string(s,e)):i.addColorStop(s.offset,se.string(s.color,e))}}const{getAngle:Mg,getDistance:Fg}=T,{get:Ig,rotateOfOuter:mh,scaleOfOuter:wh}=k,{toPoint:xh}=ki,He={},mr={};function Wg(i,t){let{from:e,to:s,type:n,opacity:r,blendMode:o,stretch:a}=i;xh(e||"center",t,He),xh(s||"bottom",t,mr);const h=x.canvas.createRadialGradient(He.x,He.y,0,He.x,He.y,Fg(He,mr));_o(h,i.stops,r);const l={type:n,style:h},c=po(t,He,mr,a,!0);return c&&(l.transform=c),o&&(l.blendMode=o),l}function po(i,t,e,s,n){let r;const{width:o,height:a}=i;if(o!==a||s){const h=Mg(t,e);r=Ig(),n?(wh(r,t,o/a*(s||1),1),mh(r,t,h+90)):(wh(r,t,1,o/a*(s||1)),mh(r,t,h))}return r}const{getDistance:$g}=T,{toPoint:vh}=ki,pe={},wr={};function zg(i,t){let{from:e,to:s,type:n,opacity:r,blendMode:o,stretch:a}=i;vh(e||"center",t,pe),vh(s||"bottom",t,wr);const h=x.conicGradientSupport?x.canvas.createConicGradient(0,pe.x,pe.y):x.canvas.createRadialGradient(pe.x,pe.y,0,pe.x,pe.y,$g(pe,wr));_o(h,i.stops,r);const l={type:n,style:h},c=po(t,pe,wr,a||1,x.conicGradientRotate90);return c&&(l.transform=c),o&&(l.blendMode=o),l}const jg={linearGradient:Dg,radialGradient:Wg,conicGradient:zg,getTransform:po},{copy:bh,toOffsetOutBounds:Ng}=S,Bt={},Ls={};function Hg(i,t,e){let s,n;const{__nowWorld:r,__layout:o}=i,{shadow:a}=i.__,{worldCanvas:h,bounds:l,shapeBounds:c,scaleX:d,scaleY:f}=e,u=t.getSameCanvas(),_=a.length-1;Ng(l,Ls),a.forEach((y,w)=>{u.setWorldShadow(Ls.offsetX+y.x*d,Ls.offsetY+y.y*f,y.blur*d,y.color),n=y.spread?1+y.spread*2/(o.boxBounds.width+(o.strokeBoxSpread||0)*2):0,Nl(u,Ls,n,e),s=l,y.box&&(u.restore(),u.save(),h&&(u.copyWorld(u,l,r,"copy"),s=r),h?u.copyWorld(h,r,r,"destination-out"):u.copyWorld(e.canvas,c,l,"destination-out")),i.__worldFlipped?t.copyWorldByReset(u,s,r,y.blendMode):t.copyWorldToInner(u,s,o.renderBounds,y.blendMode),_&&w<_&&u.clearWorld(s,!0)}),u.recycle(s)}function Nl(i,t,e,s){const{bounds:n,shapeBounds:r}=s;if(x.fullImageShadow){if(bh(Bt,i.bounds),Bt.x+=t.x-r.x,Bt.y+=t.y-r.y,e){const{matrix:o}=s;Bt.x-=(n.x+(o?o.e:0)+n.width/2)*(e-1),Bt.y-=(n.y+(o?o.f:0)+n.height/2)*(e-1),Bt.width*=e,Bt.height*=e}i.copyWorld(s.canvas,i.bounds,Bt)}else e&&(bh(Bt,t),Bt.x-=t.width/2*(e-1),Bt.y-=t.height/2*(e-1),Bt.width*=e,Bt.height*=e),i.copyWorld(s.canvas,r,e?Bt:t)}const{toOffsetOutBounds:Gg}=S,Ds={};function Ug(i,t,e){let s,n;const{__nowWorld:r,__layout:o}=i,{innerShadow:a}=i.__,{worldCanvas:h,bounds:l,shapeBounds:c,scaleX:d,scaleY:f}=e,u=t.getSameCanvas(),_=a.length-1;Gg(l,Ds),a.forEach((y,w)=>{u.save(),u.setWorldShadow(Ds.offsetX+y.x*d,Ds.offsetY+y.y*f,y.blur*d),n=y.spread?1-y.spread*2/(o.boxBounds.width+(o.strokeBoxSpread||0)*2):0,Nl(u,Ds,n,e),u.restore(),h?(u.copyWorld(u,l,r,"copy"),u.copyWorld(h,r,r,"source-out"),s=r):(u.copyWorld(e.canvas,c,l,"source-out"),s=l),u.fillWorld(s,y.color,"source-in"),i.__worldFlipped?t.copyWorldByReset(u,s,r,y.blendMode):t.copyWorldToInner(u,s,o.renderBounds,y.blendMode),_&&w<_&&u.clearWorld(s,!0)}),u.recycle(s)}function Yg(i,t,e){const{blur:s}=i.__;e.setWorldBlur(s*i.__nowWorld.a),e.copyWorldToInner(t,i.__nowWorld,i.__layout.renderBounds),e.filter="none"}function Xg(i,t,e){}const Vg={shadow:Hg,innerShadow:Ug,blur:Yg,backgroundBlur:Xg},{excludeRenderBounds:qg}=yn;qt.prototype.__renderMask=function(i,t){let e,s,n,r,o,a;const{children:h}=this;for(let l=0,c=h.length;l<c;l++)e=h[l],a=e.__.mask,!(a&&(o&&(Bh(this,o,i,n,s,r),s=n=null),a==="path"||a==="clipping-path"?(e.opacity<1?(o="opacity-path",r=e.opacity,n||(n=xr(i))):(o="path",i.save()),e.__clip(n||i,t)):(o=a==="grayscale"?"grayscale":"alpha",s||(s=xr(i)),n||(n=xr(i)),e.__render(s,t)),!(a==="clipping"||a==="clipping-path")))&&(qg(e,t)||e.__render(n||i,t));Bh(this,o,i,n,s,r)};function Bh(i,t,e,s,n,r){switch(t){case"grayscale":n.useGrayscaleAlpha(i.__nowWorld);case"alpha":Kg(i,e,s,n);break;case"opacity-path":Hl(i,e,s,r);break;case"path":e.restore()}}function xr(i){return i.getSameCanvas(!1,!0)}function Kg(i,t,e,s){const n=i.__nowWorld;e.resetTransform(),e.opacity=1,e.useMask(s,n),s.recycle(n),Hl(i,t,e,1)}function Hl(i,t,e,s){const n=i.__nowWorld;t.resetTransform(),t.opacity=s,t.copyWorld(e,n),e.recycle(n)}const Zg="¥￥＄€£￡¢￠",Qg="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz",Jg="《（「〈『〖【〔｛┌＜‘“＝"+Zg,ty="》）」〉』〗】〕｝┐＞’”！？，、。：；‰",ey="≮≯≈≠＝…",iy="—／～｜┆·",sy=`{[(<'"`+Jg,Gl=`>)]}%!?,.:;'"`+ty,ny=Gl+"_#~&*+\\=|"+ey,ry="- "+iy,oy=[[19968,40959],[13312,19903],[131072,173791],[173824,177983],[177984,178207],[178208,183983],[183984,191471],[196608,201551],[201552,205743],[11904,12031],[12032,12255],[12272,12287],[12288,12351],[12736,12783],[12800,13055],[13056,13311],[63744,64255],[65072,65103],[127488,127743],[194560,195103]],ay=new RegExp(oy.map(([i,t])=>`[\\u${i.toString(16)}-\\u${t.toString(16)}]`).join("|"));function _s(i){const t={};return i.split("").forEach(e=>t[e]=!0),t}const hy=_s(Qg),ly=_s(sy),cy=_s(Gl),uy=_s(ny),dy=_s(ry);var rn;(function(i){i[i.Letter=0]="Letter",i[i.Single=1]="Single",i[i.Before=2]="Before",i[i.After=3]="After",i[i.Symbol=4]="Symbol",i[i.Break=5]="Break"})(rn||(rn={}));const{Letter:Ch,Single:fy,Before:_y,After:py,Symbol:gy,Break:yy}=rn;function my(i){return hy[i]?Ch:dy[i]?yy:ly[i]?_y:cy[i]?py:uy[i]?gy:ay.test(i)?fy:Ch}const wy={trimRight(i){const{words:t}=i;let e=0,s=t.length,n;for(let r=s-1;r>-1&&(n=t[r].data[0],n.char===" ");r--)e++,i.width-=n.width;e&&t.splice(s-e,e)}};function xy(i,t,e){switch(t){case"title":return e?i.toUpperCase():i;case"upper":return i.toUpperCase();case"lower":return i.toLowerCase();default:return i}}const{trimRight:vy}=wy,{Letter:vr,Single:Gi,Before:Eh,After:br,Symbol:by,Break:Sh}=rn;let Ji,Jt,yt,Et,Br,jt,ge,rs,Ri,Lt,Pe,Cr,Ui,yi,os,pi=[],Vs,Yr;function By(i,t,e){os=i,pi=i.rows,Vs=i.bounds,Yr=!Vs.width&&!e.autoSizeAlign;const{__letterSpacing:s,paraIndent:n,textCase:r}=e,{canvas:o}=x,{width:a,height:h}=Vs;if(a||h||s||r!=="none"){const c=e.textWrap!=="none",d=e.textWrap==="break";yi=!0,Pe=null,rs=ge=Ri=yt=Et=0,Ji={data:[]},Jt={words:[]};for(let f=0,u=t.length;f<u;f++)jt=t[f],jt===`
`?(yt&&Ge(),Jt.paraEnd=!0,Yi(),yi=!0):(Lt=my(jt),Lt===vr&&r!=="none"&&(jt=xy(jt,r,!yt)),ge=o.measureText(jt).width,s&&(s<0&&(Ri=ge),ge+=s),Cr=Lt===Gi&&(Pe===Gi||Pe===vr)||Pe===Gi&&Lt!==br,Ui=(Lt===Eh||Lt===Gi)&&(Pe===by||Pe===br),Br=yi&&n?a-n:a,c&&a&&Et+yt+ge>Br&&(d?(yt&&Ge(),Et&&Yi()):(Ui||(Ui=Lt===vr&&Pe==br),(Cr||Ui||Lt===Sh||Lt===Eh||Lt===Gi||yt+ge>Br)&&yt&&Ge(),Et&&Yi())),jt===" "&&yi!==!0&&Et+yt===0||(Lt===Sh?(jt===" "&&yt&&Ge(),Er(jt,ge),Ge()):((Cr||Ui)&&yt&&Ge(),Er(jt,ge))),Pe=Lt);yt&&Ge(),Et&&Yi(),pi.length>0&&(pi[pi.length-1].paraEnd=!0)}else t.split(`
`).forEach(c=>{os.paraNumber++,Et=o.measureText(c).width,pi.push({x:n||0,text:c,width:Et,paraStart:!0}),Yr&&Ul()})}function Er(i,t){Ri&&!rs&&(rs=Ri),Ji.data.push({char:i,width:t}),yt+=t}function Ge(){Et+=yt,Ji.width=yt,Jt.words.push(Ji),Ji={data:[]},yt=0}function Yi(){yi&&(os.paraNumber++,Jt.paraStart=!0,yi=!1),Ri&&(Jt.startCharSize=rs,Jt.endCharSize=Ri,rs=0),Jt.width=Et,Vs.width?vy(Jt):Yr&&Ul(),pi.push(Jt),Jt={words:[]},Et=0}function Ul(){Et>(os.maxWidth||0)&&(os.maxWidth=Et)}const Cy=0,Rh=1,Th=2;function Ey(i,t,e,s){const{rows:n}=i,{textAlign:r,paraIndent:o,letterSpacing:a}=t;let h,l,c,d,f;n.forEach(u=>{u.words&&(c=o&&u.paraStart?o:0,l=e&&r==="justify"&&u.words.length>1?(e-u.width-c)/(u.words.length-1):0,d=a||u.isOverflow?Cy:l>.01?Rh:Th,u.isOverflow&&!a&&(u.textMode=!0),d===Th?(u.x+=c,Sy(u)):(u.x+=c,h=u.x,u.data=[],u.words.forEach(_=>{d===Rh?(f={char:"",x:h},h=Ry(_.data,h,f),(u.isOverflow||f.char!==" ")&&u.data.push(f)):h=Ty(_.data,h,u.data,u.isOverflow),!u.paraEnd&&l&&(h+=l,u.width+=l)})),u.words=null)})}function Sy(i){i.text="",i.words.forEach(t=>{t.data.forEach(e=>{i.text+=e.char})})}function Ry(i,t,e){return i.forEach(s=>{e.char+=s.char,t+=s.width}),t}function Ty(i,t,e,s){return i.forEach(n=>{(s||n.char!==" ")&&(n.x=t,e.push(n)),t+=n.width}),t}function ky(i,t){const{rows:e,bounds:s}=i,{__lineHeight:n,__baseLine:r,__letterSpacing:o,__clipText:a,textAlign:h,verticalAlign:l,paraSpacing:c,autoSizeAlign:d}=t;let{x:f,y:u,width:_,height:y}=s,w=n*e.length+(c?c*(i.paraNumber-1):0),B=r;if(a&&w>y)w=Math.max(y,n),i.overflow=e.length;else if(y||d)switch(l){case"middle":u+=(y-w)/2;break;case"bottom":u+=y-w}B+=u;let g,R,v,A=_||d?_:i.maxWidth;for(let L=0,P=e.length;L<P;L++){if(g=e[L],g.x=f,g.width<_||g.width>_&&!a)switch(h){case"center":g.x+=(A-g.width)/2;break;case"right":g.x+=A-g.width}g.paraStart&&c&&L>0&&(B+=c),g.y=B,B+=n,i.overflow>L&&B>w&&(g.isOverflow=!0,i.overflow=L+1),R=g.x,v=g.width,o<0&&(g.width<0?(v=-g.width+t.fontSize+o,R-=v,v+=t.fontSize):v-=o),R<s.x&&(s.x=R),v>s.width&&(s.width=v),a&&_&&_<v&&(g.isOverflow=!0,i.overflow||(i.overflow=e.length))}s.y=u,s.height=w}function Py(i,t,e,s){if(!s)return;const{rows:n,overflow:r}=i;let{textOverflow:o}=t;if(n.splice(r),o&&o!=="show"){o==="hide"?o="":o==="ellipsis"&&(o="...");let a,h;const l=o?x.canvas.measureText(o).width:0,c=e+s-l;(t.textWrap==="none"?n:[n[r-1]]).forEach(f=>{if(f.isOverflow&&f.data){let u=f.data.length-1;for(let _=u;_>-1&&(a=f.data[_],h=a.x+a.width,!(_===u&&h<c));_--){if(h<c&&a.char!==" "){f.data.splice(_+1),f.width-=a.width;break}f.width-=a.width}f.width+=l,f.data.push({char:o,x:h}),f.textMode&&Oy(f)}})}}function Oy(i){i.text="",i.data.forEach(t=>{i.text+=t.char}),i.data=null}function Ay(i,t){const{fontSize:e}=t;switch(i.decorationHeight=e/11,t.textDecoration){case"under":i.decorationY=e*.15;break;case"delete":i.decorationY=-e*.35}}const{top:qs,right:Yl,bottom:Xl,left:Ks}=Mr;function Ly(i,t){typeof i!="string"&&(i=String(i));let e=0,s=0,n=t.__getInput("width")||0,r=t.__getInput("height")||0;const{textDecoration:o,__font:a,__padding:h}=t;h&&(n?(e=h[Ks],n-=h[Yl]+h[Ks]):t.autoSizeAlign||(e=h[Ks]),r?(s=h[qs],r-=h[qs]+h[Xl]):t.autoSizeAlign||(s=h[qs]));const l={bounds:{x:e,y:s,width:n,height:r},rows:[],paraNumber:0,font:x.canvas.font=a};return By(l,i,t),h&&Dy(h,l,t,n,r),ky(l,t),Ey(l,t,n),l.overflow&&Py(l,t,e,n),o!=="none"&&Ay(l,t),l}function Dy(i,t,e,s,n){if(!s&&e.autoSizeAlign)switch(e.textAlign){case"left":Ms(t,"x",i[Ks]);break;case"right":Ms(t,"x",-i[Yl])}if(!n&&e.autoSizeAlign)switch(e.verticalAlign){case"top":Ms(t,"y",i[qs]);break;case"bottom":Ms(t,"y",-i[Xl])}}function Ms(i,t,e){const{bounds:s,rows:n}=i;s[t]+=e;for(let r=0;r<n.length;r++)n[r][t]+=e}const My={getDrawData:Ly};function Fy(i,t){const e=typeof t=="number"&&t!==1;if(typeof i=="string")if(e&&se.object)i=se.object(i);else return i;let s=i.a===void 0?1:i.a;e&&(s*=t);const n=i.r+","+i.g+","+i.b;return s===1?"rgb("+n+")":"rgba("+n+","+s+")"}const Iy={string:Fy},{setPoint:Wy,addPoint:$y,toBounds:zy}=hs;function jy(i){const{width:t,height:e}=i.view,{data:s}=i.context.getImageData(0,0,t,e);let n,r,o,a=0;for(let l=0;l<s.length;l+=4)s[l+3]!==0&&(n=a%t,r=(a-n)/t,o?$y(o,n,r):Wy(o={},n,r)),a++;const h=new J;return zy(o,h),h.scale(1/i.pixelRatio).ceil()}const Ny={export(i,t,e){this.running=!0;const s=me.fileType(t),n=t.includes(".");return e=me.getExportOptions(e),Hy(r=>new Promise(o=>{const a=d=>{r(d),o(),this.running=!1},{toURL:h}=x,{download:l}=x.origin;if(s==="json")return n&&l(h(JSON.stringify(i.toJSON(e.json)),"text"),t),a({data:n?!0:i.toJSON(e.json)});if(s==="svg")return n&&l(h(i.toSVG(),"svg"),t),a({data:n?!0:i.toSVG()});const{leafer:c}=i;c?(Vl(i),c.waitViewCompleted(()=>fo(this,void 0,void 0,function*(){let d,f,u=1,_=1;const{worldTransform:y,isLeafer:w,isFrame:B}=i,{slice:g,trim:R,onCanvas:v}=e,A=e.smooth===void 0?c.config.smooth:e.smooth,L=e.contextSettings||c.config.contextSettings,P=e.screenshot||i.isApp,U=w&&P&&e.fill===void 0?i.fill:e.fill,ht=me.isOpaqueImage(t)||U,Q=new De;if(P)d=P===!0?w?c.canvas.bounds:i.worldRenderBounds:P;else{let ce=e.relative||(w?"inner":"local");switch(u=y.scaleX,_=y.scaleY,ce){case"inner":Q.set(y);break;case"local":Q.set(y).divide(i.localTransform),u/=i.scaleX,_/=i.scaleY;break;case"world":u=1,_=1;break;case"page":ce=i.leafer;default:Q.set(y).divide(i.getTransform(ce));const gs=ce.worldTransform;u/=u/gs.scaleX,_/=_/gs.scaleY}d=i.getBounds("render",ce)}const H={scaleX:1,scaleY:1};ct.getScaleData(e.scale,e.size,d,H);let pt=e.pixelRatio||1;i.isApp&&(H.scaleX*=pt,H.scaleY*=pt,pt=i.app.pixelRatio);const{x:ae,y:he,width:le,height:Se}=new J(d).scale(H.scaleX,H.scaleY),Ie={matrix:Q.scale(1/H.scaleX,1/H.scaleY).invert().translate(-ae,-he).withScale(1/u*H.scaleX,1/_*H.scaleY)};let at=rt.canvas({width:Math.round(le),height:Math.round(Se),pixelRatio:pt,smooth:A,contextSettings:L}),Re;if(g&&(Re=i,Re.__worldOpacity=0,i=c,Ie.bounds=at.bounds),at.save(),B&&U!==void 0){const ce=i.get("fill");i.fill="",i.__render(at,Ie),i.fill=ce}else i.__render(at,Ie);if(at.restore(),Re&&Re.__updateWorldOpacity(),R){f=jy(at);const ce=at,{width:gs,height:bc}=f,Po={x:0,y:0,width:gs,height:bc,pixelRatio:pt};at=rt.canvas(Po),at.copyWorld(ce,f,Po)}ht&&at.fillWorld(at.bounds,U||"#FFFFFF","destination-over"),v&&v(at);const ps=t==="canvas"?at:yield at.export(t,e);a({data:ps,width:at.pixelWidth,height:at.pixelHeight,renderBounds:d,trimBounds:f})}))):a({data:!1})}))}};let Sr;function Hy(i){return Sr||(Sr=new Wr),new Promise(t=>{Sr.add(()=>fo(this,void 0,void 0,function*(){return yield i(t)}),{parallel:!1})})}function Vl(i){i.__.__needComputePaint&&i.__.__computePaint(),i.isBranch&&i.children.forEach(t=>Vl(t))}const vn=Jr.prototype,ql=N.get("@leafer-ui/export");vn.export=function(i,t){const{quality:e,blob:s}=me.getExportOptions(t);return i.includes(".")?this.saveAs(i,e):s?this.toBlob(i,e):this.toDataURL(i,e)};vn.toBlob=function(i,t){return new Promise(e=>{x.origin.canvasToBolb(this.view,i,t).then(s=>{e(s)}).catch(s=>{ql.error(s),e(null)})})};vn.toDataURL=function(i,t){return x.origin.canvasToDataURL(this.view,i,t)};vn.saveAs=function(i,t){return new Promise(e=>{x.origin.canvasSaveAs(this.view,i,t).then(()=>{e(!0)}).catch(s=>{ql.error(s),e(!1)})})};Object.assign(xl,My);Object.assign(se,Iy);Object.assign(ut,Bg);Object.assign(qe,Lg);Object.assign(Ys,jg);Object.assign(jr,Vg);Object.assign(mi,Ny);Object.assign(rt,{interaction:(i,t,e,s)=>new ug(i,t,e,s),hitCanvas:(i,t)=>new Al(i,t),hitCanvasManager:()=>new Ip});Gp();function go(i,t){return Z(i,e=>({set(s){this.__setAttr(e,s),this.waitLeafer(()=>t?$.setStyleName(this,t,s):$.set(this,s))}}))}function Li(i){return Z(i,t=>({set(e){this.__setAttr(t,e),this.__layout.stateStyleChanged=!0}}))}function bn(i,t){if(t&&t!==!0)return t;if(!i.button){let{parent:e}=i;for(let s=0;s<2;s++)if(e){if(e.button)return e;e=e.parent}}return null}function Kl(i,t){typeof t!="object"&&(t=void 0),yo(i,t,"in")}function Zl(i,t){const{normalStyle:e}=i;typeof t!="object"&&(t=void 0),e&&(t||(t=e),yo(i,t,"out"))}const kh={};function yo(i,t,e){const{normalStyle:s}=i;t||(t=kh),t.scale&&(ct.assignScale(t,t.scale),delete t.scale),(t===kh||!$.canAnimate)&&(e=null);let n=e?Uy(e,t,i):!1;const r=n?Gy(i,t):void 0;i.killAnimate("transition"),s&&i.set(s,"temp");const o=Ql(i);if(o){const{animation:a}=o;if(a){const h=i.animate(a,void 0,"animation",!0);Object.assign(o,h.endingStyle),e!=="in"||t.animation!==a?h.kill():n=!1,delete o.animation}i.normalStyle=Xr(o,i),i.set(o,"temp")}else i.normalStyle=void 0;if(n){const a=Xr(r,i);i.set(r,"temp"),i.animate([r,a],n,"transition",!0)}i.__layout.stateStyleChanged=!1}function Ql(i){let t;const e={},{state:s}=i,n=bn(i),r=s&&i.states[s];r&&$.isState(s,i,n)&&(t=di(e,r));const o=e.selectedStyle||i.selectedStyle;if(o&&$.isSelected(i,n)&&(t=di(e,o)),$.isDisabled(i,n)){const a=e.disabledStyle||i.disabledStyle;a&&(t=di(e,a))}else{const a=e.focusStyle||i.focusStyle;a&&$.isFocus(i,n)&&(t=di(e,a));const h=e.hoverStyle||i.hoverStyle;h&&$.isHover(i,n)&&(t=di(e,h));const l=e.pressStyle||i.pressStyle;l&&$.isPress(i,n)&&(t=di(e,l))}return t?e:void 0}function Xr(i,t,e,s){const n=e?i:{},r=e||i;for(let o in r)s&&$.animateExcludes[o]||(n[o]=t[o]);return n}function Ph(i,t,e){return Xr(i,t,e,!0)}function Gy(i,t){const e=Ph(t,i),s=i.animate();return s&&Ph(e,i,s.fromStyle),e}function Uy(i,t,e){let s=i==="in"?"transition":"transitionOut";return i==="out"&&Fn(e[s])&&Fn(t[s])&&(s="transition"),Fn(t[s])?e[s]:t[s]}function di(i,t){return Object.assign(i,t),!0}function on(i,t){const e=i[t];e&&Kl(i,e),i.button&&wo(i.children,t)}function mo(i,t,e){e||(e=i.states[t]),Kl(i,e),i.button&&wo(i.children,null,t)}function wo(i,t,e){if(!i)return;let s,n;for(let r=0,o=i.length;r<o;r++){if(s=i[r],t){switch(n=!0,t){case"hoverStyle":$.isHover(s)&&(n=!1);break;case"pressStyle":$.isPress(s)&&(n=!1);break;case"focusStyle":$.isFocus(s)&&(n=!1)}n&&on(s,t)}else e&&mo(s,e);s.isBranch&&wo(s.children,t,e)}}function an(i,t){const e=i[t];e&&Zl(i,e),i.button&&vo(i.children,t)}function xo(i,t,e){Zl(i,e),i.button&&vo(i.children,null,t)}function vo(i,t,e){if(!i)return;let s;for(let n=0,r=i.length;n<r;n++)s=i[n],t?an(s,t):e&&xo(s,e),s.isBranch&&vo(s.children,t,e)}function Yy(i,t){switch(t){case C.ENTER:on(i,"hoverStyle");break;case C.LEAVE:an(i,"hoverStyle");break;case C.DOWN:on(i,"pressStyle");break;case C.UP:an(i,"pressStyle");break}}function Bn(i,t,e){let s;const n=t.leafer?t.leafer.interaction:null;if(n&&(s=n[i](t),!s&&e)){const r=bn(t,e);r&&(s=n[i](r))}return s}function Jl(i,t,e){let s=t[i];if(!s&&e){const n=bn(t,e);n&&(s=n[i])}return s}function Xy(i,t,e){let s=t.states[i];if(!s&&e){const n=bn(t,e);n&&(s=n.states[i])}return!!s}$.animateExcludes={animation:1,animationOut:1,transition:1,transitionOut:1,states:1,state:1,normalStyle:1,hoverStyle:1,pressStyle:1,focusStyle:1,selectedStyle:1,disabledStyle:1};$.isState=function(i,t,e){return Xy(i,t,e)};$.isSelected=function(i,t){return Jl("selected",i,t)};$.isDisabled=function(i,t){return Jl("disabled",i,t)};$.isFocus=function(i,t){return Bn("isFocus",i,t)};$.isHover=function(i,t){return Bn("isHover",i,t)};$.isPress=function(i,t){return Bn("isPress",i,t)};$.isDrag=function(i,t){return Bn("isDrag",i,t)};$.setStyleName=function(i,t,e){e?mo(i,t,i[t]):xo(i,t,i[t])};$.set=function(i,t){const e=i.states[t];e?mo(i,t,e):xo(i,t,e)};$.getStyle=Ql;$.updateStyle=yo;$.updateEventStyle=Yy;const Tt=m.prototype;go(!1,"selectedStyle")(Tt,"selected");go(!1,"disabledStyle")(Tt,"disabled");Li({})(Tt,"states");go("")(Tt,"state");vt()(Tt,"normalStyle");Li()(Tt,"hoverStyle");Li()(Tt,"pressStyle");Li()(Tt,"focusStyle");Li()(Tt,"selectedStyle");Li()(Tt,"disabledStyle");vt(!1)(Tt,"button");Tt.focus=function(i=!0){this.waitLeafer(()=>{let{focusData:t}=this.app.interaction;i?(t&&t.focus(!1),t=this):t=null,this.app.interaction.focusData=t,i?on(this,"focusStyle"):an(this,"focusStyle")})};Tt.updateState=function(){$.updateStyle(this,void 0,"in")};function kt(i,t,e,s){var n=arguments.length,r=n<3?t:s,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(i,t,e,s);else for(var a=i.length-1;a>=0;a--)(o=i[a])&&(r=(n<3?o(r):n>3?o(t,e,r):o(t,e))||r);return n>3&&r&&Object.defineProperty(t,e,r),r}const{cos:Oh,sin:Xi,pow:_t,sqrt:Fs,abs:Vy,ceil:qy,floor:Ky,round:Zy,PI:Zs}=Math,Is=Zs*5,Ws=1.70158,$s=1.70158*1.525,zs=7.5625,fi=2.75;function js(i){return t=>_t(t,i)}function Ns(i){return t=>1-_t(1-t,i)}function Hs(i){return t=>t<.5?_t(t*2,i)*.5:1-_t(2-t*2,i)*.5}function Gs(i){return i<1/fi?zs*i*i:i<2/fi?zs*(i-=1.5/fi)*i+.75:i<2.5/fi?zs*(i-=2.25/fi)*i+.9375:zs*(i-=2.625/fi)*i+.984375}function Vi(i,t,e,s){const n={};return r=>{const o=~~(r*1e4),a=n[o];if(a)return a;let h,l,c,d=r;for(let f=0;f<8&&(h=1-d,c=Ah(d,i,e)-r,l=3*h*h*i+6*h*d*(e-i)+3*d*d*(1-e),!(Vy(l)<1e-6));f++)d-=c/l;return n[o]=Ah(d,t,s)}}function Ah(i,t,e){const s=1-i;return 3*s*s*i*t+3*s*i*i*e+i*i*i}function Qy(i,t="floor"){return e=>(t==="floor"?Ky(e*i):t==="ceil"?qy(e*i):Zy(e*i))/i}const hn={get(i){const{list:t}=hn;return typeof i=="string"?t[i||"ease"]:typeof i=="object"?t[i.name].apply(t,i.value instanceof Array?i.value:[i.value]):t.ease},register(i,t){hn.list[i]=t},list:{linear:i=>i,ease:Vi(.25,.1,.25,1),"ease-in":Vi(.42,0,1,1),"ease-out":Vi(0,0,.58,1),"ease-in-out":Vi(.42,0,.58,1),"sine-in":i=>1-Oh(i*Zs*.5),"sine-out":i=>Xi(i*Zs*.5),"sine-in-out":i=>(1-Oh(i*Zs))*.5,"quad-in":js(2),"quad-out":Ns(2),"quad-in-out":Hs(2),"cubic-in":js(3),"cubic-out":Ns(3),"cubic-in-out":Hs(3),"quart-in":js(4),"quart-out":Ns(4),"quart-in-out":Hs(4),"quint-in":js(5),"quint-out":Ns(5),"quint-in-out":Hs(5),"expo-in":i=>i?_t(2,i*10-10):0,"expo-out":i=>i===1?1:1-_t(2,-i*10),"expo-in-out":i=>i===0||i===1?i:i<.5?_t(2,i*2*10-10)*.5:(2-_t(2,10-i*2*10))*.5,"circ-in":i=>1-Fs(1-_t(i,2)),"circ-out":i=>Fs(1-_t(i-1,2)),"circ-in-out":i=>i<.5?(1-Fs(1-_t(i*2,2)))*.5:(Fs(1-_t(2-i*2,2))+1)*.5,"back-in":i=>((Ws+1)*i-Ws)*i*i,"back-out":i=>(i-=1)*i*((Ws+1)*i+Ws)+1,"back-in-out":i=>i<.5?(i*=2)*i*(($s+1)*i-$s)*.5:((i=i*2-2)*i*(($s+1)*i+$s)+2)*.5,"elastic-in":i=>i===0||i===1?i:-_t(2,(i-1)*10)*Xi((i-1.1)*Is),"elastic-out":i=>i===0||i===1?i:_t(2,-10*i)*Xi((i-.1)*Is)+1,"elastic-in-out":i=>i===0||i===1?i:i<.5?-_t(2,((i*=2)-1)*10)*Xi((i-1.1)*Is)*.5:_t(2,(1-(i*=2))*10)*Xi((i-1.1)*Is)*.5+1,"bounce-in":i=>1-Gs(1-i),"bounce-out":Gs,"bounce-in-out":i=>i<.5?(1-Gs(1-i*2))*.5:(1+Gs(i*2-1))*.5,"cubic-bezier":Vi,steps:Qy}};function Jy(i){return Z(i,t=>({set(e){this.__setAttr(t,e),this.leafer&&(e?this.animate(e,void 0,"animation"):this.killAnimate("animation"))}}))}function zt(i){return(t,e)=>{Object.defineProperty(t,e,{get(){const s=this.config&&this.config[e];return s===void 0?i:s},set(s){this.config||(this.config={}),this.config[e]=s}})}}class mt{}mt.CREATED="created";mt.PLAY="play";mt.PAUSE="pause";mt.STOP="stop";mt.SEEK="seek";mt.UPDATE="update";mt.COMPLETED="completed";const tc=.2;let xt=class extends ml{get endingStyle(){return this.realEnding==="from"?this.fromStyle:this.toStyle}get started(){return!!this.requestAnimateTime}get completed(){return this.time>=this.duration&&!this.started}get frame(){return this.frames[this.nowIndex]}get frameTotalTime(){return this.frame.totalTime||this.frame.duration||0}get realEnding(){let t;const{ending:e,reverse:s,loop:n}=this;return e==="from"?t=0:e==="to"?t=1:(t=s?0:1,n&&typeof n=="number"&&(t+=n-1)),t%2?"to":"from"}constructor(t,e,s,n){super(),this.init(t,e,s,n)}init(t,e,s,n){switch(this.target=t,(n||this.isTemp)&&(this.isTemp=n),typeof s){case"number":this.config={duration:s};break;case"string":this.config={easing:s};break;case"object":this.config=s,s.event&&(this.event=s.event)}if(!e)return;this.keyframes=e instanceof Array?e:[e];const{easing:r,attrs:o}=this;this.easingFn=hn.get(r),(o||this.attrsMap)&&(this.attrsMap=o?o.reduce((a,h)=>(a[h]=!0,a),{}):void 0),this.frames=[],this.create(),this.autoplay&&(this.timer=setTimeout(()=>{this.timer=0,this.play()},0))}play(){this.destroyed||(this.running=!0,this.started?this.timer||this.requestAnimate():(this.clearTimer(),this.start()),this.emit(mt.PLAY,this))}pause(){this.destroyed||(this.running=!1,this.clearTimer(),this.emit(mt.PAUSE,this))}stop(){this.destroyed||(this.end(),this.complete(),this.emit(mt.STOP,this))}seek(t){this.destroyed||(typeof t=="object"&&(t=zr.number(t,this.duration)),t&&(t/=this.speed),(!this.started||t<this.time)&&this.start(!0),this.time=t,this.animate(0,!0),this.clearTimer(()=>this.requestAnimate()),this.emit(mt.SEEK,this))}kill(){this.destroy(!0)}create(){const{target:t,frames:e,keyframes:s,config:n}=this,{length:r}=s,o=r>1?this.join:!0;let a=0,h=0,l,c,d,f;r>1&&(this.fromStyle={},this.toStyle={});for(let u=0;u<r;u++){if(c=s[u],f=c.style||c,l||(l=o?t:f),d={style:f,beforeStyle:{}},c.style){const{duration:_,autoDuration:y,delay:w,autoDelay:B,easing:g}=c;_?(d.duration=_,a+=_,w&&(d.totalTime=_+w)):y&&(d.autoDuration=y,h+=y),w?(d.delay=w,a+=w):B&&(d.autoDelay=B,h+=B),g&&(d.easingFn=hn.get(g))}if(!d.autoDuration&&d.duration===void 0&&(r>1?u>0||o?h++:d.duration=0:d.duration=this.duration),r>1)this.setBefore(d,f,l);else{for(let _ in f)d.beforeStyle[_]=t[_];this.fromStyle=d.beforeStyle,this.toStyle=d.style}l=f,e.push(d)}h?((this.duration<=a||!(n&&n.duration))&&this.changeDuration(a+tc*h),this.allocateTime((this.duration-a)/h)):a&&this.changeDuration(a),this.emit(mt.CREATED,this)}changeDuration(t){const{config:e}=this;this.config=e?Object.assign(Object.assign({},e),{duration:t}):{duration:t}}setBefore(t,e,s){const{fromStyle:n,toStyle:r,target:o}=this;for(let a in e)n[a]===void 0&&(n[a]=r[a]=e===s?s[a]:o[a]),t.beforeStyle[a]=s[a]===void 0?r[a]:s[a],r[a]=e[a]}allocateTime(t){let{frames:e}=this,{length:s}=e,n;for(let r=0;r<s;r++)n=e[r],n.duration===void 0&&(n.duration=n.autoDuration?t*n.autoDuration:t),n.totalTime||(n.autoDelay&&(n.delay=n.autoDelay*t),n.delay&&(n.totalTime=n.duration,n.totalTime+=n.delay))}requestAnimate(){this.requestAnimateTime=Date.now(),x.requestRender(this.animate.bind(this))}animate(t,e){if(!e){if(!this.running)return;this.time+=(Date.now()-this.requestAnimateTime)/1e3}const{duration:s}=this,n=this.time*this.speed;if(n<s){for(;n-this.playedTotalTime>this.frameTotalTime;)this.transition(1),this.nowReverse?this.reverseNextFrame():this.nextFrame();const r=this.nowReverse?0:this.frame.delay||0,o=n-this.playedTotalTime-r,a=this.frame.duration;if(o>a)this.transition(1);else if(o>=0){const h=a?o/a:1;this.transition(this.frame.easingFn?this.frame.easingFn(h):this.easingFn(h))}}else this.end();if(!e)if(n<s)this.requestAnimate();else{const{loop:r,loopDelay:o,swing:a}=this;if((r!==!1||a)&&(this.looped?this.looped++:this.looped=1,!(typeof r=="number"&&(!r||this.looped>=r)))){a&&(this.nowReverse=!this.nowReverse),o?this.timer=setTimeout(()=>{this.timer=0,this.begin()},o/this.speed*1e3):this.begin();return}this.complete()}}start(t){this.requestAnimateTime=1;const{reverse:e}=this;if((e||this.nowReverse)&&(this.nowReverse=e),this.looped&&(this.looped=0),t)this.begin(!0);else{const{delay:s}=this;s?this.timer=setTimeout(()=>{this.timer=0,this.begin()},s/this.speed*1e3):this.begin()}}begin(t){this.playedTotalTime=this.time=0,this.nowReverse?this.setTo():this.setFrom(),t||this.requestAnimate()}end(){this.nowReverse?this.setFrom():this.setTo()}complete(){this.requestAnimateTime=0,this.running=!1;const{realEnding:t}=this;t==="from"?this.setFrom():t==="to"&&this.setTo(),this.clearTimer(),this.emit(mt.COMPLETED,this)}setFrom(){this.nowIndex=0,this.setStyle(this.fromStyle)}setTo(){this.nowIndex=this.frames.length-1,this.setStyle(this.toStyle)}nextFrame(){this.nowIndex+1>=this.frames.length||(this.playedTotalTime+=this.frameTotalTime,this.nowIndex++)}reverseNextFrame(){this.nowIndex-1<0||(this.playedTotalTime+=this.frameTotalTime,this.nowIndex--)}transition(t){const{style:e,beforeStyle:s}=this.frame,n=this.nowReverse?e:s,r=this.nowReverse?s:e;if(t===0)this.setStyle(n);else if(t===1)this.setStyle(r);else{const{attrsMap:o,target:a}=this;let h,l,c,{betweenStyle:d}=this.frame;d||(d=this.frame.betweenStyle={});for(let f in e)o&&!o[f]||(h=n[f],l=r[f],c=Ci.list[f]||Ci.value,h!==l&&(d[f]=c(h,l,t,a)));this.setStyle(d)}this.emit(mt.UPDATE,this)}setStyle(t){this.target.set(t,this.isTemp?"temp":!1)}clearTimer(t){this.timer&&(clearTimeout(this.timer),this.timer=0,t&&t())}destroy(t){this.destroyed||(super.destroy(),t&&!this.completed?this.stop():this.pause(),this.target=this.config=this.frames=null,this.destroyed=!0)}};kt([zt("ease")],xt.prototype,"easing",void 0);kt([zt(0)],xt.prototype,"delay",void 0);kt([zt(tc)],xt.prototype,"duration",void 0);kt([zt("auto")],xt.prototype,"ending",void 0);kt([zt(!1)],xt.prototype,"reverse",void 0);kt([zt(!1)],xt.prototype,"swing",void 0);kt([zt(!1)],xt.prototype,"loop",void 0);kt([zt(0)],xt.prototype,"loopDelay",void 0);kt([zt(1)],xt.prototype,"speed",void 0);kt([zt(!0)],xt.prototype,"autoplay",void 0);kt([zt()],xt.prototype,"join",void 0);kt([zt()],xt.prototype,"attrs",void 0);xt=kt([Ft(wl)],xt);const tm={transparent:"FFF0",aliceblue:"F0F8FF",antiquewhite:"FAEBD7",aqua:"0FF",aquamarine:"7FFFD4",azure:"F0FFFF",beige:"F5F5DC",bisque:"FFE4C4",black:"0",blanchedalmond:"FFEBCD",blue:"00F",blueviolet:"8A2BE2",brown:"A52A2A",burlywood:"DEB887",cadetblue:"5F9EA0",chartreuse:"7FFF00",chocolate:"D2691E",coral:"FF7F50",cornflowerblue:"6495ED",cornsilk:"FFF8DC",crimson:"DC143C",cyan:"0FF",darkblue:"00008B",darkcyan:"008B8B",darkgoldenrod:"B8860B",darkgray:"A9",darkgreen:"006400",darkgrey:"A9",darkkhaki:"BDB76B",darkmagenta:"8B008B",darkolivegreen:"556B2F",darkorange:"FF8C00",darkorchid:"9932CC",darkred:"8B0000",darksalmon:"E9967A",darkseagreen:"8FBC8F",darkslateblue:"483D8B",darkslategray:"2F4F4F",darkslategrey:"2F4F4F",darkturquoise:"00CED1",darkviolet:"9400D3",deeppink:"FF1493",deepskyblue:"00BFFF",dimgray:"69",dimgrey:"69",dodgerblue:"1E90FF",firebrick:"B22222",floralwhite:"FFFAF0",forestgreen:"228B22",fuchsia:"F0F",gainsboro:"DC",ghostwhite:"F8F8FF",gold:"FFD700",goldenrod:"DAA520",gray:"80",green:"008000",greenyellow:"ADFF2F",grey:"80",honeydew:"F0FFF0",hotpink:"FF69B4",indianred:"CD5C5C",indigo:"4B0082",ivory:"FFFFF0",khaki:"F0E68C",lavender:"E6E6FA",lavenderblush:"FFF0F5",lawngreen:"7CFC00",lemonchiffon:"FFFACD",lightblue:"ADD8E6",lightcoral:"F08080",lightcyan:"E0FFFF",lightgoldenrodyellow:"FAFAD2",lightgray:"D3",lightgreen:"90EE90",lightgrey:"D3",lightpink:"FFB6C1",lightsalmon:"FFA07A",lightseagreen:"20B2AA",lightskyblue:"87CEFA",lightslategray:"789",lightslategrey:"789",lightsteelblue:"B0C4DE",lightyellow:"FFFFE0",lime:"00FF00",limegreen:"32CD32",linen:"FAF0E6",magenta:"FF00FF",maroon:"800000",mediumaquamarine:"66CDAA",mediumblue:"0000CD",mediumorchid:"BA55D3",mediumpurple:"9370DB",mediumseagreen:"3CB371",mediumslateblue:"7B68EE",mediumspringgreen:"00FA9A",mediumturquoise:"48D1CC",mediumvioletred:"C71585",midnightblue:"191970",mintcream:"F5FFFA",mistyrose:"FFE4E1",moccasin:"FFE4B5",navajowhite:"FFDEAD",navy:"000080",oldlace:"FDF5E6",olive:"808000",olivedrab:"6B8E23",orange:"FFA500",orangered:"FF4500",orchid:"DA70D6",palegoldenrod:"EEE8AA",palegreen:"98FB98",paleturquoise:"AFEEEE",palevioletred:"D87093",papayawhip:"FFEFD5",peachpuff:"FFDAB9",peru:"CD853F",pink:"FFC0CB",plum:"DDA0DD",powderblue:"B0E0E6",purple:"800080",rebeccapurple:"639",red:"F00",rosybrown:"BC8F8F",royalblue:"4169E1",saddlebrown:"8B4513",salmon:"FA8072",sandybrown:"F4A460",seagreen:"2E8B57",seashell:"FFF5EE",sienna:"A0522D",silver:"C0",skyblue:"87CEEB",slateblue:"6A5ACD",slategray:"708090",slategrey:"708090",snow:"FFFAFA",springgreen:"00FF7F",steelblue:"4682B4",tan:"D2B48C",teal:"008080",thistle:"D8BFD8",tomato:"FF6347",turquoise:"40E0D0",violet:"EE82EE",wheat:"F5DEB3",white:"F",whitesmoke:"F5",yellow:"FF0",yellowgreen:"9ACD32"},ec=/^rgb\((\d+),\s*(\d+),\s*(\d+)/i,ic=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d*\.?\d+)/i,sc=/^hsl\((\d+),\s*(\d+)%\s*,\s*(\d+)%/i,nc=/^hsla\((\d+),\s*(\d+)%\s*,\s*(\d+)%\s*,\s*(\d*\.?\d+)/i,et=parseInt,Oe=parseFloat,{round:Rr}=Math;let Tr={},kr=0;function em(i,t){let e,s=t!==void 0&&t!==1;if(typeof i=="string"){const n=Tr[i];if(n)e=Object.assign({},n);else{switch(i[0]){case"#":e=Lh(i);break;case"R":case"r":i[4]==="("&&ic.test(i)?e=sm(i):i[3]==="("&&ec.test(i)&&(e=im(i));break;case"H":case"h":i[4]==="("&&nc.test(i)?e=rm(i):i[3]==="("&&sc.test(i)&&(e=nm(i));break}if(!e){const r=tm[i.toLowerCase()];r&&(e=Lh("#"+r))}e&&(kr++,kr>1e4&&(Tr={},kr=0),Tr[i]=Object.assign({},e))}}else typeof i=="object"&&(i.a===void 0&&(i.a=1),s&&(i=Object.assign({},i)),e=i);return e||(e={r:255,g:255,b:255,a:1}),s&&(e.a*=t),e}function Lh(i){let t,e,s,n=1;switch(i.length){case 9:t=et(i.slice(1,3),16),e=et(i.slice(3,5),16),s=et(i.slice(5,7),16),n=et(i.slice(7,9),16)/255;break;case 7:t=et(i.slice(1,3),16),e=et(i.slice(3,5),16),s=et(i.slice(5,7),16);break;case 5:t=et(i[1]+i[1],16),e=et(i[2]+i[2],16),s=et(i[3]+i[3],16),n=et(i[4]+i[4],16)/255;break;case 4:t=et(i[1]+i[1],16),e=et(i[2]+i[2],16),s=et(i[3]+i[3],16);break;case 3:t=e=s=et(i[1]+i[2],16);break;case 2:t=e=s=et(i[1]+i[1],16);break}return{r:t,g:e,b:s,a:n}}function im(i){const t=ec.exec(i);return{r:et(t[1]),g:et(t[2]),b:et(t[3]),a:1}}function sm(i){const t=ic.exec(i);return{r:et(t[1]),g:et(t[2]),b:et(t[3]),a:Oe(t[4])}}function nm(i){const t=sc.exec(i);return rc(Oe(t[1]),Oe(t[2]),Oe(t[3]),1)}function rm(i){const t=nc.exec(i);return rc(Oe(t[1]),Oe(t[2]),Oe(t[3]),Oe(t[4]))}const om=1/6,am=.5,Dh=2/3,Mh=1/3;function Pr(i,t,e){return e<0?e++:e>1&&e--,e<om?i+(t-i)*6*e:e<am?t:e<Dh?i+(t-i)*(Dh-e)*6:i}function rc(i,t,e,s=1){let n,r,o;if(i/=360,t/=100,e/=100,t===0)n=r=o=e;else{let a=e<.5?e*(1+t):e+t-e*t,h=2*e-a;n=Pr(h,a,i+Mh),r=Pr(h,a,i),o=Pr(h,a,i-Mh)}return{r:Rr(n*255),g:Rr(r*255),b:Rr(o*255),a:s}}se.object=em;const{round:hm}=Math,{fourNumber:Fh}=ct,lm={fill:Wh,stroke:Wh,cornerRadius(i,t,e){return typeof i=="number"&&typeof t=="number"?It(i,t,e):(i=Fh(i),t=Fh(t),i.map((s,n)=>It(s,t[n],e)))},text(i,t,e){return typeof i=="number"||typeof t=="number"?ct.float(It(i,t,e),Math.max(Ih(i),Ih(t))):t},shadow:$h,innerShadow:$h},cm={value:um,number:It,color:bo};function Ih(i){const t=String(i).split(".")[1];return t?t.length:0}function um(i,t,e){return typeof i=="number"&&typeof t=="number"?i+(t-i)*e:t}function It(i,t,e,s){i||(i=0),t||(t=0);const n=i+(t-i)*e;return s?hm(n):n}function bo(i,t,e){i=se.object(i),t=se.object(t);const s=It(i.r,t.r,e,1)+","+It(i.g,t.g,e,1)+","+It(i.b,t.b,e,1),n=It(i.a,t.a,e);return n===1?"rgb("+s+")":"rgba("+s+","+n+")"}function Wh(i,t,e){return typeof i=="string"&&typeof t=="string"?bo(i,t,e):t}function $h(i,t,e){return i instanceof Array||t instanceof Array?t:(i=i||{},t=t||{},{x:It(i.x,t.x,e),y:It(i.y,t.y,e),blur:It(i.blur,t.blur,e),spread:It(i.spread,t.spread,e),color:bo(i.color||"#FFFFFF00",t.color||"#FFFFFF00",e),visible:t.visible,blendMode:t.blendMode,box:t.box||i.box})}$.canAnimate=!0;Object.assign(Ci,cm);Object.assign(Ci.list,lm);const ei=m.prototype;Jy()(ei,"animation");vt()(ei,"animationOut");vt(!0)(ei,"transition");vt()(ei,"transitionOut");ei.animate=function(i,t,e,s){return i===void 0?this.__animate:(typeof i=="object"&&(i.keyframes?(t=i,i=i.keyframes):i.style&&(t=i,i=i.style)),this.killAnimate(e),this.__animate=new xt(this,i,t,s))};ei.killAnimate=function(i){const t=this.__animate;t&&(t.kill(),this.__animate=null)};ei.__runAnimation=function(i,t){this.animate(i==="in"?this.animation:this.animationOut),t&&this.__animate.on(mt.COMPLETED,t)};const{M:dm,L:fm,C:_m,Q:pm,Z:gm,N:ym,D:mm,X:wm,G:zh,F:jh,O:xm,P:vm,U:bm}=Wt,Bo={scale(i,t,e){if(!i)return;let s,n=0,r=i.length;for(;n<r;)switch(s=i[n],s){case dm:case fm:Nt(i,t,e,n,1),n+=3;break;case _m:Nt(i,t,e,n,3),n+=7;break;case pm:Nt(i,t,e,n,2),n+=5;break;case gm:n+=1;break;case ym:Nt(i,t,e,n,2),n+=5;break;case mm:Nt(i,t,e,n,2),n+=9;break;case wm:Nt(i,t,e,n,2),n+=6;break;case zh:Nt(i,t,e,n,2),n+=9;break;case jh:Nt(i,t,e,n,2),n+=5;break;case xm:i[n]=zh,i.splice(n+4,0,i[n+3],0),Nt(i,t,e,n,2),n+=9,r+=2;break;case vm:i[n]=jh,i.splice(n+4,0,i[n+3]),Nt(i,t,e,n,2),n+=5,r+=1;break;case bm:Nt(i,t,e,n,2),n+=6;break}},scalePoints(i,t,e,s,n){for(let r=n?s+1:0,o=n?r+n*2:i.length;r<o;r+=2)i[r]*=t,i[r+1]*=e}},{scalePoints:Nt}=Bo,Or=k.get(),{topLeft:Bm,top:Cm,topRight:Em,right:Sm,bottom:Rm,left:Tm}=tn;function Cn(i,t,e){i.pathInputed?En(i,t,e):(t!==1&&(i.width*=t),e!==1&&(i.height*=e))}function km(i,t,e){const{app:s}=i,n=s&&s.editor;let r=t;if(n.editing){const a=i.__layout;let{width:h,height:l}=a.boxBounds;switch(h*=e-t,l*=t-e,n.resizeDirection){case Cm:case Rm:r=e,a.affectScaleOrRotation?i.moveInner(-h/2,0):i.x-=h/2;break;case Tm:case Sm:a.affectScaleOrRotation?i.moveInner(0,-l/2):i.y-=l/2;break;case Bm:case Em:a.affectScaleOrRotation?i.moveInner(0,-l):i.y-=l;break}}i.fontSize*=r;const o=i.__;o.__autoWidth||(i.width*=r),o.__autoHeight||(i.height*=r)}function En(i,t,e){Bo.scale(i.__.path,t,e),i.path=i.__.path}function oc(i,t,e){const{points:s}=i;typeof s[0]=="object"?s.forEach(n=>{n.x*=t,n.y*=e}):Bo.scalePoints(s,t,e),i.points=s}function Vr(i,t,e){const{children:s}=i;for(let n=0;n<s.length;n++)Or.a=t,Or.d=e,s[n].transform(Or,!0)}const Sn=Ve.prototype;Sn.scaleResize=function(i,t=i,e){const s=this;e||s.editConfig&&s.editConfig.editSize==="scale"?(s.scaleX*=i,s.scaleY*=t):(i<0&&(s.scaleX*=-1,i=-i),t<0&&(s.scaleY*=-1,t=-t),this.__scaleResize(i,t))};Sn.__scaleResize=function(i,t){Cn(this,i,t)};Sn.resizeWidth=function(i){const t=i/this.getBounds("box","local").width;this.scaleOf(this.__layout.boxBounds,t,this.__.lockRatio?t:1,!0)};Sn.resizeHeight=function(i){const t=i/this.getBounds("box","local").height;this.scaleOf(this.__layout.boxBounds,this.__.lockRatio?t:1,t,!0)};X.prototype.__scaleResize=function(i,t){this.__.resizeFontSize||this.editConfig&&this.editConfig.editSize==="font-size"?km(this,i,t):Cn(this,i,t)};Si.prototype.__scaleResize=function(i,t){En(this,i,t)};ne.prototype.__scaleResize=function(i,t){this.pathInputed?En(this,i,t):this.points?oc(this,i,t):this.width*=i};ve.prototype.__scaleResize=function(i,t){this.pathInputed?En(this,i,t):this.points?oc(this,i,t):Cn(this,i,t)};qt.prototype.__scaleResize=function(i,t){Vr(this,i,t)};ot.prototype.__scaleResize=function(i,t){this.__.__autoSize&&this.children.length?Vr(this,i,t):(Cn(this,i,t),this.__.resizeChildren&&Vr(this,i,t))};function Co(i,t,e,s){var n=arguments.length,r=n<3?t:s,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(i,t,e,s);else for(var a=i.length-1;a>=0;a--)(o=i[a])&&(r=(n<3?o(r):n>3?o(t,e,r):o(t,e))||r);return n>3&&r&&Object.defineProperty(t,e,r),r}class Pm extends so{}let ln=class extends ot{get __tag(){return"Flow"}constructor(t){super(t),this.__hasAutoLayout=!0}};Co([dt(Pm)],ln.prototype,"__",void 0);Co([_n("x")],ln.prototype,"flow",void 0);ln=Co([ft()],ln);const Ar={},ac={"top-left":"from",top:"center","top-right":"to",right:"to","bottom-right":"to",bottom:"center","bottom-left":"from",left:"from",center:"center","baseline-left":"from","baseline-center":"center","baseline-right":"to"},hc={"top-left":"from",top:"from","top-right":"from",right:"center","bottom-right":"to",bottom:"to","bottom-left":"to",left:"center",center:"center","baseline-left":"to","baseline-center":"to","baseline-right":"to"};function Rn(i,t,e){const s=i.__,{contentBounds:n}=i.__layout;tl.toPoint(e,t,n,Ar),t.x=s.__autoWidth?n.x:Ar.x,t.y=s.__autoHeight?n.y:Ar.y}function Om(i,t,e,s){Rn(i,t,e);const{list:n}=t;if(n.length>1&&(s||(s=ac[e]),s!=="from")){let r;for(let o=0,a=n.length;o<a;o++)r=n[o],r.x=t.width-r.width,s==="center"&&(r.x/=2)}}const{move:Am}=T;function Lm(i,t,e,s){const{list:n}=t,r=i.__.flowWrap==="reverse";let o,{x:a,y:h}=t;for(let l=0,c=n.length;l<c;l++)o=n[r?c-1-l:l],lc(i,o,a,h,e,s),h+=o.height+t.gap}function lc(i,t,e,s,n,r){const{children:o}=i;let a,h,{x:l,start:c}=t,d=s;l+=e;for(let f=0,u=t.count;f<u;f++)a=o[r?c-f:c+f],a.__.inFlow&&a.__.visible!==0?(h=a.__flowBounds,n!=="from"&&(d=s+(t.height-h.height)/(n==="center"?2:1)),Am(a,l-h.x,d-h.y),l+=h.width+t.gap):u++}function cn(i,t,e){const s=e==="width"?"height":"width";i[e]=Math.max(i[e],t[e]),i[s]+=i.count?t[s]+i.gap:t[s],i.list.push(t),i.count++}const K={};function cc(i,t){const{gap:e,flowAlign:s,flowWrap:n,__autoWidth:r,__autoHeight:o}=i.__,a=n&&(t?!r:!o);return typeof e=="object"?(K.xGap=e.x||0,K.yGap=e.y||0):K.xGap=K.yGap=e,K.isAutoXGap=typeof K.xGap=="string"&&!r,K.isAutoYGap=typeof K.yGap=="string"&&!o,K.complex=a||s!=="top-left"||i.__hasGrow||K.isAutoXGap||K.isAutoYGap,K.wrap=a,K.complex&&(K.isFitXGap=K.xGap==="fit"&&!r,K.isFitYGap=K.yGap==="fit"&&!o,typeof s=="object"?(K.contentAlign=s.content||"top-left",K.rowXAlign=s.x||"from",K.rowYAlign=s.y||"from"):(K.contentAlign=s,K.rowXAlign=ac[s],K.rowYAlign=hc[s])),K}function un(i,t){return{x:0,y:0,width:0,height:0,gap:t,start:i,count:0,grow:0}}function uc(){return{x:0,y:0,width:0,height:0,gap:0,count:0,list:[]}}function vi(i,t,e,s){const{count:n}=i;n>1&&(e>i[t]||s)&&(i.gap=(e-i[t])/(n-1),i[t]=e)}function dc(i,t){return t==="box"?i.__local:i.__layout.localStrokeBounds}const{within:Dm}=ct;function Nh(i,t,e,s){let n,r,o,a=0,h=t.hasRangeSize&&[],{grow:l,start:c}=t;const d=t.width<e?(e-t.width)/l:0,{children:f}=i;d&&(t.width=e);for(let u=0,_=t.count;u<_;u++)n=f[s?c-u:c+u],n.__.inFlow&&n.__.visible!==0?(r=n.__widthGrow)&&(o=Eo(n,n.__flowBounds,d*r),o?(a+=o,l-=r):h&&(n.__.widthRange?h.unshift(n):h.push(n))):_++;a&&Mm(h,a,l)}function Mm(i,t,e){let s,n,r,o;i.forEach(a=>{s=a.__widthGrow,n=t/e*s,o=Eo(a,r=a.__flowBounds,r.width+n),t-=n-o,e-=s})}function Eo(i,t,e){const{widthRange:s,lockRatio:n}=i.__,r=s?Dm(e,s):e,o=r/t.width;return i.scaleResize(o,n?o:1),t.width=r,e-r}const{within:Fm}=ct;function Hh(i,t,e,s){let n,r,o,a=0,h=t.hasRangeSize&&[],{grow:l,start:c}=t;const d=t.height<e?(e-t.height)/l:0,{children:f}=i;d&&(t.height=e);for(let u=0,_=t.count;u<_;u++)n=f[s?c-u:c+u],n.__.inFlow&&n.__.visible!==0?(r=n.__heightGrow)&&(o=So(n,n.__flowBounds,d*r),o?(a+=o,l-=r):h&&(n.__.heightRange?h.unshift(n):h.push(n))):_++;a&&Im(h,a,l)}function Im(i,t,e){let s,n,r,o;i.forEach(a=>{s=a.__heightGrow,n=t/e*s,o=So(a,r=a.__flowBounds,r.height+n),t-=n-o,e-=s})}function So(i,t,e){const{heightRange:s,lockRatio:n}=i.__,r=s?Fm(e,s):e,o=r/t.height;return i.scaleResize(n?o:1,o),t.height=r,e-r}const{move:Wm}=T;function Gh(i,t){const e="width",{children:s,itemBox:n}=i,r=cc(i,!0),{complex:o,wrap:a,xGap:h,yGap:l,isAutoXGap:c,isFitXGap:d}=r;if(!s.length)return;const f=a&&uc(),u=c?0:h;let _,y,w,B,g,{x:R,y:v,width:A,height:L}=i.__layout.contentBounds;for(let P=0,U=s.length;P<U;P++)_=s[B=t?U-1-P:P],_.__.inFlow&&_.__.visible!==0&&(y=dc(_,n),o?(_.__flowBounds=y,g||(g=un(B,u)),a&&g.count&&g.width+y.width>A&&(g.grow?Nh(i,g,A,t):c&&vi(g,e,A,d),cn(f,g,e),g=un(B,u)),w=y.width,_.__widthGrow&&(g.grow+=_.__widthGrow,w=0,_.__.widthRange&&(g.hasRangeSize=!0)),_.__heightGrow&&So(_,y,L),g.width+=g.count?w+u:w,g.height=Math.max(g.height,y.height),g.count++):(Wm(_,R-y.x,v-y.y),R+=y.width+u));if(o){const{isAutoYGap:P,isFitYGap:U,contentAlign:ht,rowXAlign:Q,rowYAlign:H}=r;g.count&&(g.grow?Nh(i,g,A,t):c&&vi(g,e,A,d),a&&cn(f,g,e)),a?(P?vi(f,"height",L,U):f.gap=l,Om(i,f,ht,Q),Lm(i,f,H,t)):(Rn(i,g,ht),lc(i,g,0,g.y,H,t))}}function $m(i,t,e,s){Rn(i,t,e);const{list:n}=t;if(n.length>1&&(s||(s=hc[e]),s!=="from")){let r;for(let o=0,a=n.length;o<a;o++)r=n[o],r.y=t.height-r.height,s==="center"&&(r.y/=2)}}const{move:zm}=T;function jm(i,t,e,s){const{list:n}=t,r=i.__.flowWrap==="reverse";let o,{x:a,y:h}=t;for(let l=0,c=n.length;l<c;l++)o=n[r?c-1-l:l],fc(i,o,a,h,e,s),a+=o.width+t.gap}function fc(i,t,e,s,n,r){const{children:o}=i;let a,h,{y:l,start:c}=t,d=e;l+=s;for(let f=0,u=t.count;f<u;f++)a=o[r?c-f:c+f],a.__.inFlow&&a.__.visible!==0?(h=a.__flowBounds,n!=="from"&&(d=e+(t.width-h.width)/(n==="center"?2:1)),zm(a,d-h.x,l-h.y),l+=h.height+t.gap):u++}const{move:Nm}=T;function Uh(i,t){const e="height",{children:s,itemBox:n}=i,r=cc(i,!1),{complex:o,wrap:a,xGap:h,yGap:l,isAutoYGap:c,isFitYGap:d}=r;if(!s.length)return;const f=a&&uc(),u=c?0:l;let _,y,w,B,g,{x:R,y:v,width:A,height:L}=i.__layout.contentBounds;for(let P=0,U=s.length;P<U;P++)_=s[B=t?U-1-P:P],_.__.inFlow&&_.__.visible!==0&&(y=dc(_,n),o?(_.__flowBounds=y,g||(g=un(B,u)),a&&g.count&&g.height+y.height>L&&(g.grow&&Hh(i,g,L,t),c&&vi(g,e,L,d),cn(f,g,e),g=un(B,u)),w=y.height,_.__heightGrow&&(g.grow+=_.__heightGrow,w=0,_.__.heightRange&&(g.hasRangeSize=!0)),_.__widthGrow&&Eo(_,y,A),g.height+=g.count?w+u:w,g.width=Math.max(g.width,y.width),g.count++):(Nm(_,R-y.x,v-y.y),v+=y.height+u));if(o){const{isAutoXGap:P,isFitXGap:U,contentAlign:ht,rowXAlign:Q,rowYAlign:H}=r;g.count&&(g.grow&&Hh(i,g,L,t),c&&vi(g,e,L,d),a&&cn(f,g,e)),a?(P?vi(f,"width",A,U):f.gap=h,$m(i,f,ht,H),jm(i,f,Q,t)):(Rn(i,g,ht),fc(i,g,g.x,0,Q,t))}}function _c(i){return Z(i,t=>({set(e){const s=typeof e=="number"?e:0;t==="autoWidth"?this.__widthGrow=s:this.__heightGrow=s,s&&!(this.parent&&this.parent.__hasGrow)&&this.waitParent(()=>{this.parent.__hasGrow=!0}),this.__setAttr(t,e)&&Ai(this)}}))}const Ee=m.prototype,Ro=ot.prototype,{__updateBoxBounds:Hm}=qt.prototype;_n(!1)(Ee,"flow");D(0)(Ee,"gap");D("top-left")(Ee,"flowAlign");D(!1)(Ee,"flowWrap");D("box")(Ee,"itemBox");D(!0)(Ee,"inFlow");_c()(Ee,"autoWidth");_c()(Ee,"autoHeight");D()(Ee,"autoBox");const{copyAndSpread:pc}=S;Ro.__updateFlowLayout=function(){const{leaferIsCreated:i,flow:t}=this;switch(i&&(this.leafer.created=!1),t){case"x":case!0:Gh(this);break;case"y":Uh(this);break;case"x-reverse":Gh(this,!0);break;case"y-reverse":Uh(this,!0);break}i&&(this.leafer.created=!0)};Ro.__updateContentBounds=function(){const{padding:i}=this.__,t=this.__layout,e=t.contentBounds===t.boxBounds;i?(e&&t.shrinkContent(),pc(t.contentBounds,t.boxBounds,i,!0)):e||t.shrinkContentCancel()};Ro.__updateBoxBounds=function(i){const t=this.__;if(this.children.length){const{flow:e}=t;if(t.__autoSide){e&&!i?this.__updateRectBoxBounds():Hm.call(this);const{boxBounds:s}=this.__layout;t.__autoSize||(t.__autoWidth?(e||(s.width+=s.x,s.x=0),s.height=t.height,s.y=0):(e||(s.height+=s.y,s.y=0),s.width=t.width,s.x=0)),e&&i&&t.padding&&pc(s,s,t.padding,!1,t.__autoSize?null:t.__autoWidth?"width":"height"),this.__updateNaturalSize()}else this.__updateRectBoxBounds();e&&this.__updateContentBounds()}else this.__updateRectBoxBounds()};var j=(i=>(i.unopen="unopen",i.open="open",i.flag="flag",i.question="question",i))(j||{}),$t=(i=>(i.GAME_OVER="game_over",i.RESTART="restart",i.PHONE_HANDLER="phone_handler",i.CHANGE_CONFIG="change_config",i))($t||{});const gc=new Oc;function Ti(i){var t;gc.next(i),(t=i.ext)!=null&&t.disableAutoLogger||qi.event("sl-action",i)}const as=Ac(gc);function To(i,t){var n,r,o,a,h,l;const{row:e,col:s}=t;return[(n=i[e-1])==null?void 0:n[s-1],(r=i[e-1])==null?void 0:r[s],(o=i[e-1])==null?void 0:o[s+1],i[e][s-1],i[e][s+1],(a=i[e+1])==null?void 0:a[s-1],(h=i[e+1])==null?void 0:h[s],(l=i[e+1])==null?void 0:l[s+1]].filter(Boolean)}function Gm(i){const t=[];return[i.map((s,n)=>s.map((r,o)=>{r.type==="mine"&&t.push(`${n}-${o}`);const a={...r,row:n,col:o,mineCount:0,hasContent:!1},l=To(i,a).filter(c=>c.type==="mine").length;return{...a,mineCount:l}})),t]}function Um(i,t,e){const s=()=>Math.random()-.5,n=new Array(e).fill(0).map(()=>({status:j.unopen,type:"mine"})).concat(Array.from({length:i*t-e},()=>({status:j.unopen,type:"number"}))).sort(s),r=Array.from({length:i},(o,a)=>n.slice(a*t,a*t+t)).sort(s);return Gm(r)}function Ym(i,t){const e=new Set;return t.forEach(s=>{To(i,s).forEach(n=>{n.type==="number"&&n.status===j.unopen&&e.add(n)})}),e}function Xm(i,t){const e=t.filter(ko);return Ym(i,e)}const Vm=async i=>new Promise(t=>setTimeout(t,i));async function*qm(i,t,e){let s=new Set(t);do s=Xm(i,[...s]),yield s,await Vm(e);while(s.size)}function Yh(i,t){return t.openBlock+=i.length,i.map(e=>{if(e.status=j.open,e.type==="mine")throw{custom:!0,msg:"game over"};return e})}async function yc(i,t,e,s){let n;if(typeof t=="number"&&typeof e=="number")n=[i[t][e]];else if(Array.isArray(t)&&typeof e=="object")s=e,n=t;else return;const r=s,{blockSize:o,leafer:a}=r;try{const h=Yh(n,r);Qs(a.children[0],h,o);const l=qm(i,n,100);for await(const c of l){const d=Yh([...c],r);Qs(a.children[0],d,o)}}catch(h){if(Qs(a.children[0],n,o),qr(!1),h.custom)throw h}}function mc(i,t){var e;i.state=t,(e=i.children)==null||e.forEach(s=>s.state=t)}function Qs(i,t,e){i&&t.forEach(s=>{var l,c;const n=(c=(l=i.children[s.row])==null?void 0:l.children)==null?void 0:c[s.col];if(!n)return;const{status:r,hasContent:o,type:a,mineCount:h}=s;if(!o&&(r!==j.open||a!=="number"||h!==0)){s.hasContent=!0;const d=wc(s,e);n.add(d)}mc(n,r)})}function wc(i,t){const{type:e,mineCount:s}=i,n={fontSize:t-2,fill:"transparent",textAlign:"center",width:t,height:t,lineHeight:t,transition:.4,corners:8,cornerRadius:1,innerRadius:.2},r={[j.flag]:{fill:"yellow"}},o={[j.question]:{fill:"green"}},a=[{tag:"Text",...n,text:"?",states:o},{tag:"Star",...n,states:r}];if(e==="number"&&!s)return a;const h=e==="mine",l={tag:h?"Star":"Text",...n,text:h?"X":s.toString(),zIndex:h?2:1,states:{[j.open]:{fill:h?"red":"black"}}};return[...a,l]}function Km(i){const{gap:t,leafer:e,blocks:s}=i,n=new ot({stroke:"block",strokeWidth:1,flow:"y",gap:t,padding:t*2});s.forEach(r=>{const o=new ot({flow:"x",gap:t});n.add(o),r.forEach(a=>{const h=e0(a,i);o.add(h)})}),e.add(n)}function Zm(i,t){const{row:e,col:s,status:n}=i;if(n===j.open)return;const{blocks:r}=t;yc(r,e,s,t)}function qr(i){Ti({id:"sl-game-over",type:$t.GAME_OVER,ext:{isWin:i}})}function Qm(i,t){const{status:e,type:s}=i;if(e===j.open)return;const{leafer:n,blockSize:r}=t;e===j.unopen?(i.status=j.flag,s==="mine"&&++t.mineCount,++t.userMiniCount):e===j.flag?(i.status=j.question,s==="mine"&&--t.mineCount,--t.userMiniCount):e===j.question&&(i.status=j.unopen),Qs(n.children[0],[i],r)}function xc(i){const{openBlock:t,mineTotal:e,row:s,col:n,mineCount:r}=i;e===r&&qr(!0),t+e>=s*n&&qr(!0)}function Xh(i,t,e){i===C.TAP?Zm(t,e):i===C.MENU_TAP&&Qm(t,e),xc(e)}function Jm(i){const t=i.state;return i.state="highlight",()=>i.state=t}const t0=(()=>{let i=null;const t=e=>{i=()=>{e==null||e(),i=null}};return function(s,n,r,o){if(o.status!=="over"){if(o.isPhone){if(i==null||i(),r.status===j.open&&Bc(r))return Ti({id:"sl-phone-handler",type:$t.PHONE_HANDLER});const a=Jm(n);return t(a),Ti({id:"sl-phone-handler",type:$t.PHONE_HANDLER,ext:{block:r,gameInfo:o,disableAutoLogger:!0,eventCallback(h){i==null||i(),h&&Xh(h,r,o)}}})}Xh(s.type,r,o)}}})();function e0(i,t){const{blockSize:e}=t,s=new ot({width:e,height:e,fill:"yellowgreen",button:!0,zIndex:1,states:{[j.open]:{animation:{keyframes:[{fill:"yellowgreen"},{fill:"transparent"}],duration:1,ending:"to"}},highlight:{animation:{keyframes:[{fill:"#ffcac4"},{fill:"#ff4949"}],duration:.5,swing:!0,loop:!0}}}});return s.on([C.TAP,C.MENU_TAP],n=>t0(n,s,i,t)),s}function i0(i){const{row:t,col:e,mineTotal:s,durationOfUse:n,isWin:r,openBlock:o}=i,a=t*e,h=Math.min(s/a,.5)*100*2,l=Math.abs(Math.min(n/1e3/a-1,0))*100,c=o/(a-s)*100,d=.2,f=.2,u=.2;let _;return r?_=Math.min(100,h*d+l*f+40+20):_=Math.min(h*d+(100-l)*f+c*u,60),Number(_.toFixed(3))}function s0(i,t){const e=Math.abs(t[0]-i[0]),s=Math.abs(t[1]-i[1]);return Math.sqrt(e*e+s*s)}function n0(i,t){const{x:e,y:s}=i,{blockSize:n,gap:r,blocks:o,row:a,col:h}=t,l=n+r,c=Math.floor(s/l),d=Math.floor(e/l);return c>=a||d>=h?null:o[c][d]}function ko(i){return i.type==="number"&&i.mineCount===0}async function vc(i,t){if(i.status!==j.open||ko(i))return;const{blocks:e}=t,s=To(e,i);if(s.some(r=>r.type==="mine"&&r.status!==j.flag))return;const n=s.filter(r=>r.status===j.unopen);if(n.length)return yc(e,n,t).then(()=>xc(t))}function r0(i){const{leafer:t,mines:e,blockSize:s,blocks:n}=i,r=t.children[0];e.forEach(o=>{var d,f;const[a,h]=o.split("-"),l=n[+a][+h],c=(f=(d=r.children[+a])==null?void 0:d.children)==null?void 0:f[+h];if(!l.hasContent){const u=wc(l,s);c.add(u)}mc(c,j.open)})}const{useStore:yw,useStoreSlice:mw,getStore:o0}=Cc(i=>({gameStatus:"paying",setGameStatus(t){i({gameStatus:t})}}));function a0(){const[i,t]=Mt.useState(!1);return O.jsxs(O.Fragment,{children:[O.jsx(zc,{buttons:[{text:"重置",onClick:()=>Ti({id:"sl-restart",type:$t.RESTART})},{text:"游戏配置",onClick:()=>Ti({id:"sl-config",type:$t.CHANGE_CONFIG})},{text:"游戏记录",onClick:()=>t(!0)}]}),O.jsx(Dc,{open:i,storeKey:Zh,onClose:()=>t(!1),children:e=>O.jsx(Mc,{$direction:qh.COLUMN,$gap:"0.5",children:O.jsxs(Fc,{$alignItems:Tc.CENTER,$justifyContent:Kh.BETWEEN,children:[O.jsxs("span",{children:["分数: ",e.score]}),O.jsx(jc,{format:"yyyy-MM-DD hh:mm:ss",children:e.time})]})},e.gameId)})]})}function h0(i){return Kr({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M248,104a8,8,0,0,1-5.37,7.56L64,173.69V216a8,8,0,0,1-16,0V40a8,8,0,0,1,10.63-7.56l184,64A8,8,0,0,1,248,104Z"},child:[]}]})(i)}function l0(i){return Kr({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M19.07 4.93A10 10 0 0 0 6.99 3.34"},child:[]},{tag:"path",attr:{d:"M4 6h.01"},child:[]},{tag:"path",attr:{d:"M2.29 9.62A10 10 0 1 0 21.31 8.35"},child:[]},{tag:"path",attr:{d:"M16.24 7.76A6 6 0 1 0 8.23 16.67"},child:[]},{tag:"path",attr:{d:"M12 18h.01"},child:[]},{tag:"path",attr:{d:"M17.99 11.66A6 6 0 0 1 15.77 16.67"},child:[]},{tag:"circle",attr:{cx:"12",cy:"12",r:"2"},child:[]},{tag:"path",attr:{d:"m13.41 10.59 5.66-5.66"},child:[]}]})(i)}function c0(i){return Kr({tag:"svg",attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M80 160c0-35.3 28.7-64 64-64l32 0c35.3 0 64 28.7 64 64l0 3.6c0 21.8-11.1 42.1-29.4 53.8l-42.2 27.1c-25.2 16.2-40.4 44.1-40.4 74l0 1.4c0 17.7 14.3 32 32 32s32-14.3 32-32l0-1.4c0-8.2 4.2-15.8 11-20.2l42.2-27.1c36.6-23.6 58.8-64.1 58.8-107.7l0-3.6c0-70.7-57.3-128-128-128l-32 0C73.3 32 16 89.3 16 160c0 17.7 14.3 32 32 32s32-14.3 32-32zm80 320a40 40 0 1 0 0-80 40 40 0 1 0 0 80z"},child:[]}]})(i)}const Lr=dn(kc)`
  padding: 1rem;
  border-radius: var(--radius-full);
  font-size: 2rem;

  &:empty {
    display: none;
  }
`;function u0(i){switch(i){case j.unopen:return O.jsx(h0,{});case j.flag:return O.jsx(c0,{});case j.question:return O.jsx(Hc,{});case j.open:case void 0:return null;default:return null}}const d0=dn(ts)`
  position: absolute;
  left: 50%;
  bottom: 5rem;
  transform: translateX(-50%);
`,f0=Mt.memo(function(){const[t,e]=Mt.useState(!1),[s,n]=Mt.useState(null);as(({ext:o={}})=>{const{eventCallback:a,block:h,gameInfo:l}=o;if(!a||!h||!l)return e(!1);n({callback:a,block:h,gameInfo:l}),e(!0)},$t.PHONE_HANDLER);const r=()=>{const{block:o,gameInfo:a,callback:h}=s;!o||!a||!h||(vc(o,a),h())};return O.jsx(Gc,{when:t,children:()=>{var o,a,h;return O.jsxs(d0,{$gap:"1",onClick:()=>e(!1),children:[O.jsx(Lr,{onClick:()=>{var l;return(l=s==null?void 0:s.callback)==null?void 0:l.call(s,C.TAP)},children:((o=s==null?void 0:s.block)==null?void 0:o.status)===j.unopen&&O.jsx(Nc,{})}),O.jsx(Lr,{onClick:()=>{var l;return(l=s==null?void 0:s.callback)==null?void 0:l.call(s,C.MENU_TAP)},children:u0((a=s==null?void 0:s.block)==null?void 0:a.status)}),O.jsx(Lr,{onClick:r,children:((h=s==null?void 0:s.block)==null?void 0:h.status)===j.open&&!ko(s==null?void 0:s.block)&&O.jsx(l0,{})})]})}})}),Vh=dn.span`
  padding: 1rem;
  font-size: 2rem;
`;function _0(i){const{gameInfo:t}=i,[e,s]=Mt.useState(0);return as(()=>s(0),$t.RESTART),Mt.useEffect(()=>{if(t.current.status==="over")return;const n=setInterval(()=>s(r=>r+1),1e3);return()=>clearInterval(n)},[t.current.status]),O.jsxs(ts,{$justifyContent:Kh.CENTER,children:[O.jsxs(Vh,{children:["剩余雷数: ",t.current.mineTotal-t.current.userMiniCount]}),O.jsxs(Vh,{children:["用时: ",e]})]})}const Dr=dn(Uc)`
  width: 100%;
`;function p0(i){const{gameInfo:t}=i,[e,s]=Mt.useState(!1),[n]=ii.useForm();return as(()=>s(!0),$t.CHANGE_CONFIG),O.jsx(Ic,{title:"游戏配置",open:e,onClose:()=>s(!1),children:O.jsxs(ii,{form:n,initialValues:{row:t.current.row,col:t.current.col,mineTotal:t.current.mineTotal},onFinish:r=>{n.validateFields().then(()=>{t.current={...t.current,...r},Ti({id:"sl-config-change",type:$t.RESTART}),qi.event("sl-config-change",r),s(!1)})},children:[O.jsx(ii.Item,{label:"行数",name:"row",children:O.jsx(Dr,{min:10,max:100})}),O.jsx(ii.Item,{label:"列数",name:"col",children:O.jsx(Dr,{min:10,max:100})}),O.jsx(ii.Item,{label:"雷数",name:"mineTotal",rules:[{async validator(r,o){const{row:a,col:h}=n.getFieldsValue();if(o>a*h)throw new Error(`雷数不能超过${a*h}`)}}],children:O.jsx(Dr,{min:10})}),O.jsx(ii.Item,{children:O.jsxs(ts,{$gap:"1",children:[O.jsx(Ao,{$presetTheme:Pc.PRIMARY,children:"确定"}),O.jsx(Ao,{onClick:()=>s(!1),children:"取消"})]})})]})})}function ww(){const i=Mt.useRef(null),t=Mt.useRef({gameId:Oo(),row:30,col:30,startTime:Date.now(),mineTotal:200,mineCount:0,userMiniCount:0,gap:2,blockSize:20,openBlock:0,mines:[],blocks:[],isPhone:Yc(),status:"paying",leafer:null}),e=Mt.useMemo(()=>o0().setGameStatus,[]),s=()=>{const{leafer:r}=t.current;t.current.mineCount=0,t.current.openBlock=0,t.current.userMiniCount=0,t.current.status="paying",t.current.startTime=Date.now(),t.current.gameId=Oo(),e("paying"),r.clear();const{row:o,col:a,mineTotal:h}=t.current,[l,c]=Um(o,a,h);t.current.blocks=l,t.current.mines=c,Km(t.current)};Mt.useEffect(()=>{if(!t.current.leafer)return t.current.leafer=new xe({view:i.current}),s(),()=>{t.current.leafer.destroy(),t.current.leafer=null}},[]),as(r=>{const{ext:o}=r;t.current.status="over",e("over");const a=(o==null?void 0:o.isWin)||!1;a||r0(t.current);const{blocks:h,leafer:l,isPhone:c,...d}=t.current,{startTime:f}=t.current,u=Date.now(),_={...d,time:u,isWin:a,durationOfUse:u-f,score:0};_.score=i0(_),qi.event("game-sl-over",_),qi.expose("game-sl-over"),Ec(Zh,_),Sc(),Wc({id:"reload-history",type:$c.RELOAD_HISTORY}),Rc().showMessage({type:a?void 0:"error",content:`${a?"恭喜你，胜利了!":"很遗憾，失败了!"} 得分: ${_.score}`})},$t.GAME_OVER),as(s,$t.RESTART);const n=Mt.useMemo(()=>{let r=[0,0];return o=>{var a;if(t.current.status!=="over"){if(o.type==="mousedown")return r=[o.clientX,o.clientY];if(o.button===1){const h=[o.clientX,o.clientY];if(s0(r,h)>0)return;const c=(a=i.current)==null?void 0:a.getBoundingClientRect();if(!c)return;const{leafer:d}=t.current,f=d.getInnerPointByLocal({x:o.clientX-c.left,y:o.clientY-c.top}),u=n0(f,t.current);if(!u)return;vc(u,t.current)}}}},[]);return O.jsxs(Lc,{onFirstAppear:()=>qi.appear("game-sl"),children:[O.jsx(_0,{gameInfo:t}),O.jsx(ts,{$flex:"1",$direction:qh.COLUMN,children:O.jsx(ts,{$flex:"1",ref:i,onMouseDown:n,onMouseUp:n})}),O.jsx(f0,{}),O.jsx(p0,{gameInfo:t})]})}const xw={title:"扫雷",needBackIcon:!0,rightArea:O.jsx(a0,{})};export{ww as Component,xw as handle};
