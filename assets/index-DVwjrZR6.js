import{w as Pt,x as Dt}from"./index-D23sbB6u.js";import{r as Fe,av as Mt,R as At}from"./index-Cr9n8lBe.js";const Rt={BASE_URL:"/desktop-tools/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},He=e=>{let t;const n=new Set,r=(d,h)=>{const p=typeof d=="function"?d(t):d;if(!Object.is(p,t)){const m=t;t=h??(typeof p!="object"||p===null)?p:Object.assign({},t,p),n.forEach(v=>v(t,m))}},s=()=>t,c={setState:r,getState:s,getInitialState:()=>u,subscribe:d=>(n.add(d),()=>n.delete(d)),destroy:()=>{(Rt?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},u=t=e(r,s,c);return c},$t=e=>e?He(e):He;var et={exports:{}},tt={},rt={exports:{}},nt={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var J=Fe;function xt(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ct=typeof Object.is=="function"?Object.is:xt,Ft=J.useState,Lt=J.useEffect,jt=J.useLayoutEffect,zt=J.useDebugValue;function Nt(e,t){var n=t(),r=Ft({inst:{value:n,getSnapshot:t}}),s=r[0].inst,o=r[1];return jt(function(){s.value=n,s.getSnapshot=t,be(s)&&o({inst:s})},[e,n,t]),Lt(function(){return be(s)&&o({inst:s}),e(function(){be(s)&&o({inst:s})})},[e]),zt(n),n}function be(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Ct(e,n)}catch{return!0}}function Ht(e,t){return t()}var Tt=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Ht:Nt;nt.useSyncExternalStore=J.useSyncExternalStore!==void 0?J.useSyncExternalStore:Tt;rt.exports=nt;var Ut=rt.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var me=Fe,Bt=Ut;function Wt(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Jt=typeof Object.is=="function"?Object.is:Wt,Kt=Bt.useSyncExternalStore,qt=me.useRef,Gt=me.useEffect,Xt=me.useMemo,Yt=me.useDebugValue;tt.useSyncExternalStoreWithSelector=function(e,t,n,r,s){var o=qt(null);if(o.current===null){var a={hasValue:!1,value:null};o.current=a}else a=o.current;o=Xt(function(){function c(m){if(!u){if(u=!0,d=m,m=r(m),s!==void 0&&a.hasValue){var v=a.value;if(s(v,m))return h=v}return h=m}if(v=h,Jt(d,m))return v;var y=r(m);return s!==void 0&&s(v,y)?v:(d=m,h=y)}var u=!1,d,h,p=n===void 0?null:n;return[function(){return c(t())},p===null?void 0:function(){return c(p())}]},[t,n,r,s]);var i=Kt(e,o[0],o[1]);return Gt(function(){a.hasValue=!0,a.value=i},[i]),Yt(i),i};et.exports=tt;var Qt=et.exports;const Zt=Mt(Qt),st={BASE_URL:"/desktop-tools/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},{useDebugValue:Vt}=At,{useSyncExternalStoreWithSelector:er}=Zt;let Te=!1;const tr=e=>e;function rr(e,t=tr,n){(st?"production":void 0)!=="production"&&n&&!Te&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Te=!0);const r=er(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return Vt(r),r}const Ue=e=>{(st?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?$t(e):e,n=(r,s)=>rr(t,r,s);return Object.assign(n,t),n},ot=e=>e?Ue(e):Ue,at="cl:storage:flows";function it(e){const t=Fe.useRef({});return n=>{if(!n)return t.current;const r=Pt(n,e);return Dt(t.current,r)?t.current:t.current=r}}const nr=ot(e=>({messageInfo:null,showMessage:t=>e({messageInfo:t})})),zr=e=>nr(it(e)),sr={BASE_URL:"/desktop-tools/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};function ct(e,t){let n;try{n=e()}catch{return}return{getItem:s=>{var o;const a=c=>c===null?null:JSON.parse(c,void 0),i=(o=n.getItem(s))!=null?o:null;return i instanceof Promise?i.then(a):a(i)},setItem:(s,o)=>n.setItem(s,JSON.stringify(o,void 0)),removeItem:s=>n.removeItem(s)}}const V=e=>t=>{try{const n=e(t);return n instanceof Promise?n:{then(r){return V(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return V(r)(n)}}}},or=(e,t)=>(n,r,s)=>{let o={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:l=>l,version:0,merge:(l,g)=>({...g,...l}),...t},a=!1;const i=new Set,c=new Set;let u;try{u=o.getStorage()}catch{}if(!u)return e((...l)=>{console.warn(`[zustand persist middleware] Unable to update item '${o.name}', the given storage is currently unavailable.`),n(...l)},r,s);const d=V(o.serialize),h=()=>{const l=o.partialize({...r()});let g;const f=d({state:l,version:o.version}).then(S=>u.setItem(o.name,S)).catch(S=>{g=S});if(g)throw g;return f},p=s.setState;s.setState=(l,g)=>{p(l,g),h()};const m=e((...l)=>{n(...l),h()},r,s);let v;const y=()=>{var l;if(!u)return;a=!1,i.forEach(f=>f(r()));const g=((l=o.onRehydrateStorage)==null?void 0:l.call(o,r()))||void 0;return V(u.getItem.bind(u))(o.name).then(f=>{if(f)return o.deserialize(f)}).then(f=>{if(f)if(typeof f.version=="number"&&f.version!==o.version){if(o.migrate)return o.migrate(f.state,f.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return f.state}).then(f=>{var S;return v=o.merge(f,(S=r())!=null?S:m),n(v,!0),h()}).then(()=>{g==null||g(v,void 0),a=!0,c.forEach(f=>f(v))}).catch(f=>{g==null||g(void 0,f)})};return s.persist={setOptions:l=>{o={...o,...l},l.getStorage&&(u=l.getStorage())},clearStorage:()=>{u==null||u.removeItem(o.name)},getOptions:()=>o,rehydrate:()=>y(),hasHydrated:()=>a,onHydrate:l=>(i.add(l),()=>{i.delete(l)}),onFinishHydration:l=>(c.add(l),()=>{c.delete(l)})},y(),v||m},ar=(e,t)=>(n,r,s)=>{let o={storage:ct(()=>localStorage),partialize:y=>y,version:0,merge:(y,l)=>({...l,...y}),...t},a=!1;const i=new Set,c=new Set;let u=o.storage;if(!u)return e((...y)=>{console.warn(`[zustand persist middleware] Unable to update item '${o.name}', the given storage is currently unavailable.`),n(...y)},r,s);const d=()=>{const y=o.partialize({...r()});return u.setItem(o.name,{state:y,version:o.version})},h=s.setState;s.setState=(y,l)=>{h(y,l),d()};const p=e((...y)=>{n(...y),d()},r,s);s.getInitialState=()=>p;let m;const v=()=>{var y,l;if(!u)return;a=!1,i.forEach(f=>{var S;return f((S=r())!=null?S:p)});const g=((l=o.onRehydrateStorage)==null?void 0:l.call(o,(y=r())!=null?y:p))||void 0;return V(u.getItem.bind(u))(o.name).then(f=>{if(f)if(typeof f.version=="number"&&f.version!==o.version){if(o.migrate)return[!0,o.migrate(f.state,f.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,f.state];return[!1,void 0]}).then(f=>{var S;const[P,we]=f;if(m=o.merge(we,(S=r())!=null?S:p),n(m,!0),P)return d()}).then(()=>{g==null||g(m,void 0),m=r(),a=!0,c.forEach(f=>f(m))}).catch(f=>{g==null||g(void 0,f)})};return s.persist={setOptions:y=>{o={...o,...y},y.storage&&(u=y.storage)},clearStorage:()=>{u==null||u.removeItem(o.name)},getOptions:()=>o,rehydrate:()=>v(),hasHydrated:()=>a,onHydrate:y=>(i.add(y),()=>{i.delete(y)}),onFinishHydration:y=>(c.add(y),()=>{c.delete(y)})},o.skipHydration||v(),m||p},ir=(e,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?((sr?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),or(e,t)):ar(e,t),cr=ir;var ut=Symbol.for("immer-nothing"),Be=Symbol.for("immer-draftable"),w=Symbol.for("immer-state");function E(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var K=Object.getPrototypeOf;function q(e){return!!e&&!!e[w]}function A(e){var t;return e?lt(e)||Array.isArray(e)||!!e[Be]||!!((t=e.constructor)!=null&&t[Be])||ge(e)||ve(e):!1}var ur=Object.prototype.constructor.toString();function lt(e){if(!e||typeof e!="object")return!1;const t=K(e);if(t===null)return!0;const n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object?!0:typeof n=="function"&&Function.toString.call(n)===ur}function de(e,t){pe(e)===0?Reflect.ownKeys(e).forEach(n=>{t(n,e[n],e)}):e.forEach((n,r)=>t(r,n,e))}function pe(e){const t=e[w];return t?t.type_:Array.isArray(e)?1:ge(e)?2:ve(e)?3:0}function Pe(e,t){return pe(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function ft(e,t,n){const r=pe(e);r===2?e.set(t,n):r===3?e.add(n):e[t]=n}function lr(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function ge(e){return e instanceof Map}function ve(e){return e instanceof Set}function D(e){return e.copy_||e.base_}function De(e,t){if(ge(e))return new Map(e);if(ve(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=lt(e);if(t===!0||t==="class_only"&&!n){const r=Object.getOwnPropertyDescriptors(e);delete r[w];let s=Reflect.ownKeys(r);for(let o=0;o<s.length;o++){const a=s[o],i=r[a];i.writable===!1&&(i.writable=!0,i.configurable=!0),(i.get||i.set)&&(r[a]={configurable:!0,writable:!0,enumerable:i.enumerable,value:e[a]})}return Object.create(K(e),r)}else{const r=K(e);if(r!==null&&n)return{...e};const s=Object.create(r);return Object.assign(s,e)}}function Le(e,t=!1){return _e(e)||q(e)||!A(e)||(pe(e)>1&&(e.set=e.add=e.clear=e.delete=fr),Object.freeze(e),t&&Object.entries(e).forEach(([n,r])=>Le(r,!0))),e}function fr(){E(2)}function _e(e){return Object.isFrozen(e)}var dr={};function R(e){const t=dr[e];return t||E(0,e),t}var ee;function dt(){return ee}function hr(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function We(e,t){t&&(R("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function Me(e){Ae(e),e.drafts_.forEach(yr),e.drafts_=null}function Ae(e){e===ee&&(ee=e.parent_)}function Je(e){return ee=hr(ee,e)}function yr(e){const t=e[w];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function Ke(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];return e!==void 0&&e!==n?(n[w].modified_&&(Me(t),E(4)),A(e)&&(e=he(t,e),t.parent_||ye(t,e)),t.patches_&&R("Patches").generateReplacementPatches_(n[w].base_,e,t.patches_,t.inversePatches_)):e=he(t,n,[]),Me(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==ut?e:void 0}function he(e,t,n){if(_e(t))return t;const r=t[w];if(!r)return de(t,(s,o)=>qe(e,r,t,s,o,n)),t;if(r.scope_!==e)return t;if(!r.modified_)return ye(e,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const s=r.copy_;let o=s,a=!1;r.type_===3&&(o=new Set(s),s.clear(),a=!0),de(o,(i,c)=>qe(e,r,s,i,c,n,a)),ye(e,s,!1),n&&e.patches_&&R("Patches").generatePatches_(r,n,e.patches_,e.inversePatches_)}return r.copy_}function qe(e,t,n,r,s,o,a){if(q(s)){const i=o&&t&&t.type_!==3&&!Pe(t.assigned_,r)?o.concat(r):void 0,c=he(e,s,i);if(ft(n,r,c),q(c))e.canAutoFreeze_=!1;else return}else a&&n.add(s);if(A(s)&&!_e(s)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;he(e,s),(!t||!t.scope_.parent_)&&typeof r!="symbol"&&Object.prototype.propertyIsEnumerable.call(n,r)&&ye(e,s)}}function ye(e,t,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&Le(t,n)}function mr(e,t){const n=Array.isArray(e),r={type_:n?1:0,scope_:t?t.scope_:dt(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=r,o=je;n&&(s=[r],o=te);const{revoke:a,proxy:i}=Proxy.revocable(s,o);return r.draft_=i,r.revoke_=a,i}var je={get(e,t){if(t===w)return e;const n=D(e);if(!Pe(n,t))return pr(e,n,t);const r=n[t];return e.finalized_||!A(r)?r:r===Ee(e.base_,t)?(ke(e),e.copy_[t]=$e(r,e)):r},has(e,t){return t in D(e)},ownKeys(e){return Reflect.ownKeys(D(e))},set(e,t,n){const r=ht(D(e),t);if(r!=null&&r.set)return r.set.call(e.draft_,n),!0;if(!e.modified_){const s=Ee(D(e),t),o=s==null?void 0:s[w];if(o&&o.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(lr(n,s)&&(n!==void 0||Pe(e.base_,t)))return!0;ke(e),Re(e)}return e.copy_[t]===n&&(n!==void 0||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty(e,t){return Ee(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,ke(e),Re(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const n=D(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:r.enumerable,value:n[t]}},defineProperty(){E(11)},getPrototypeOf(e){return K(e.base_)},setPrototypeOf(){E(12)}},te={};de(je,(e,t)=>{te[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});te.deleteProperty=function(e,t){return te.set.call(this,e,t,void 0)};te.set=function(e,t,n){return je.set.call(this,e[0],t,n,e[0])};function Ee(e,t){const n=e[w];return(n?D(n):e)[t]}function pr(e,t,n){var s;const r=ht(t,n);return r?"value"in r?r.value:(s=r.get)==null?void 0:s.call(e.draft_):void 0}function ht(e,t){if(!(t in e))return;let n=K(e);for(;n;){const r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=K(n)}}function Re(e){e.modified_||(e.modified_=!0,e.parent_&&Re(e.parent_))}function ke(e){e.copy_||(e.copy_=De(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var gr=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,n,r)=>{if(typeof t=="function"&&typeof n!="function"){const o=n;n=t;const a=this;return function(c=o,...u){return a.produce(c,d=>n.call(this,d,...u))}}typeof n!="function"&&E(6),r!==void 0&&typeof r!="function"&&E(7);let s;if(A(t)){const o=Je(this),a=$e(t,void 0);let i=!0;try{s=n(a),i=!1}finally{i?Me(o):Ae(o)}return We(o,r),Ke(s,o)}else if(!t||typeof t!="object"){if(s=n(t),s===void 0&&(s=t),s===ut&&(s=void 0),this.autoFreeze_&&Le(s,!0),r){const o=[],a=[];R("Patches").generateReplacementPatches_(t,s,o,a),r(o,a)}return s}else E(1,t)},this.produceWithPatches=(t,n)=>{if(typeof t=="function")return(a,...i)=>this.produceWithPatches(a,c=>t(c,...i));let r,s;return[this.produce(t,n,(a,i)=>{r=a,s=i}),r,s]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){A(e)||E(8),q(e)&&(e=vr(e));const t=Je(this),n=$e(e,void 0);return n[w].isManual_=!0,Ae(t),n}finishDraft(e,t){const n=e&&e[w];(!n||!n.isManual_)&&E(9);const{scope_:r}=n;return We(r,t),Ke(void 0,r)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const s=t[n];if(s.path.length===0&&s.op==="replace"){e=s.value;break}}n>-1&&(t=t.slice(n+1));const r=R("Patches").applyPatches_;return q(e)?r(e,t):this.produce(e,s=>r(s,t))}};function $e(e,t){const n=ge(e)?R("MapSet").proxyMap_(e,t):ve(e)?R("MapSet").proxySet_(e,t):mr(e,t);return(t?t.scope_:dt()).drafts_.push(n),n}function vr(e){return q(e)||E(10,e),yt(e)}function yt(e){if(!A(e)||_e(e))return e;const t=e[w];let n;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=De(e,t.scope_.immer_.useStrictShallowCopy_)}else n=De(e,!0);return de(n,(r,s)=>{ft(n,r,yt(s))}),t&&(t.finalized_=!1),n}var b=new gr,Ie=b.produce;b.produceWithPatches.bind(b);b.setAutoFreeze.bind(b);b.setUseStrictShallowCopy.bind(b);b.applyPatches.bind(b);b.createDraft.bind(b);b.finishDraft.bind(b);var W={};const se=Symbol&&Symbol("empty")||{},_r=["url","map","set","weakmap","weakset"],mt=Reflect!=null&&Reflect.apply?e=>{let t=se;return(...n)=>(t===se&&(t=e()),typeof t!="function"?t:Reflect.apply(t,null,n))}:e=>{let t=se;return(...n)=>(t===se&&(t=e()),typeof t!="function"?t:t.apply(null,n))},Sr=mt(()=>globalThis.navigator?globalThis.navigator.userAgent||globalThis.navigator.swuserAgent:process?`Node.js/${process.version} (${process.platform}; ${process.arch}) ${W.SHELL} ${W.LANG} ${W.TERM_PROGRAM}`:""),wr=mt(()=>!Sr().toLocaleLowerCase().includes("node")&&window&&"onload"in window);function ne(...e){var t;(t=globalThis==null?void 0:globalThis.__ClConfig__)!=null&&t.disableWarning||console.warn("@cmtlyt/base:>",...e)}function ze(e){return wr()?typeof window<"u"&&window[e]!==void 0:(ne("caniuse 只能在浏览器环境中使用"),!1)}function pt(e,t=new WeakMap){if(e===null||typeof e!="object"||_r.includes(function(r){const s=typeof r;return s!=="object"&&s!=="function"?s:Object.prototype.toString.call(r).slice(8,-1).toLowerCase()}(e)))return e;if(t.has(e))return t.get(e);const n=Array.isArray(e)?[]:{};t.set(e,n);for(const r in e)e.hasOwnProperty(r)&&(n[r]=pt(e[r],t));return n}var G=1e3,$=6e4,x=60*$,C=24*x,br=7*C;function oe(e,t,n,r){var s=t>=1.5*n;return Math.round(e/n)+" "+r+(s?"s":"")}function _(e,t,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(e):r?r.value:t.get(e)}function Z(e,t,n,r,s){if(typeof t=="function"?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,n),n}(function(e){e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")&&e.default})(function(e,t){t=t||{};var n=typeof e;if(n==="string"&&e.length>0)return function(r){if(!((r=String(r)).length>100)){var s=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(r);if(s){var o=parseFloat(s[1]);switch((s[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*o;case"weeks":case"week":case"w":return o*br;case"days":case"day":case"d":return o*C;case"hours":case"hour":case"hrs":case"hr":case"h":return o*x;case"minutes":case"minute":case"mins":case"min":case"m":return o*$;case"seconds":case"second":case"secs":case"sec":case"s":return o*G;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}}}(e);if(n==="number"&&isFinite(e))return t.long?function(r){var s=Math.abs(r);return s>=C?oe(r,s,C,"day"):s>=x?oe(r,s,x,"hour"):s>=$?oe(r,s,$,"minute"):s>=G?oe(r,s,G,"second"):r+" ms"}(e):function(r){var s=Math.abs(r);return s>=C?Math.round(r/C)+"d":s>=x?Math.round(r/x)+"h":s>=$?Math.round(r/$)+"m":s>=G?Math.round(r/G)+"s":r+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}),typeof SuppressedError=="function"&&SuppressedError,typeof SuppressedError=="function"&&SuppressedError;var ae,X=1e3,F=6e4,L=60*F,j=24*L,Er=7*j;function ie(e,t,n,r){var s=t>=1.5*n;return Math.round(e/n)+" "+r+(s?"s":"")}ae=function(e,t){t=t||{};var n=typeof e;if(n==="string"&&e.length>0)return function(r){if(!((r=String(r)).length>100)){var s=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(r);if(s){var o=parseFloat(s[1]);switch((s[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*o;case"weeks":case"week":case"w":return o*Er;case"days":case"day":case"d":return o*j;case"hours":case"hour":case"hrs":case"hr":case"h":return o*L;case"minutes":case"minute":case"mins":case"min":case"m":return o*F;case"seconds":case"second":case"secs":case"sec":case"s":return o*X;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}}}(e);if(n==="number"&&isFinite(e))return t.long?function(r){var s=Math.abs(r);return s>=j?ie(r,s,j,"day"):s>=L?ie(r,s,L,"hour"):s>=F?ie(r,s,F,"minute"):s>=X?ie(r,s,X,"second"):r+" ms"}(e):function(r){var s=Math.abs(r);return s>=j?Math.round(r/j)+"d":s>=L?Math.round(r/L)+"h":s>=F?Math.round(r/F)+"m":s>=X?Math.round(r/X)+"s":r+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))},ae&&ae.__esModule&&Object.prototype.hasOwnProperty.call(ae,"default");const gt=["string","number","boolean"];let xe=0;function z(e,t=new Map){const n=function(o){const a=typeof o;return a!=="object"&&a!=="function"?a:Object.prototype.toString.call(o).slice(8,-1).toLowerCase()}(e),r={type:n,id:xe,value:"unknown"};t.has(e)?r.id=t.get(e):(++xe,t.set(e,r.id));let s=r;return gt.includes(n)&&(s={...r,value:e}),n==="array"?s={...r,value:e.map(o=>z(o,t))}:n==="object"?s={...r,value:Object.keys(e).sort().reduce((o,a)=>(o[a]=z(e[a],t),o),{})}:n==="map"?s={...r,value:[...e.entries()].map(([o,a])=>({key:z(o,t),value:z(a,t)}))}:n==="set"?s={...r,value:[...e.values()].map(o=>z(o,t))}:n==="function"||n==="asyncfunction"?s={...r,value:(()=>{const o=e.toString();return/^.*?=>/.test(o)?`return ${o}`:o.indexOf("async")===0?o.replace("async","return async function"):o.indexOf("function")===0?`return ${o}`:`return function ${o}`})()}:n==="date"?s={...r,value:e.toISOString()}:n==="regexp"&&(s={...r,value:{source:e.source,flags:e.flags}}),s}function N(e,t={}){const n=e.type;if(gt.includes(n))return e.value;if(t[e.id])return t[e.id];let r="unknown";return n==="array"?r=e.value.map(s=>N(s),t):n==="object"?r=Object.keys(e.value).reduce((s,o)=>(s[o]=N(e.value[o],t),s),{}):n==="map"?r=new Map(e.value.map(({key:s,value:o})=>[N(s,t),N(o,t)])):n==="set"?r=new Set(e.value.map(s=>N(s,t))):n==="function"||n==="asyncfunction"?r=new Function(e.value)():n==="date"?r=new Date(e.value):n==="regexp"&&(r=new RegExp(e.value.source,e.value.flags)),t[e.id]=r,r}function kr(e){let t={};const n=N(JSON.parse(e),t);for(const r in t)delete t[r];return t=null,n}const ce=Symbol&&Symbol("empty")||{},Ne=Reflect!=null&&Reflect.apply?e=>{let t=ce;return(...n)=>(t===ce&&(t=e()),typeof t!="function"?t:Reflect.apply(t,null,n))}:e=>{let t=ce;return(...n)=>(t===ce&&(t=e()),typeof t!="function"?t:t.apply(null,n))},Ir=Ne(()=>globalThis.navigator?globalThis.navigator.userAgent||globalThis.navigator.swuserAgent:process?`Node.js/${process.version} (${process.platform}; ${process.arch}) ${W.SHELL} ${W.LANG} ${W.TERM_PROGRAM}`:""),Or=Ne(()=>!Ir().toLocaleLowerCase().includes("node")&&window&&"onload"in window);function vt(...e){var t;(t=globalThis==null?void 0:globalThis.__ClConfig__)!=null&&t.disableWarning||console.warn("@cmtlyt/base:>",...e)}function I(e){return Or()?typeof window<"u"&&window[e]!==void 0:(vt("caniuse 只能在浏览器环境中使用"),!1)}var ue,Y=1e3,H=6e4,T=60*H,U=24*T,Pr=7*U;function le(e,t,n,r){var s=t>=1.5*n;return Math.round(e/n)+" "+r+(s?"s":"")}function re(e=8){const t=Math.random().toString(36).slice(2,e+2);return t.length===e?t:t+re(e-t.length)}function Ge(e){const t=new Blob([e]);return URL.createObjectURL(t)}function Xe(e){return new Worker(e)}function Oe(){const e=[],t=r=>{e.push(r)},n=r=>{e.splice(e.indexOf(r),1)};return{on:t,remove:n,clearOn:()=>{e.length=0},onOnce:r=>{const s=(...o)=>{r.apply(null,o),n(s)};t(s)},emit:r=>{for(const s of e)s(r)}}}function Ye({emit:e,type:t,result:n,error:r,resolve:s=()=>{},reject:o=()=>{},isSysCall:a,eventData:i}){if(a)t==="success"?s(n):o(r);else{const{__clUserCall:c,data:u}=i;e(c?u:i)}}function Qe(e,t=[],n){if(!I("Worker"))return vt("不支持 web worker 已降级"),{run:async(...c)=>await e(...c),dispose:()=>{},...Oe()};const{reuse:r=!0,needPost:s=!1}=n,o=function(c,u=[],d=!1){return`
${u.length?`importScripts("${u.join('", "')}");`:""}
const func = ${c};

const { postMessage } = (()=>{
  const postMessage = (data) => {
    self.postMessage({ __clUserCall: true, data })
  };
  return { postMessage: (data) => postMessage(data) };
})();

self.onmessage = async (e) => {
  const { callId, data: args } = e.data
  try {
    const result = await func.apply(null, ${d?"[postMessage, ...args]":"args"});
    self.postMessage({ __clSysCall: true, type: 'success', result, callId });
  } catch (e) {
    self.postMessage({ __clSysCall: true, callId, type: 'error', error: e })
  }
}
self.onerror = (e) => {
  self.postMessage({ __clSysCall: true, type: 'error', error: e })
}`}(e,function(c){const u=[],d=[];return c.forEach(h=>{typeof h=="string"?d.push(h):typeof h=="function"&&u.push(h)}),d.push(Ge(u.map(h=>`function ${h.name}(...args) { return (${h})(...args); }`).join(`
`))),d}(t),s),a=Ge(o);return r?function(u){const d=Xe(u);let h=!1,p={};const{emit:m,...v}=Oe();return d.onmessage=y=>{const{type:l,result:g,error:f,callId:S,__clSysCall:P}=y.data,{resolve:we,reject:Ot}=p[S]||{};P&&delete p[S],Ye({emit:m,type:l,result:g,error:f,resolve:we,reject:Ot,isSysCall:P,eventData:y.data})},{run:async(...y)=>{if(h)throw new Error("worker资源已释放");const l=re(16);return new Promise((g,f)=>{p[l]={resolve:g,reject:f},d.postMessage({callId:l,data:y})})},dispose:()=>{d.terminate(),p=null,h=!0,URL.revokeObjectURL(u)},...v}}(a):function(c){let u=!1;const{emit:d,...h}=Oe();return{run:async(...p)=>{if(u)throw new Error("worker资源已释放");const m=Xe(c);return new Promise((v,y)=>{m.onmessage=l=>{const{type:g,result:f,error:S,__clSysCall:P}=l.data;P&&m.terminate(),Ye({emit:d,type:g,result:f,error:S,resolve:v,reject:y,isSysCall:P,eventData:l.data})},m.postMessage({data:p})})},dispose:()=>{u=!0,URL.revokeObjectURL(c)},...h}}(a)}function Ce(e,t){let n,r=0;const s=36**t;for(;e.includes(n=re(t))&&++r<s;);return n}function Ze(e){return"#"}function _t(e,t,n="#",r={}){const s=new RegExp(`(^{.*?(.{${t}})})|({.*?(.{${t}})}$)`),o=n.length+2;for(let a=0;a++<e.length;){const i=e.slice(a,a+t+o);if(e.includes(i,a+t+o))for(let c=a+t+o+1;c++<e.length;){const u=e.slice(a,c);if(!e.includes(u,c)){const d=Ce(Object.keys(r),t),h=e.slice(a,c-1);if(s.test(h))break;r[d]=h,e=e.replace(new RegExp(h.replace(/([[{(?)\\])/g,"\\$1"),"g"),`{${n}${d}}`),a+=9;break}}}return e}function St(e,t=6){const n={},r=_t(e,t,"#",n);return JSON.stringify({cache:n,source:r,keyLength:t})}function wt(e,t="#"){const{keyLength:n,cache:r}=e;let s,{source:o}=e;for(;s=new RegExp(`{${t}(.{${n}})}`,"g").exec(o);){const[a,i]=Array.from(s);o=o.replace(new RegExp(a,"g"),r[i])}return o}function bt(e){return wt(JSON.parse(e),"#")}ue=function(e,t){t=t||{};var n=typeof e;if(n==="string"&&e.length>0)return function(r){if(!((r=String(r)).length>100)){var s=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(r);if(s){var o=parseFloat(s[1]);switch((s[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*o;case"weeks":case"week":case"w":return o*Pr;case"days":case"day":case"d":return o*U;case"hours":case"hour":case"hrs":case"hr":case"h":return o*T;case"minutes":case"minute":case"mins":case"min":case"m":return o*H;case"seconds":case"second":case"secs":case"sec":case"s":return o*Y;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}}}(e);if(n==="number"&&isFinite(e))return t.long?function(r){var s=Math.abs(r);return s>=U?le(r,s,U,"day"):s>=T?le(r,s,T,"hour"):s>=H?le(r,s,H,"minute"):s>=Y?le(r,s,Y,"second"):r+" ms"}(e):function(r){var s=Math.abs(r);return s>=U?Math.round(r/U)+"d":s>=T?Math.round(r/T)+"h":s>=H?Math.round(r/H)+"m":s>=Y?Math.round(r/Y)+"s":r+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))},ue&&ue.__esModule&&Object.prototype.hasOwnProperty.call(ue,"default"),Qe(St,[_t,Ze,Ce,re],{reuse:!1}),Qe(bt,[wt,Ze,Ce,re],{reuse:!1});const Et=Ne(()=>I("TextEncoder")&&I("ReadableStream")&&I("ArrayBuffer")&&I("Uint8Array")&&I("btoa")&&I("atob")&&I("TextDecoder"));async function Dr(e,t=6){if(!I("CompressionStream")||!Et())return St(e,t);const n=function(r){const s=new TextEncoder;return new ReadableStream({start(o){o.enqueue(s.encode(r)),o.close()}})}(e).pipeThrough(new CompressionStream("gzip"));return async function(r){return function(s){return btoa(String.fromCharCode.apply(null,new Uint8Array(s)))}(await async function(s){const o=s.getReader(),a=[];let i=0;for(;;){const{done:d,value:h}=await o.read();if(d)break;a.push(h),i+=h.byteLength}const c=new ArrayBuffer(i);let u=0;for(const d of a){const h=new Uint8Array(d);new Uint8Array(c,u,h.length).set(h),u+=h.length}return c}(r))}(n)}async function Mr(e){return I("DecompressionStream")&&Et()?async function(t){const n=t.getReader(),r=[];let s="";for(;;){const{done:a,value:i}=await n.read();if(a)break;r.push(i)}const o=new TextDecoder("utf-8");for(const a of r)s+=o.decode(a);return s+=o.decode(),s}(function(t){return function(n){return new ReadableStream({start(r){r.enqueue(n),r.close()}})}(function(n){const r=atob(n),s=r.length,o=new Uint8Array(s);for(let a=0;a<s;a++)o[a]=r.charCodeAt(a);return o}(t))}(e).pipeThrough(new DecompressionStream("gzip"))):bt(e)}var k,O,B,M,kt,fe;class Se{constructor(t){k.set(this,{}),O.set(this,void 0),this.config={},this.config=function(n={}){return{dbName:"cl-storage",autoSaveDelay:3e5,zipKeyLength:6,...n}}(t),Z(this,O,new Promise((n,r)=>{this._createHook(pt(this.config)),(async()=>{try{const s=await this.init();Z(this,k,typeof s=="string"?kr(await Mr(s)):s||{},"f"),n()}catch(s){r(s)}})(),this._createdHook()})),this._createAutoSaveInterval()}_createAutoSaveInterval(){this.config.autoSaveDelay<1||setTimeout(async()=>{const t=await this.getDataSchema();this.autoSave(t),this._createAutoSaveInterval()},this.config.autoSaveDelay)}get length(){return Object.keys(_(this,k,"f")).length}_createHook(t){}_createdHook(){}_setItemBeforeHook(t,n){}_setItemAfterHook(t,n){}_getItemBeforeHook(t){}_getItemAfterHook(t,n){}_removeItemBeforeHook(t){}_removeItemAfterHook(t){}_clearBeforeHook(){}_clearAfterHook(){}_getKeysBeforeHook(){}_getKeysAfterHook(t){}autoSave(t){}async getDataSchema(){return Dr(function(t){xe=0;let n=new Map;const r=z(t,n);return n.clear(),n=null,JSON.stringify(r)}(_(this,k,"f")),this.config.zipKeyLength)}async setItem(t,n){return _(this,O,"f").then(()=>{n=this._setItemBeforeHook(t,n)??n,_(this,k,"f")[t]=n,this._setItemAfterHook(t,n)})}async getItem(t){return _(this,O,"f").then(()=>{this._getItemBeforeHook(t);let n=_(this,k,"f")[t];return n=this._getItemAfterHook(t,n)??n,n})}async removeItem(t){return _(this,O,"f").then(()=>{this._removeItemBeforeHook(t),delete _(this,k,"f")[t],this._removeItemAfterHook(t)})}async clear(){return _(this,O,"f").then(()=>{this._clearBeforeHook(),Z(this,k,{}),this._clearAfterHook()})}async getKeys(){return _(this,O,"f").then(()=>{this._getKeysBeforeHook();let t=Object.keys(_(this,k,"f"));return t=this._getKeysAfterHook(t)??t,t})}}k=new WeakMap,O=new WeakMap;class Ar extends Se{constructor(t){super({...t,autoSaveDelay:0})}init(){return{}}autoSave(t){ne("MemaryStorage(内存存储) 不支持保存数据")}}class Rr extends Se{constructor(t){if(!ze("sessionStorage"))return ne("当前浏览器不支持 sessionStorage, 已自动降级为 MemaryStorage"),new Ar(t);super({dbName:"cl-storage",autoSaveDelay:6e4,...t})}init(){const t=this.config.dbName;return sessionStorage.getItem(t)||{}}autoSave(t){const n=this.config.dbName;sessionStorage.setItem(n,t)}}class $r extends Se{constructor(t){if(ze("localStorage"))return ne("当前浏览器不支持 localStorage, 已自动降级为 SessionStorage"),new Rr(t);super({dbName:"cl-storage",autoSaveDelay:6e4,...t})}init(){const t=this.config.dbName;return localStorage.getItem(t)||{}}autoSave(t){const n=this.config.dbName;localStorage.setItem(n,t)}}const Ve="value";class xr extends Se{constructor(t){if(!ze("indexedDB"))return ne("当前浏览器不支持 IndexedDB, 已自动降级为 LocalStorage"),new $r(t);super({dbName:"cl-storage",autoSaveDelay:6e4,...t}),B.add(this),M.set(this,void 0)}autoSave(t){_(this,B,"m",fe).call(this,t)}init(){const t=this.config.dbName,n=indexedDB.open(t,1);return new Promise((r,s)=>{n.addEventListener("error",s),n.addEventListener("upgradeneeded",()=>{const o=Z(this,M,n.result);o.objectStoreNames.contains(t)||(o.createObjectStore(t),_(this,B,"m",fe).call(this,""))}),n.addEventListener("success",()=>{Z(this,M,_(this,M,"f")??n.result),_(this,B,"m",kt).call(this).then(r,s)})})}async forceSave(){return _(this,B,"m",fe).call(this,await this.getDataSchema())}}M=new WeakMap,B=new WeakSet,kt=async function(){const e=_(this,M,"f").transaction([this.config.dbName],"readonly").objectStore(this.config.dbName).get(Ve);return new Promise((t,n)=>{e.addEventListener("error",n),e.addEventListener("success",()=>{t(e.result)})})},fe=async function(e){const t=_(this,M,"f").transaction([this.config.dbName],"readwrite").objectStore(this.config.dbName).put(e,Ve);return new Promise((n,r)=>{t.addEventListener("error",r),t.addEventListener("success",()=>{n(t.result)})})};const Q=new xr({dbName:at,autoSaveDelay:0}),Cr={async getItem(e){return await Q.getItem(e)},async setItem(e,t){await Q.setItem(e,t),Q.forceSave()},async removeItem(e){await Q.removeItem(e),Q.forceSave()}},Fr=e=>({addFlow:t=>{e(n=>Ie(n,r=>{var o;const s={...t,id:String(((o=r.flows)==null?void 0:o.length)||0),creator:"test",account:t.amountDistributions[0].account,amount:String(t.amountDistributions.reduce((a,i)=>a+ +i.amount,0)),createTime:new Date().toLocaleString(),updateTime:new Date().toLocaleString()};r.flows.unshift(s)}))},updateFlow:(t,n)=>{e(r=>Ie(r,s=>{const o=s.flows.findIndex(a=>a.id===t);o<0||s.flows.splice(o,1,{...s.flows[o],...n,amount:String(n.amountDistributions.reduce((a,i)=>a+ +i.amount,0)),updateTime:new Date().toLocaleString()})}))},deleteFlow:t=>{e(n=>Ie(n,r=>{r.flows.splice(r.flows.findIndex(s=>s.id===t),1)}))}}),It=ot(cr((e,t)=>({flows:[],...Fr(e)}),{name:at,storage:ct(()=>Cr)})),Nr=e=>It(it(e)),Hr=()=>It.getState();function Tr(e){const{if:t,children:n}=e;return t?n:null}export{Tr as S,it as a,Nr as b,ot as c,Hr as g,zr as u};
